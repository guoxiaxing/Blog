<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<link rel="alternate" type="application/rss+xml" href="/Blog/blog/rss.xml" title="Try&#39;s Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Blog/blog/atom.xml" title="Try&#39;s Blog Atom Feed"><title data-react-helmet="true">常见的网络攻击 | Try&#x27;s Blog</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://guoxiaxing.github.io/Blog/docs/网络/network-attack"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="常见的网络攻击 | Try&#x27;s Blog"><meta data-react-helmet="true" name="description" content="SQL 注入"><meta data-react-helmet="true" property="og:description" content="SQL 注入"><link data-react-helmet="true" rel="shortcut icon" href="/Blog/img/logo.png"><link data-react-helmet="true" rel="canonical" href="https://guoxiaxing.github.io/Blog/docs/网络/network-attack"><link data-react-helmet="true" rel="alternate" href="https://guoxiaxing.github.io/Blog/docs/网络/network-attack" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://guoxiaxing.github.io/Blog/docs/网络/network-attack" hreflang="x-default"><link rel="stylesheet" href="/Blog/assets/css/styles.c913d63a.css">
<link rel="preload" href="/Blog/assets/js/runtime~main.9868b5c7.js" as="script">
<link rel="preload" href="/Blog/assets/js/main.796e3833.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Blog/"><div class="navbar__logo"><img src="/Blog/img/logo.png" alt="Try&#x27;s Blog" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/Blog/img/logo.png" alt="Try&#x27;s Blog" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Try&#x27;s Blog</b></a><a class="navbar__item navbar__link navbar__link--active" href="/Blog/docs/quick-link">技术</a><a class="navbar__item navbar__link" href="/Blog/blog">生活</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/guoxiaxing/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">🌜</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">🌞</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div><div class="navbar__search searchBarContainer_I7kZ"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_Zg7X searchBarLoadingRing_J5Ez"><div></div><div></div><div></div><div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Blog/docs/learn-list">学习清单</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Blog/docs/quick-link">目录</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">CSS</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Javascript</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Linux</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Typescript</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">学习提升</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">框架&amp;常用库</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">网络</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Blog/docs/网络/dns">DNS何时使用TCP协议，何时使用UDP协议？</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Blog/docs/网络/http-headers">HTTP Headers字段以及作用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Blog/docs/网络/SameSite-Cookie">Cookie 的 SameSite 属性</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Blog/docs/网络/origin-referer-host">http headers之origin，host和referer的区别</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Blog/docs/网络/http2">http2的特性;多路复用怎么实现;和长链接的区别</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Blog/docs/网络/https-transfer">https传输过程</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Blog/docs/网络/http-status-num">http常见状态码</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Blog/docs/网络/http-cache">http 缓存</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Blog/docs/网络/http-request-cookie">http请求什么情况下会携带cookie</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Blog/docs/网络/tcp-sticky-package-and-unpacking">tcp的粘包拆包及其解决方式</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Blog/docs/网络/options-request">为什么会有OPTIONS请求</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/Blog/docs/网络/network-attack">常见的网络攻击</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Blog/docs/网络/Head-of-Line-Blocking">异步请求为什么会导致tcp的对头阻塞</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Blog/docs/网络/network-conclude">总结</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Blog/docs/网络/network-layer">网络分层包含哪几部分？分别的作用</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">工具</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">工程化</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">读书笔记</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_eoK2"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_e+kA"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>常见的网络攻击</h1></header><h2 class="anchor anchorWithStickyNavbar_y2LR" id="sql-注入">SQL 注入<a aria-hidden="true" class="hash-link" href="#sql-注入" title="Direct link to heading">​</a></h2><p>核心就是让 web 服务器执行攻击者希望的 sql 语句，以便得到数据库中的数据或者对数据库中的数据进行增删改查。</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="实现方式">实现方式<a aria-hidden="true" class="hash-link" href="#实现方式" title="Direct link to heading">​</a></h3><p>将 sql 语句放入 form 表单或者是请求参数中提交到后端服务器，后端服务器如果未做输入的安全校验直接将变量取出进行数据库查询则极容易中招。</p><p><img alt="sql注入" src="/Blog/assets/images/sql-48c6ca2e6ace7df089fb148c9b955b60.png"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="防御">防御<a aria-hidden="true" class="hash-link" href="#防御" title="Direct link to heading">​</a></h3><ul><li><p>严格限制 web 应用操作数据库的权利</p></li><li><p>后端代码检查数据的合法性</p></li><li><p>对数据库的特殊字符进行转译处理</p></li><li><p>所有查询语句建议使用数据库提供的参数化查询接口，参数化的语句使用的是参数而不是用户输入的变量嵌入到 SQL 语句中，即不要直接拼接 SQL 语句</p></li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="xss---跨站脚本攻击">XSS - 跨站脚本攻击<a aria-hidden="true" class="hash-link" href="#xss---跨站脚本攻击" title="Direct link to heading">​</a></h2><p><img alt="xss" src="/Blog/assets/images/xss-d9c7bc36fe6f8a169cb2d1a7898f4ec3.png"></p><p>XSS 攻击的核心就是将可执行的前端代码（一般是 JS）插入到网页中。简单的说就是攻击者希望你的浏览器可以执行他的 JS 代码，一般分为两种：</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="反射型">反射型<a aria-hidden="true" class="hash-link" href="#反射型" title="Direct link to heading">​</a></h3><ul><li><p>攻击者将 JS 代码作为请求参数放在 URL 中诱导用户去点击 <code>http://localhost:8080/test?name=&lt;script&gt;alert(&quot;you are under attack!&quot;)&lt;/script&gt;</code></p></li><li><p>用户点击后该 JS 作为请求传递给后端</p></li><li><p>后端没有检查过滤，简单处理后放入网页正文中返回给浏览器（比如这里可能就是将 name 的值插入到页面中）</p></li><li><p>浏览器解析返回的网页，中招！</p></li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="存储型">存储型<a aria-hidden="true" class="hash-link" href="#存储型" title="Direct link to heading">​</a></h3><p>上述方式是直接经过服务器转手后返回给浏览器执行。存储型与之的区别在于能够将攻击的脚本存储到数据库中，在后面查询时再将攻击脚本渲染进网页返回给浏览器触发执行</p><ul><li>攻击者网页回帖，帖子中包含了 js 脚本</li><li>回帖提交给服务器之后，存储至数据库</li><li>其他网友查看帖子，后台查询该帖子的回帖内容，构建完整网页，返回给浏览器</li><li>该网友的浏览器渲染返回的页面，中招！</li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="防御手段">防御手段<a aria-hidden="true" class="hash-link" href="#防御手段" title="Direct link to heading">​</a></h3><ul><li><p>尽量不要从 url，document.referrer，document.forms 中获取数据直接渲染</p></li><li><p>尽量不要使用 document.write、eval、setTimeout、setInterval、document.writeIn、innerHTML、new Function()等可以执行字符串的方法</p></li><li><p>对需要在 DOM 中渲染的字符串进行转译</p></li></ul><h4 class="anchor anchorWithStickyNavbar_y2LR" id="cspcontent-security-policy">CSP（Content-Security-Policy）<a aria-hidden="true" class="hash-link" href="#cspcontent-security-policy" title="Direct link to heading">​</a></h4><p>CSP 本质上就是建立白名单，开发者告诉浏览器哪些外部资源可以加载和执行。我们只需要配置规则，如何拦截是浏览器自己实现的。可以通过这种方式来尽量减少 XSS 攻击。</p><p>通常有两种方式可以设置 CSP</p><ul><li>设置 HTTP Header：Content-Security-Policy</li><li>设置 meta 标签</li></ul><h5 class="anchor anchorWithStickyNavbar_y2LR" id="例子">例子<a aria-hidden="true" class="hash-link" href="#例子" title="Direct link to heading">​</a></h5><ol><li>只允许加载本站资源</li></ol><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI text"><pre tabindex="0" class="prism-code language-text codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">Content-Security-Policy: default-src &#x27;self&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="2"><li>只允许加载 https 协议图片</li></ol><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI text"><pre tabindex="0" class="prism-code language-text codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">Content-Security-Policy: img-src https://*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="3"><li>允许加载来自任河源的框架</li></ol><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI text"><pre tabindex="0" class="prism-code language-text codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">Content-Security-Policy: child-src &#x27;none&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="特殊字符转译">特殊字符转译<a aria-hidden="true" class="hash-link" href="#特殊字符转译" title="Direct link to heading">​</a></h4><p>不要相信用户的输入，转译输入的内容</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="httponly-cookie">HttpOnly Cookie<a aria-hidden="true" class="hash-link" href="#httponly-cookie" title="Direct link to heading">​</a></h4><p>这个是预防 xss 获取用户 cookie 的最好的手段，添加该属性表明禁止 JS 来操作 cookie，也就是无法通过 document.cookie 来访问 cookie，此 cookie 只能服务器来操作</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="csrf---跨站请求伪造">CSRF - 跨站请求伪造<a aria-hidden="true" class="hash-link" href="#csrf---跨站请求伪造" title="Direct link to heading">​</a></h2><p>利用用户已登陆的身份，在用户毫不知情的情况下，以用户的名义进行非法操作。</p><p>完成 CSRF 的三个条件</p><ul><li>用户登陆受信任的网站 A 并生成了 cookie</li><li>在不登出 A 的情况下（也就是 cookie 生效的情况下），访问危险网站 B（B 站点内部会请求 A 站点）</li><li>站点 A 没有做任何的 CSRF 防御</li></ul><p>看一个例子，我们登陆了一个转账页面，突然眼前一亮惊现&quot;XXX 隐私照片，不看后悔一辈子&quot;的链接，耐不住内心躁动，立马点击了该危险的网站，但当这页面一加载，便会执行 submitForm 这个方法来提交转账请求，从而将 10 块转给黑客。</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="防御-1">防御<a aria-hidden="true" class="hash-link" href="#防御-1" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_y2LR" id="samesite-cookie">SameSite Cookie<a aria-hidden="true" class="hash-link" href="#samesite-cookie" title="Direct link to heading">​</a></h4><p>可以对 cookie 设置 SameSite 属性，表示该 Cookie 不会随着跨域请求发送，可以很大程度的减少 CSRF 攻击</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="referer-check">Referer Check<a aria-hidden="true" class="hash-link" href="#referer-check" title="Direct link to heading">​</a></h4><p>HTTP Referer 是请求头的一个字段，告诉服务器请求是从哪个页面发送过来的（是一个 url 地址）。可以通过检查请求的来源来防御 CSRF 攻击。</p><p>但是当页面从 https 跳转到 http，浏览器出于安全考虑，就不会发送 referer，服务器就无法进行 check 了。出于这个原因，无法完全依赖 referer 来作为防御 CSRF 的手段</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="token">Token<a aria-hidden="true" class="hash-link" href="#token" title="Direct link to heading">​</a></h4><p>浏览器在请求参数中加入一个随机产生的 Token，并在服务端建立一个拦截器来验证这个 Token。服务器读取浏览器当前域 cookie 中的 token 值，与请求中的 token 值进行对比，一致时请求成功，否则拒绝访问</p><p>token 可以在用户登陆的时候生成存放于 session 或者 cookie 中，每次请求的时候服务器都从 session/cookie 中取出 token 与请求中的 token 进行比较。由于 token 的存在攻击者无法构造出一个完整的请求 URL，所以可以一定程度的防范 CSRF 攻击</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="验证码">验证码<a aria-hidden="true" class="hash-link" href="#验证码" title="Direct link to heading">​</a></h4><p>应用程序和用户进行交互过程中，特别是账户交易这种核心步骤，强制用户输入验证码，才能完成最终请求。在通常情况下，验证码够很好地遏制 CSRF 攻击。但增加验证码降低了用户的体验，网站不能给所有的操作都加上验证码。所以只能将验证码作为一种辅助手段，在关键业务点设置验证码。</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="点击劫持">点击劫持<a aria-hidden="true" class="hash-link" href="#点击劫持" title="Direct link to heading">​</a></h2><p>视觉欺骗的攻击手段。攻击者将需要攻击的网站通过 iframe 嵌套的方式嵌入到自己的网页中，并将 iframe 设置为透明，在页面中透出一个按钮诱导用户点击</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="特点">特点<a aria-hidden="true" class="hash-link" href="#特点" title="Direct link to heading">​</a></h3><ul><li>隐蔽性高，骗取用户操作</li><li>利用 iframe 或者其他标签的原理</li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="原理">原理<a aria-hidden="true" class="hash-link" href="#原理" title="Direct link to heading">​</a></h3><p>用户在登陆网站 A 的系统后，被攻击者诱惑打开第三方网站，而第三方网站通过 iframe 引入了 A 网站，用户在第三方网站中点击被修饰过的按钮，实际上点击的是 A 网站的按钮。</p><p>比如说在优酷上发布了一些视频，想让更多的人关注它，就可以通过点击劫持来实现。</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="防御-2">防御<a aria-hidden="true" class="hash-link" href="#防御-2" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_y2LR" id="x-frame-options">X-Frame-Options<a aria-hidden="true" class="hash-link" href="#x-frame-options" title="Direct link to heading">​</a></h4><p>它是一个响应头，为了防止 iframe 的嵌套点击劫持</p><p>三个值可以选</p><ul><li>deny 表示页面不允许通过 iframe 的方式展示</li><li>sameorigin 表示页面可以在相同的域名下通过 iframe 嵌套展示</li><li>allow-from 表示页面可以在指定来源的 iframe 展示 X-Frame-Options: allow-from <a href="https://example.com/" target="_blank" rel="noopener noreferrer">https://example.com/</a></li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="url-跳转漏洞">URL 跳转漏洞<a aria-hidden="true" class="hash-link" href="#url-跳转漏洞" title="Direct link to heading">​</a></h2><p>借助未验证的 URL 跳转，将应用程序引导到不安全的第三方区域，从而导致安全问题</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="原理-1">原理<a aria-hidden="true" class="hash-link" href="#原理-1" title="Direct link to heading">​</a></h3><p>黑客利用 URL 跳转的漏洞来诱导安全意识低的用户点击，导致用户的信息泄漏或者资金流失。黑客构造恶意的连接（连接需要进行伪装，尽可能迷惑），发到贴吧或者是群里。</p><p>用户点击之后，经过服务器或者浏览器解析后，跳转到恶意的页面中。</p><p>恶意的连接需要伪装，所以经常的做法就是在一个熟悉的连接后面加上一个恶意的地址，这样才能迷惑用户</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI text"><pre tabindex="0" class="prism-code language-text codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">http://gate.baidu.com/index?act=go&amp;url=http://t.cn/RVTatrd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">http://qt.qq.com/safecheck.html?flag=1&amp;url=http://t.cn/RVTatrd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">http://tieba.baidu.com/f/user/passport?jumpUrl=http://t.cn/RVTatrd</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="实现方式-1">实现方式<a aria-hidden="true" class="hash-link" href="#实现方式-1" title="Direct link to heading">​</a></h3><ul><li>header 跳转</li><li>JavaScript 跳转</li><li>meta 跳转</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><pre tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;?php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$url=$_GET[&#x27;jumpto&#x27;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">header(&quot;Location: $url&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">?&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI text"><pre tabindex="0" class="prism-code language-text codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">http://www.wooyun.org/login.php?jumpto=http://www.evil.com</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>用户认为 <a href="http://www.wooyun.org" target="_blank" rel="noopener noreferrer">www.wooyun.org</a> 是可信的，但是最终跳转到的是<a href="http://www.evil.com%E9%A1%B5%E9%9D%A2" target="_blank" rel="noopener noreferrer">http://www.evil.com页面</a></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="防御-3">防御<a aria-hidden="true" class="hash-link" href="#防御-3" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_y2LR" id="referer-限制">referer 限制<a aria-hidden="true" class="hash-link" href="#referer-限制" title="Direct link to heading">​</a></h4><p>如果确定 url 参数进入的来源，我们就可以通过该方式来实现安全限制，保证 url 的有效性，避免恶意用户生成自己的连接</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="token-1">Token<a aria-hidden="true" class="hash-link" href="#token-1" title="Direct link to heading">​</a></h4><p>我们保证生成的所有连接都来自于我们可信域的，通过在生成的链接里加入用户不可控的 token 来对生成的连接进行校验</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="os-命令注入攻击">OS 命令注入攻击<a aria-hidden="true" class="hash-link" href="#os-命令注入攻击" title="Direct link to heading">​</a></h2><p>OS 命令注入和 SQL 注入差不多，只不过 SQL 注入是针对数据库的，而 OS 注入是针对操作系统的。</p><p>OS 命令注入是指通过 web 应用，执行非法的操作系统命令达到攻击的目的</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="原理-2">原理<a aria-hidden="true" class="hash-link" href="#原理-2" title="Direct link to heading">​</a></h3><p>黑客构造命令提交给 web 程序，web 应用程序提取黑客构造的命令，拼接到被执行的命令中，因黑客注入的命令打破了原有的命令结构，导致 web 程序执行了额外的命令，最后 web 应用程序将执行的结果响应输出到页面中</p><p>需求：用户提交一些内容到服务器，然后在服务器执行一些命令去返回一个结果给用户</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// 以 Node.js 为例，假如在接口中需要从 github 下载用户指定的 repo</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> exec </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;mz/child_process&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exec</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> params </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">/* 用户输入的参数 */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">exec</span><span class="token punctuation" style="color:#393A34">(</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">git clone </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">params</span><span class="token template-string interpolation punctuation" style="color:#393A34">.</span><span class="token template-string interpolation">repo</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string string" style="color:#e3116c"> /some/path</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>如果 params.repo 传入的是 <a href="https://github.com/admin/admin.github.io.git" target="_blank" rel="noopener noreferrer">https://github.com/admin/admin.github.io.git</a> 确实能从指定的 git repo 上下载到想要的代码。</p><p>但是如果 params.repo 传入的是 <a href="https://github.com/xx/xx.git" target="_blank" rel="noopener noreferrer">https://github.com/xx/xx.git</a> &amp;&amp; rm -rf /<!-- -->*<!-- --> &amp;&amp; 恰好你的服务是用 root 权限起的就糟糕了。</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="防御-4">防御<a aria-hidden="true" class="hash-link" href="#防御-4" title="Direct link to heading">​</a></h3><ul><li>后端对前端提交的内容进行规则限制</li><li>在调用系统命令前对所有传入的参数进行命令行参数转义过滤</li><li>不要直接拼接命令语句，借助一些工具做拼接、转义预处理。例如 nodejs 的 shell-escape npm 包</li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_NBRY padding--none margin-left--sm"><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/Blog/docs/tags/网络">网络</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/Blog/docs/tags/攻击">攻击</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/Blog/docs/网络/options-request"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« <!-- -->为什么会有OPTIONS请求</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/Blog/docs/网络/Head-of-Line-Blocking"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">异步请求为什么会导致tcp的对头阻塞<!-- --> »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#sql-注入" class="table-of-contents__link toc-highlight">SQL 注入</a><ul><li><a href="#实现方式" class="table-of-contents__link toc-highlight">实现方式</a></li><li><a href="#防御" class="table-of-contents__link toc-highlight">防御</a></li></ul></li><li><a href="#xss---跨站脚本攻击" class="table-of-contents__link toc-highlight">XSS - 跨站脚本攻击</a><ul><li><a href="#反射型" class="table-of-contents__link toc-highlight">反射型</a></li><li><a href="#存储型" class="table-of-contents__link toc-highlight">存储型</a></li><li><a href="#防御手段" class="table-of-contents__link toc-highlight">防御手段</a></li></ul></li><li><a href="#csrf---跨站请求伪造" class="table-of-contents__link toc-highlight">CSRF - 跨站请求伪造</a><ul><li><a href="#防御-1" class="table-of-contents__link toc-highlight">防御</a></li></ul></li><li><a href="#点击劫持" class="table-of-contents__link toc-highlight">点击劫持</a><ul><li><a href="#特点" class="table-of-contents__link toc-highlight">特点</a></li><li><a href="#原理" class="table-of-contents__link toc-highlight">原理</a></li><li><a href="#防御-2" class="table-of-contents__link toc-highlight">防御</a></li></ul></li><li><a href="#url-跳转漏洞" class="table-of-contents__link toc-highlight">URL 跳转漏洞</a><ul><li><a href="#原理-1" class="table-of-contents__link toc-highlight">原理</a></li><li><a href="#实现方式-1" class="table-of-contents__link toc-highlight">实现方式</a></li><li><a href="#防御-3" class="table-of-contents__link toc-highlight">防御</a></li></ul></li><li><a href="#os-命令注入攻击" class="table-of-contents__link toc-highlight">OS 命令注入攻击</a><ul><li><a href="#原理-2" class="table-of-contents__link toc-highlight">原理</a></li><li><a href="#防御-4" class="table-of-contents__link toc-highlight">防御</a></li></ul></li></ul></div></div></div></div></main></div></div></div>
<script src="/Blog/assets/js/runtime~main.9868b5c7.js"></script>
<script src="/Blog/assets/js/main.796e3833.js"></script>
</body>
</html>