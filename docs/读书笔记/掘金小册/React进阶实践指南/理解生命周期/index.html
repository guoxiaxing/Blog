<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<link rel="alternate" type="application/rss+xml" href="/Blog/blog/rss.xml" title="Try&#39;s Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Blog/blog/atom.xml" title="Try&#39;s Blog Atom Feed"><title data-react-helmet="true">ç†è§£ç”Ÿå‘½å‘¨æœŸ | Try&#x27;s Blog</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://guoxiaxing.github.io/Blog/docs/è¯»ä¹¦ç¬”è®°/æ˜é‡‘å°å†Œ/Reactè¿›é˜¶å®è·µæŒ‡å—/ç†è§£ç”Ÿå‘½å‘¨æœŸ"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="ç†è§£ç”Ÿå‘½å‘¨æœŸ | Try&#x27;s Blog"><meta data-react-helmet="true" name="description" content="ç±»ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ"><meta data-react-helmet="true" property="og:description" content="ç±»ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ"><link data-react-helmet="true" rel="shortcut icon" href="/Blog/img/logo.png"><link data-react-helmet="true" rel="canonical" href="https://guoxiaxing.github.io/Blog/docs/è¯»ä¹¦ç¬”è®°/æ˜é‡‘å°å†Œ/Reactè¿›é˜¶å®è·µæŒ‡å—/ç†è§£ç”Ÿå‘½å‘¨æœŸ"><link data-react-helmet="true" rel="alternate" href="https://guoxiaxing.github.io/Blog/docs/è¯»ä¹¦ç¬”è®°/æ˜é‡‘å°å†Œ/Reactè¿›é˜¶å®è·µæŒ‡å—/ç†è§£ç”Ÿå‘½å‘¨æœŸ" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://guoxiaxing.github.io/Blog/docs/è¯»ä¹¦ç¬”è®°/æ˜é‡‘å°å†Œ/Reactè¿›é˜¶å®è·µæŒ‡å—/ç†è§£ç”Ÿå‘½å‘¨æœŸ" hreflang="x-default"><link rel="stylesheet" href="/Blog/assets/css/styles.c913d63a.css">
<link rel="preload" href="/Blog/assets/js/runtime~main.fe0f6a69.js" as="script">
<link rel="preload" href="/Blog/assets/js/main.b749fead.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Blog/"><div class="navbar__logo"><img src="/Blog/img/logo.png" alt="Try&#x27;s Blog" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/Blog/img/logo.png" alt="Try&#x27;s Blog" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Try&#x27;s Blog</b></a><a class="navbar__item navbar__link navbar__link--active" href="/Blog/docs/quick-link">æŠ€æœ¯</a><a class="navbar__item navbar__link" href="/Blog/blog">ç”Ÿæ´»</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/guoxiaxing/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ğŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ğŸŒ</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div><div class="navbar__search searchBarContainer_I7kZ"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_Zg7X searchBarLoadingRing_J5Ez"><div></div><div></div><div></div><div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Blog/docs/learn-list">å­¦ä¹ æ¸…å•</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Blog/docs/quick-link">ç›®å½•</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">CSS</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Javascript</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Linux</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Typescript</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">å­¦ä¹ æå‡</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">æ¡†æ¶&amp;å¸¸ç”¨åº“</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">ç½‘ç»œ</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">å·¥å…·</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">å·¥ç¨‹åŒ–</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">è¯»ä¹¦ç¬”è®°</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">React Hooksæ ¸å¿ƒåŸç†ä¸å®æˆ˜</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">ç®—æ³•&amp;æ•°æ®ç»“æ„</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">JavaScript</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">æ˜é‡‘å°å†Œ</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Reactè¿›é˜¶å®è·µæŒ‡å—</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Blog/docs/è¯»ä¹¦ç¬”è®°/æ˜é‡‘å°å†Œ/Reactè¿›é˜¶å®è·µæŒ‡å—/react-router">react-router</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Blog/docs/è¯»ä¹¦ç¬”è®°/æ˜é‡‘å°å†Œ/Reactè¿›é˜¶å®è·µæŒ‡å—/äº‹ä»¶åŸç†">äº‹ä»¶åŸç†</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Blog/docs/è¯»ä¹¦ç¬”è®°/æ˜é‡‘å°å†Œ/Reactè¿›é˜¶å®è·µæŒ‡å—/ä¼˜åŒ–-ç»†èŠ‚">ä¼˜åŒ–-ç»†èŠ‚</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Blog/docs/è¯»ä¹¦ç¬”è®°/æ˜é‡‘å°å†Œ/Reactè¿›é˜¶å®è·µæŒ‡å—/å¤šåŠŸèƒ½Ref">å¤šåŠŸèƒ½Ref</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Blog/docs/è¯»ä¹¦ç¬”è®°/æ˜é‡‘å°å†Œ/Reactè¿›é˜¶å®è·µæŒ‡å—/æˆ‘ä»¬å†™çš„JSXç»ˆå°†å˜æˆä»€ä¹ˆ">æˆ‘ä»¬å†™çš„ JSX ç»ˆå°†å˜æˆä»€ä¹ˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Blog/docs/è¯»ä¹¦ç¬”è®°/æ˜é‡‘å°å†Œ/Reactè¿›é˜¶å®è·µæŒ‡å—/æä¾›è€…context">æä¾›è€…context</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Blog/docs/è¯»ä¹¦ç¬”è®°/æ˜é‡‘å°å†Œ/Reactè¿›é˜¶å®è·µæŒ‡å—/æ¨¡å—åŒ–css">æ¨¡å—åŒ– css</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Blog/docs/è¯»ä¹¦ç¬”è®°/æ˜é‡‘å°å†Œ/Reactè¿›é˜¶å®è·µæŒ‡å—/æ·±å…¥props">æ·±å…¥props</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Blog/docs/è¯»ä¹¦ç¬”è®°/æ˜é‡‘å°å†Œ/Reactè¿›é˜¶å®è·µæŒ‡å—/æ¸²æŸ“æ§åˆ¶">æ¸²æŸ“æ§åˆ¶</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Blog/docs/è¯»ä¹¦ç¬”è®°/æ˜é‡‘å°å†Œ/Reactè¿›é˜¶å®è·µæŒ‡å—/æ¸²æŸ“è°ƒä¼˜">æ¸²æŸ“è°ƒä¼˜</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Blog/docs/è¯»ä¹¦ç¬”è®°/æ˜é‡‘å°å†Œ/Reactè¿›é˜¶å®è·µæŒ‡å—/ç„å­¦state">ç„å­¦state</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/Blog/docs/è¯»ä¹¦ç¬”è®°/æ˜é‡‘å°å†Œ/Reactè¿›é˜¶å®è·µæŒ‡å—/ç†è§£ç”Ÿå‘½å‘¨æœŸ">ç†è§£ç”Ÿå‘½å‘¨æœŸ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Blog/docs/è¯»ä¹¦ç¬”è®°/æ˜é‡‘å°å†Œ/Reactè¿›é˜¶å®è·µæŒ‡å—/è‡ªå®šä¹‰Hook">ä¼˜åŒ–-ç»†èŠ‚</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Blog/docs/è¯»ä¹¦ç¬”è®°/æ˜é‡‘å°å†Œ/Reactè¿›é˜¶å®è·µæŒ‡å—/è°ƒå’Œä¸fiber">è°ƒå’Œä¸fiber</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Blog/docs/è¯»ä¹¦ç¬”è®°/æ˜é‡‘å°å†Œ/Reactè¿›é˜¶å®è·µæŒ‡å—/è°ƒåº¦ä¸æ—¶é—´ç‰‡">è°ƒåº¦ä¸æ—¶é—´ç‰‡</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Blog/docs/è¯»ä¹¦ç¬”è®°/æ˜é‡‘å°å†Œ/Reactè¿›é˜¶å®è·µæŒ‡å—/èµ·æºComponent">èµ·æº Component</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Blog/docs/è¯»ä¹¦ç¬”è®°/æ˜é‡‘å°å†Œ/Reactè¿›é˜¶å®è·µæŒ‡å—/é«˜é˜¶ç»„ä»¶">é«˜é˜¶ç»„ä»¶</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">å‰ç«¯ç®—æ³•å’Œæ•°æ®ç»“æ„</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">å‰ç«¯é¢è¯•ä¹‹é“</a></li></ul></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_eoK2"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_e+kA"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>ç†è§£ç”Ÿå‘½å‘¨æœŸ</h1></header><h2 class="anchor anchorWithStickyNavbar_y2LR" id="ç±»ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ">ç±»ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ<a aria-hidden="true" class="hash-link" href="#ç±»ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ" title="Direct link to heading">â€‹</a></h2><p>React ä¸­çš„ä¸¤ä¸ªé‡è¦é˜¶æ®µï¼Œrender é˜¶æ®µå’Œ commit é˜¶æ®µï¼ŒReact åœ¨è°ƒå’Œ( render )é˜¶æ®µä¼šæ·±åº¦éå† React fiber æ ‘ï¼Œç›®çš„å°±æ˜¯å‘ç°ä¸åŒ( diff )ï¼Œä¸åŒçš„åœ°æ–¹å°±æ˜¯æ¥ä¸‹æ¥éœ€è¦æ›´æ–°çš„åœ°æ–¹ï¼Œå¯¹äºå˜åŒ–çš„ç»„ä»¶ï¼Œå°±ä¼šæ‰§è¡Œ render å‡½æ•°ã€‚åœ¨ä¸€æ¬¡è°ƒå’Œè¿‡ç¨‹å®Œæ¯•ä¹‹åï¼Œå°±åˆ°äº† commit é˜¶æ®µï¼Œcommit é˜¶æ®µä¼šåˆ›å»ºä¿®æ”¹çœŸå®çš„ DOM èŠ‚ç‚¹ã€‚</p><p>å¦‚æœåœ¨ä¸€æ¬¡è°ƒå’Œçš„è¿‡ç¨‹ä¸­ï¼Œå‘ç°äº†ä¸€ä¸ª fiber tag = 1 ç±»ç»„ä»¶çš„æƒ…å†µï¼Œå°±ä¼šæŒ‰ç…§ç±»ç»„ä»¶çš„é€»è¾‘æ¥å¤„ç†ã€‚å¯¹äºç±»ç»„ä»¶çš„å¤„ç†é€»è¾‘ï¼Œé¦–å…ˆåˆ¤æ–­ç±»ç»„ä»¶æ˜¯å¦å·²ç»è¢«åˆ›å»ºè¿‡ï¼Œé¦–å…ˆæ¥çœ‹çœ‹æºç é‡Œæ€ä¹ˆå†™çš„ã€‚</p><div class="codeBlockContainer_J+bg"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_oQzk">react-reconciler/src/ReactFiberBeginWork.js</div><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/* workloop React å¤„ç†ç±»ç»„ä»¶çš„ä¸»è¦åŠŸèƒ½æ–¹æ³• */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">updateClassComponent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> shouldUpdate</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> instance </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> workInProgress</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">stateNode</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// stateNode æ˜¯ fiber æŒ‡å‘ ç±»ç»„ä»¶å®ä¾‹çš„æŒ‡é’ˆã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">instance </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// instance ä¸ºç»„ä»¶å®ä¾‹,å¦‚æœç»„ä»¶å®ä¾‹ä¸å­˜åœ¨ï¼Œè¯æ˜è¯¥ç±»ç»„ä»¶æ²¡æœ‰è¢«æŒ‚è½½è¿‡ï¼Œé‚£ä¹ˆä¼šèµ°åˆå§‹åŒ–æµç¨‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">constructClassInstance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">workInProgress</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token maybe-class-name">Component</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> nextProps</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// ç»„ä»¶å®ä¾‹å°†åœ¨è¿™ä¸ªæ–¹æ³•ä¸­è¢«newã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">mountClassInstance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      workInProgress</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token maybe-class-name">Component</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      nextProps</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      renderExpirationTime</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//åˆå§‹åŒ–æŒ‚è½½ç»„ä»¶æµç¨‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    shouldUpdate </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// shouldUpdate æ ‡è¯†ç”¨æ¥è¯æ˜ ç»„ä»¶æ˜¯å¦éœ€è¦æ›´æ–°ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    shouldUpdate </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">updateClassInstance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      current</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      workInProgress</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token maybe-class-name">Component</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      nextProps</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      renderExpirationTime</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// æ›´æ–°ç»„ä»¶æµç¨‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">shouldUpdate</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    nextChildren </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> instance</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* æ‰§è¡Œrenderå‡½æ•° ï¼Œå¾—åˆ°å­èŠ‚ç‚¹ */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">reconcileChildren</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      current</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      workInProgress</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      nextChildren</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      renderExpirationTime</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* ç»§ç»­è°ƒå’Œå­èŠ‚ç‚¹ */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>å‡ ä¸ªé‡è¦çš„æ¦‚å¿µï¼š</p><ol><li>â‘  instance ç±»ç»„ä»¶å¯¹åº”å®ä¾‹ã€‚</li><li>â‘¡ workInProgress æ ‘ï¼Œå½“å‰æ­£åœ¨è°ƒå’Œçš„ fiber æ ‘ ï¼Œä¸€æ¬¡æ›´æ–°ä¸­ï¼ŒReact ä¼šè‡ªä¸Šè€Œä¸‹æ·±åº¦éå†å­ä»£ fiber ï¼Œå¦‚æœéå†åˆ°ä¸€ä¸ª fiber ï¼Œä¼šæŠŠå½“å‰ fiber æŒ‡å‘ workInProgressã€‚</li><li>â‘¢ current æ ‘ï¼Œåœ¨åˆå§‹åŒ–æ›´æ–°ä¸­ï¼Œcurrent = null ï¼Œåœ¨ç¬¬ä¸€æ¬¡ fiber è°ƒå’Œä¹‹åï¼Œä¼šå°† workInProgress æ ‘èµ‹å€¼ç»™ current æ ‘ã€‚React æ¥ç”¨ workInProgress å’Œ current æ¥ç¡®ä¿ä¸€æ¬¡æ›´æ–°ä¸­ï¼Œå¿«é€Ÿæ„å»ºï¼Œå¹¶ä¸”çŠ¶æ€ä¸ä¸¢å¤±ã€‚</li><li>â‘£ Component å°±æ˜¯é¡¹ç›®ä¸­çš„ class ç»„ä»¶ã€‚</li><li>â‘¤ nextProps ä½œä¸ºç»„ä»¶åœ¨ä¸€æ¬¡æ›´æ–°ä¸­æ–°çš„ props ã€‚</li><li>â‘¥ renderExpirationTime ä½œä¸ºä¸‹ä¸€æ¬¡æ¸²æŸ“çš„è¿‡æœŸæ—¶é—´ã€‚</li></ol><p>åœ¨ç»„ä»¶å®ä¾‹ä¸Šå¯ä»¥é€šè¿‡ <code>_reactInternals</code> å±æ€§æ¥è®¿é—®ç»„ä»¶å¯¹åº”çš„ fiber å¯¹è±¡ã€‚åœ¨ fiber å¯¹è±¡ä¸Šï¼Œå¯ä»¥é€šè¿‡ <code>stateNode</code> æ¥è®¿é—®å½“å‰ fiber å¯¹åº”çš„ç»„ä»¶å®ä¾‹ã€‚</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="react-ç±»ç»„ä»¶ç”Ÿå‘½å‘¨æœŸæ‰§è¡Œè¿‡ç¨‹æ¢ç§˜">React ç±»ç»„ä»¶ç”Ÿå‘½å‘¨æœŸæ‰§è¡Œè¿‡ç¨‹æ¢ç§˜<a aria-hidden="true" class="hash-link" href="#react-ç±»ç»„ä»¶ç”Ÿå‘½å‘¨æœŸæ‰§è¡Œè¿‡ç¨‹æ¢ç§˜" title="Direct link to heading">â€‹</a></h3><p>React çš„å¤§éƒ¨åˆ†ç”Ÿå‘½å‘¨æœŸçš„æ‰§è¡Œï¼Œéƒ½åœ¨ mountClassInstance å’Œ updateClassInstance è¿™ä¸¤ä¸ªæ–¹æ³•ä¸­æ‰§è¡Œ</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="åˆå§‹åŒ–é˜¶æ®µ">åˆå§‹åŒ–é˜¶æ®µ<a aria-hidden="true" class="hash-link" href="#åˆå§‹åŒ–é˜¶æ®µ" title="Direct link to heading">â€‹</a></h4><h5 class="anchor anchorWithStickyNavbar_y2LR" id="-constructor-æ‰§è¡Œ">â‘  constructor æ‰§è¡Œ<a aria-hidden="true" class="hash-link" href="#-constructor-æ‰§è¡Œ" title="Direct link to heading">â€‹</a></h5><p>åœ¨ mount é˜¶æ®µï¼Œé¦–å…ˆæ‰§è¡Œçš„ constructClassInstance å‡½æ•°ï¼Œç”¨æ¥å®ä¾‹åŒ– React ç»„ä»¶ï¼Œåœ¨ç»„ä»¶ç« èŠ‚å·²ç»ä»‹ç»äº†è¿™ä¸ªå‡½æ•°ï¼Œç»„ä»¶ä¸­ constructor å°±æ˜¯åœ¨è¿™é‡Œæ‰§è¡Œçš„ã€‚</p><p>åœ¨å®ä¾‹åŒ–ç»„ä»¶ä¹‹åï¼Œä¼šè°ƒç”¨ mountClassInstance ç»„ä»¶åˆå§‹åŒ–ã€‚</p><p>æ¥ä¸‹æ¥çœ‹ä¸€ä¸‹ mountClassInstance åšäº†äº›ä»€ä¹ˆï¼Ÿ æˆ‘åªå†™äº†å’Œç”Ÿå‘½å‘¨æœŸæ¯æ¯ç›¸å…³çš„ä»£ç ã€‚</p><div class="codeBlockContainer_J+bg"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_oQzk">react-reconciler/src/ReactFiberClassComponent.js</div><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">mountClassInstance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token parameter">workInProgress</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"></span><br></span><span class="token-line" style="color:#393A34"><span class="token parameter">  ctor</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"></span><br></span><span class="token-line" style="color:#393A34"><span class="token parameter">  newProps</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"></span><br></span><span class="token-line" style="color:#393A34"><span class="token parameter">  renderExpirationTime</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> instance </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> workInProgress</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">stateNode</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> getDerivedStateFromProps </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ctor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">getDerivedStateFromProps</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> getDerivedStateFromProps </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;function&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">/* ctor å°±æ˜¯æˆ‘ä»¬å†™çš„ç±»ç»„ä»¶ï¼Œè·å–ç±»ç»„ä»¶çš„é™æ€æ–¹æ³• */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> partialState </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getDerivedStateFromProps</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      nextProps</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      prevState</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* è¿™ä¸ªæ—¶å€™æ‰§è¡Œ getDerivedStateFromProps ç”Ÿå‘½å‘¨æœŸ ï¼Œå¾—åˆ°å°†åˆå¹¶çš„state */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> memoizedState </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      partialState </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> partialState </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token keyword nil" style="color:#00009f">undefined</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> prevState</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">Object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">assign</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> prevState</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> partialState</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// åˆå¹¶state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    workInProgress</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">memoizedState</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> memoizedState</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    instance</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">state</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      workInProgress</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">memoizedState</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* å°†state èµ‹å€¼ç»™æˆ‘ä»¬å®ä¾‹ä¸Šï¼Œinstance.state  å°±æ˜¯æˆ‘ä»¬åœ¨ç»„ä»¶ä¸­ this.stateè·å–çš„state*/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> ctor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">getDerivedStateFromProps</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;function&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> instance</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">getSnapshotBeforeUpdate</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;function&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> instance</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">componentWillMount</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;function&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    instance</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">componentWillMount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* å½“ getDerivedStateFromProps å’Œ getSnapshotBeforeUpdate ä¸å­˜åœ¨çš„æ—¶å€™ ï¼Œæ‰§è¡Œ componentWillMount*/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h5 class="anchor anchorWithStickyNavbar_y2LR" id="-getderivedstatefromprops-æ‰§è¡Œ">â‘¡ getDerivedStateFromProps æ‰§è¡Œ<a aria-hidden="true" class="hash-link" href="#-getderivedstatefromprops-æ‰§è¡Œ" title="Direct link to heading">â€‹</a></h5><p>åœ¨åˆå§‹åŒ–é˜¶æ®µï¼ŒgetDerivedStateFromProps æ˜¯ç¬¬äºŒä¸ªæ‰§è¡Œçš„ç”Ÿå‘½å‘¨æœŸï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯å®ƒæ˜¯ä» ctor ç±»ä¸Šç›´æ¥ç»‘å®šçš„é™æ€æ–¹æ³•ï¼Œä¼ å…¥ props ï¼Œstate ã€‚ è¿”å›å€¼å°†å’Œä¹‹å‰çš„ state åˆå¹¶ï¼Œä½œä¸ºæ–°çš„ state ï¼Œä¼ é€’ç»™ç»„ä»¶å®ä¾‹ä½¿ç”¨ã€‚</p><h5 class="anchor anchorWithStickyNavbar_y2LR" id="-componentwillmount-æ‰§è¡Œ">â‘¢ componentWillMount æ‰§è¡Œ<a aria-hidden="true" class="hash-link" href="#-componentwillmount-æ‰§è¡Œ" title="Direct link to heading">â€‹</a></h5><p>å¦‚æœå­˜åœ¨ getDerivedStateFromProps å’Œ getSnapshotBeforeUpdate å°±ä¸ä¼šæ‰§è¡Œç”Ÿå‘½å‘¨æœŸ componentWillMountã€‚</p><h5 class="anchor anchorWithStickyNavbar_y2LR" id="-render-å‡½æ•°æ‰§è¡Œ">â‘£ render å‡½æ•°æ‰§è¡Œ<a aria-hidden="true" class="hash-link" href="#-render-å‡½æ•°æ‰§è¡Œ" title="Direct link to heading">â€‹</a></h5><p>åˆ°æ­¤ä¸ºæ­¢ mountClassInstancec å‡½æ•°å®Œæˆï¼Œä½†æ˜¯ä¸Šé¢ updateClassComponent å‡½æ•°ï¼Œ åœ¨æ‰§è¡Œå®Œ mountClassInstancec åï¼Œæ‰§è¡Œäº† render æ¸²æŸ“å‡½æ•°ï¼Œå½¢æˆäº† children ï¼Œ æ¥ä¸‹æ¥ React è°ƒç”¨ reconcileChildren æ–¹æ³•æ·±åº¦è°ƒå’Œ children ã€‚</p><h5 class="anchor anchorWithStickyNavbar_y2LR" id="componentdidmount-æ‰§è¡Œ">â‘¤componentDidMount æ‰§è¡Œ<a aria-hidden="true" class="hash-link" href="#componentdidmount-æ‰§è¡Œ" title="Direct link to heading">â€‹</a></h5><p>ä¸Šè¿°æåŠçš„å‡ ç”Ÿå‘½å‘¨æœŸéƒ½æ˜¯åœ¨ render é˜¶æ®µæ‰§è¡Œçš„ã€‚ä¸€æ—¦ React è°ƒå’Œå®Œæ‰€æœ‰çš„ fiber èŠ‚ç‚¹ï¼Œå°±ä¼šåˆ° commit é˜¶æ®µï¼Œåœ¨ç»„ä»¶åˆå§‹åŒ– commit é˜¶æ®µï¼Œä¼šè°ƒç”¨ componentDidMount ç”Ÿå‘½å‘¨æœŸã€‚</p><div class="codeBlockContainer_J+bg"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_oQzk">react-reconciler/src/ReactFiberCommitWork.js</div><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">commitLifeCycles</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">finishedRoot</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">current</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">finishedWork</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">finishedWork</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">tag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">                             </span><span class="token comment" style="color:#999988;font-style:italic">/* fiber tag åœ¨ç¬¬ä¸€èŠ‚è®²äº†ä¸åŒfiberç±»å‹ */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token maybe-class-name">ClassComponent</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">                              </span><span class="token comment" style="color:#999988;font-style:italic">/* å¦‚æœæ˜¯ ç±»ç»„ä»¶ ç±»å‹ */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> instance </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> finishedWork</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">stateNode</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">/* ç±»å®ä¾‹ */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">current </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">                          </span><span class="token comment" style="color:#999988;font-style:italic">/* ç±»ç»„ä»¶ç¬¬ä¸€æ¬¡è°ƒå’Œæ¸²æŸ“ */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               instance</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">componentDidMount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">                                         </span><span class="token comment" style="color:#999988;font-style:italic">/* ç±»ç»„ä»¶æ›´æ–° */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               instance</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">componentDidUpdate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">prevProps</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">prevStateï¼Œinstance</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">__reactInternalSnapshotBeforeUpdate</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>ä»ä¸Šé¢å¯ä»¥ç›´è§‚çœ‹åˆ° componentDidMount æ‰§è¡Œæ—¶æœº å’Œ componentDidUpdate æ‰§è¡Œæ—¶æœºæ˜¯ç›¸åŒçš„ ï¼Œåªä¸è¿‡ä¸€ä¸ªæ˜¯é’ˆå¯¹åˆå§‹åŒ–ï¼Œä¸€ä¸ªæ˜¯é’ˆå¯¹ç»„ä»¶å†æ›´æ–°ã€‚åˆ°æ­¤åˆå§‹åŒ–é˜¶æ®µï¼Œç”Ÿå‘½å‘¨æœŸæ‰§è¡Œå®Œæ¯•ã€‚</p><p>æ‰§è¡Œé¡ºåºï¼šconstructor -&gt; getDerivedStateFromProps / componentWillMount -&gt; render -&gt; componentDidMount</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>render å‡½æ•°ä»¥åŠ render å‡½æ•°ä¹‹å‰çš„å‡½æ•°éƒ½æ˜¯åœ¨ render é˜¶æ®µæ‰§è¡Œçš„ï¼›componentDidMountï¼ˆcommit é˜¶æ®µçš„ Layout é˜¶æ®µæ‰§è¡Œï¼‰ æ˜¯åœ¨ commit é˜¶æ®µ DOM æ›´æ–°å®Œæˆä¹‹åå†æ‰§è¡Œï¼ˆæµè§ˆå™¨æ¸²æŸ“é¡µé¢ä¹‹å‰ï¼‰</p></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="æ›´æ–°é˜¶æ®µ">æ›´æ–°é˜¶æ®µ<a aria-hidden="true" class="hash-link" href="#æ›´æ–°é˜¶æ®µ" title="Direct link to heading">â€‹</a></h4><p>åœ¨ updateClassComponent å‡½æ•°ä¸­ï¼Œå½“å‘ç° current ä¸ä¸º null çš„æƒ…å†µæ—¶ï¼Œè¯´æ˜è¯¥ç±»ç»„ä»¶è¢«æŒ‚è½½è¿‡ï¼Œé‚£ä¹ˆç›´æ¥æŒ‰ç…§æ›´æ–°é€»è¾‘æ¥å¤„ç†ã€‚</p><div class="codeBlockContainer_J+bg"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_oQzk">react-reconciler/src/ReactFiberClassComponent.js</div><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">updateClassInstance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token parameter">current</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"></span><br></span><span class="token-line" style="color:#393A34"><span class="token parameter">  workInProgress</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"></span><br></span><span class="token-line" style="color:#393A34"><span class="token parameter">  ctor</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"></span><br></span><span class="token-line" style="color:#393A34"><span class="token parameter">  newProps</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"></span><br></span><span class="token-line" style="color:#393A34"><span class="token parameter">  renderExpirationTime</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> instance </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> workInProgress</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">stateNode</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// ç±»ç»„ä»¶å®ä¾‹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> hasNewLifecycles </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> ctor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">getDerivedStateFromProps</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;function&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// åˆ¤æ–­æ˜¯å¦å…·æœ‰ getDerivedStateFromProps ç”Ÿå‘½å‘¨æœŸ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">!</span><span class="token plain">hasNewLifecycles </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> instance</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">componentWillReceiveProps</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;function&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">oldProps </span><span class="token operator" style="color:#393A34">!==</span><span class="token plain"> newProps </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> oldContext </span><span class="token operator" style="color:#393A34">!==</span><span class="token plain"> nextContext</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// æµ…æ¯”è¾ƒ props ä¸ç›¸ç­‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      instance</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">componentWillReceiveProps</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">newProps</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> nextContext</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// æ‰§è¡Œç”Ÿå‘½å‘¨æœŸ componentWillReceiveProps</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> newState </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">instance</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">state</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> oldState</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> getDerivedStateFromProps </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;function&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ctor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getDerivedStateFromProps</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      nextProps</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      prevState</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* æ‰§è¡Œç”Ÿå‘½å‘¨æœŸgetDerivedStateFromProps  ï¼Œé€»è¾‘å’Œmountedç±»ä¼¼ ï¼Œåˆå¹¶state  */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    newState </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> workInProgress</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">memoizedState</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> shouldUpdate </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> instance</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">shouldComponentUpdate</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;function&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">/* æ‰§è¡Œç”Ÿå‘½å‘¨æœŸ shouldComponentUpdate è¿”å›å€¼å†³å®šæ˜¯å¦æ‰§è¡Œrender ï¼Œè°ƒå’Œå­èŠ‚ç‚¹ */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    shouldUpdate </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> instance</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">shouldComponentUpdate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      newProps</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      newState</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      nextContext</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">shouldUpdate</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> instance</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">componentWillUpdate</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;function&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      instance</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">componentWillUpdate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* æ‰§è¡Œç”Ÿå‘½å‘¨æœŸ componentWillUpdate  */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> shouldUpdate</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h5 class="anchor anchorWithStickyNavbar_y2LR" id="-æ‰§è¡Œç”Ÿå‘½å‘¨æœŸ-componentwillreceiveprops">â‘  æ‰§è¡Œç”Ÿå‘½å‘¨æœŸ componentWillReceiveProps<a aria-hidden="true" class="hash-link" href="#-æ‰§è¡Œç”Ÿå‘½å‘¨æœŸ-componentwillreceiveprops" title="Direct link to heading">â€‹</a></h5><p>é¦–å…ˆåˆ¤æ–­ getDerivedStateFromProps ç”Ÿå‘½å‘¨æœŸæ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨å°±æ‰§è¡Œ componentWillReceiveProps ç”Ÿå‘½å‘¨æœŸã€‚ä¼ å…¥è¯¥ç”Ÿå‘½å‘¨æœŸä¸¤ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯ newProps å’Œ nextContext ã€‚</p><h5 class="anchor anchorWithStickyNavbar_y2LR" id="-æ‰§è¡Œç”Ÿå‘½å‘¨æœŸ-getderivedstatefromprops">â‘¡ æ‰§è¡Œç”Ÿå‘½å‘¨æœŸ getDerivedStateFromProps<a aria-hidden="true" class="hash-link" href="#-æ‰§è¡Œç”Ÿå‘½å‘¨æœŸ-getderivedstatefromprops" title="Direct link to heading">â€‹</a></h5><p>æ¥ä¸‹æ¥æ‰§è¡Œç”Ÿå‘½å‘¨æœŸ getDerivedStateFromPropsï¼Œ è¿”å›çš„å€¼ç”¨äºåˆå¹¶ stateï¼Œç”Ÿæˆæ–°çš„ stateã€‚</p><h5 class="anchor anchorWithStickyNavbar_y2LR" id="-æ‰§è¡Œç”Ÿå‘½å‘¨æœŸ-shouldcomponentupdate">â‘¢ æ‰§è¡Œç”Ÿå‘½å‘¨æœŸ shouldComponentUpdate<a aria-hidden="true" class="hash-link" href="#-æ‰§è¡Œç”Ÿå‘½å‘¨æœŸ-shouldcomponentupdate" title="Direct link to heading">â€‹</a></h5><p>æ¥ä¸‹æ¥æ‰§è¡Œç”Ÿå‘½å‘¨æœŸ shouldComponentUpdateï¼Œä¼ å…¥æ–°çš„ props ï¼Œæ–°çš„ state ï¼Œå’Œæ–°çš„ context ï¼Œè¿”å›å€¼å†³å®šæ˜¯å¦ç»§ç»­æ‰§è¡Œ render å‡½æ•°ï¼Œè°ƒå’Œå­èŠ‚ç‚¹ã€‚è¿™é‡Œåº”è¯¥æ³¨æ„ä¸€ä¸ªé—®é¢˜ï¼ŒgetDerivedStateFromProps çš„è¿”å›å€¼å¯ä»¥ä½œä¸ºæ–°çš„ state ï¼Œä¼ é€’ç»™ shouldComponentUpdate ã€‚</p><h5 class="anchor anchorWithStickyNavbar_y2LR" id="-æ‰§è¡Œç”Ÿå‘½å‘¨æœŸ-componentwillupdate">â‘£ æ‰§è¡Œç”Ÿå‘½å‘¨æœŸ componentWillUpdate<a aria-hidden="true" class="hash-link" href="#-æ‰§è¡Œç”Ÿå‘½å‘¨æœŸ-componentwillupdate" title="Direct link to heading">â€‹</a></h5><p>æ¥ä¸‹æ¥æ‰§è¡Œç”Ÿå‘½å‘¨æœŸ componentWillUpdateã€‚updateClassInstance æ–¹æ³•åˆ°æ­¤æ‰§è¡Œå®Œæ¯•äº†ã€‚</p><h5 class="anchor anchorWithStickyNavbar_y2LR" id="-æ‰§è¡Œ-render-å‡½æ•°">â‘¤ æ‰§è¡Œ render å‡½æ•°<a aria-hidden="true" class="hash-link" href="#-æ‰§è¡Œ-render-å‡½æ•°" title="Direct link to heading">â€‹</a></h5><p>æ¥ä¸‹æ¥ä¼šæ‰§è¡Œ render å‡½æ•°ï¼Œå¾—åˆ°æœ€æ–°çš„ React element å…ƒç´ ã€‚ç„¶åç»§ç»­è°ƒå’Œå­èŠ‚ç‚¹ã€‚</p><h5 class="anchor anchorWithStickyNavbar_y2LR" id="-æ‰§è¡Œ-getsnapshotbeforeupdate">â‘¥ æ‰§è¡Œ getSnapshotBeforeUpdate<a aria-hidden="true" class="hash-link" href="#-æ‰§è¡Œ-getsnapshotbeforeupdate" title="Direct link to heading">â€‹</a></h5><div class="codeBlockContainer_J+bg"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_oQzk">react-reconciler/src/ReactFiberCommitWork.js</div><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">commitBeforeMutationLifeCycles</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">current</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> finishedWork</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">finishedWork</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">tag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token maybe-class-name">ClassComponent</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> snapshot </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> instance</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getSnapshotBeforeUpdate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        prevProps</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        prevState</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* æ‰§è¡Œç”Ÿå‘½å‘¨æœŸ getSnapshotBeforeUpdate   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      instance</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">__reactInternalSnapshotBeforeUpdate</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        snapshot</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* è¿”å›å€¼å°†ä½œä¸º __reactInternalSnapshotBeforeUpdate ä¼ é€’ç»™ componentDidUpdate ç”Ÿå‘½å‘¨æœŸ  */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>getSnapshotBeforeUpdate çš„æ‰§è¡Œä¹Ÿæ˜¯åœ¨ commit é˜¶æ®µï¼Œcommit é˜¶æ®µç»†åˆ†ä¸º<code> before Mutation( DOM ä¿®æ”¹å‰)</code>ï¼Œ<code>Mutation ( DOM ä¿®æ”¹)</code>ï¼Œ<code>Layout( DOM ä¿®æ”¹å)</code> ä¸‰ä¸ªé˜¶æ®µï¼ŒgetSnapshotBeforeUpdate å‘ç”Ÿåœ¨ before Mutation é˜¶æ®µï¼Œç”Ÿå‘½å‘¨æœŸçš„è¿”å›å€¼ï¼Œå°†ä½œä¸ºç¬¬ä¸‰ä¸ªå‚æ•° <!-- -->_<!-- -->_<!-- -->reactInternalSnapshotBeforeUpdate ä¼ é€’ç»™ componentDidUpdate ã€‚</p><h5 class="anchor anchorWithStickyNavbar_y2LR" id="-æ‰§è¡Œ-componentdidupdate">â‘¦ æ‰§è¡Œ componentDidUpdate<a aria-hidden="true" class="hash-link" href="#-æ‰§è¡Œ-componentdidupdate" title="Direct link to heading">â€‹</a></h5><p>æ¥ä¸‹æ¥æ‰§è¡Œç”Ÿå‘½å‘¨æœŸ componentDidUpdate ï¼Œæ­¤æ—¶ DOM å·²ç»ä¿®æ”¹å®Œæˆã€‚å¯ä»¥æ“ä½œä¿®æ”¹ä¹‹åçš„ DOM ã€‚åˆ°æ­¤ä¸ºæ­¢æ›´æ–°é˜¶æ®µçš„ç”Ÿå‘½å‘¨æœŸæ‰§è¡Œå®Œæ¯•ã€‚</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>getSnapshotBeforeUpdate æ˜¯åœ¨ commit çš„é˜¶æ®µçš„<code>before Mutation</code>é˜¶æ®µæ‰§è¡Œï¼›æ›´æ–° DOM æ˜¯åœ¨ commit é˜¶æ®µçš„<code>Mutation</code>é˜¶æ®µæ‰§è¡Œï¼›componentDidUpdate æ˜¯åœ¨ commit é˜¶æ®µçš„ Layout é˜¶æ®µæ‰§è¡Œ</p></div></div><p>æ›´æ–°é˜¶æ®µå¯¹åº”çš„ç”Ÿå‘½å‘¨æœŸçš„æ‰§è¡Œé¡ºåºï¼š</p><p>componentWillReceiveProps( props æ”¹å˜) / getDerivedStateFromProp -&gt; shouldComponentUpdate -&gt; componentWillUpdate -&gt; render -&gt; getSnapshotBeforeUpdate -&gt; componentDidUpdate</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="é”€æ¯é˜¶æ®µ">é”€æ¯é˜¶æ®µ<a aria-hidden="true" class="hash-link" href="#é”€æ¯é˜¶æ®µ" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_J+bg"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_oQzk">react-reconciler/src/ReactFiberCommitWork.js</div><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">callComponentWillUnmountWithTimer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  instance</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">componentWillUnmount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h5 class="anchor anchorWithStickyNavbar_y2LR" id="-æ‰§è¡Œç”Ÿå‘½å‘¨æœŸ-componentwillunmount">â‘  æ‰§è¡Œç”Ÿå‘½å‘¨æœŸ componentWillUnmount<a aria-hidden="true" class="hash-link" href="#-æ‰§è¡Œç”Ÿå‘½å‘¨æœŸ-componentwillunmount" title="Direct link to heading">â€‹</a></h5><p>é”€æ¯é˜¶æ®µå°±æ¯”è¾ƒç®€å•äº†ï¼Œåœ¨ä¸€æ¬¡è°ƒå’Œæ›´æ–°ä¸­ï¼Œå¦‚æœå‘ç°å…ƒç´ è¢«ç§»é™¤ï¼Œå°±ä¼šæ‰“å¯¹åº”çš„ Deletion æ ‡ç­¾ ï¼Œç„¶ååœ¨ commit é˜¶æ®µå°±ä¼šè°ƒç”¨ componentWillUnmount ç”Ÿå‘½å‘¨æœŸï¼Œæ¥ä¸‹æ¥ç»Ÿä¸€å¸è½½ç»„ä»¶ä»¥åŠ DOM å…ƒç´ ã€‚(<strong>åœ¨ commit é˜¶æ®µçš„ Before Mutation é˜¶æ®µæ‰§è¡Œ</strong>)</p><p><img alt="å®Œæ•´ç”Ÿå‘½å‘¨æœŸå›¾" src="/Blog/assets/images/7066da719fda4a91aa2c432f60c58a48_tplv-k3u1fbpfcp-zoom-in-crop-mark_3024_0_0_0-4e23ac12f6ca8cac2aedb979ff77e44f.png"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="react-å„é˜¶æ®µç”Ÿå‘½å‘¨æœŸèƒ½åšäº›ä»€ä¹ˆ">React å„é˜¶æ®µç”Ÿå‘½å‘¨æœŸèƒ½åšäº›ä»€ä¹ˆ<a aria-hidden="true" class="hash-link" href="#react-å„é˜¶æ®µç”Ÿå‘½å‘¨æœŸèƒ½åšäº›ä»€ä¹ˆ" title="Direct link to heading">â€‹</a></h3><h4 class="anchor anchorWithStickyNavbar_y2LR" id="constructor">constructor<a aria-hidden="true" class="hash-link" href="#constructor" title="Direct link to heading">â€‹</a></h4><p>constructor åœ¨ç±»ç»„ä»¶åˆ›å»ºå®ä¾‹æ—¶è°ƒç”¨ï¼Œè€Œä¸”åˆå§‹åŒ–çš„æ—¶å€™æ‰§è¡Œä¸€æ¬¡ï¼Œæ‰€ä»¥å¯ä»¥åœ¨ constructor åšä¸€äº›åˆå§‹åŒ–çš„å·¥ä½œã€‚</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">constructor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">props</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">props</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// æ‰§è¡Œ super ï¼Œåˆ«å¿˜äº†ä¼ é€’props,æ‰èƒ½åœ¨æ¥ä¸‹æ¥çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œè·å–åˆ°propsã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">state</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">       </span><span class="token comment" style="color:#999988;font-style:italic">//â‘  å¯ä»¥ç”¨æ¥åˆå§‹åŒ–stateï¼Œæ¯”å¦‚å¯ä»¥ç”¨æ¥è·å–è·¯ç”±ä¸­çš„</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        name</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&#x27;alien&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">handleClick</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">handleClick</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">bind</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* â‘¡ ç»‘å®š this */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">handleInputChange</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">debounce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">handleInputChange</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">500</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* â‘¢ ç»‘å®šé˜²æŠ–å‡½æ•°ï¼Œé˜²æŠ– 500 æ¯«ç§’ */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> _render </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">render</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">render</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> _render</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">bind</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">/* â‘£ åŠ«æŒä¿®æ”¹ç±»ç»„ä»¶ä¸Šçš„ä¸€äº›ç”Ÿå‘½å‘¨æœŸ */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">/* ç‚¹å‡»äº‹ä»¶ */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">handleClick</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* ... */</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">/* è¡¨å•è¾“å…¥ */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">handleInputChange</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* ... */</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ul><li>åˆå§‹åŒ– state ï¼Œæ¯”å¦‚å¯ä»¥ç”¨æ¥æˆªå–è·¯ç”±ä¸­çš„å‚æ•°ï¼Œèµ‹å€¼ç»™ state ã€‚</li><li>å¯¹ç±»ç»„ä»¶çš„äº‹ä»¶åšä¸€äº›å¤„ç†ï¼Œæ¯”å¦‚ç»‘å®š this ï¼Œ èŠ‚æµï¼Œé˜²æŠ–ç­‰ã€‚</li><li>å¯¹ç±»ç»„ä»¶è¿›è¡Œä¸€äº›å¿…è¦ç”Ÿå‘½å‘¨æœŸçš„åŠ«æŒï¼Œæ¸²æŸ“åŠ«æŒï¼Œè¿™ä¸ªåŠŸèƒ½æ›´é€‚åˆåå‘ç»§æ‰¿çš„ HOC ï¼Œåœ¨ HOC ç¯èŠ‚ï¼Œä¼šè¯¦ç»†è®²è§£åå‘ç»§æ‰¿è¿™ç§æ¨¡å¼ã€‚</li></ul><h4 class="anchor anchorWithStickyNavbar_y2LR" id="getderivedstatefromprops">getDerivedStateFromProps<a aria-hidden="true" class="hash-link" href="#getderivedstatefromprops" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">getDerivedStateFromProps</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">nextProps</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> prevState</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ul><li>nextProps çˆ¶ç»„ä»¶æ–°ä¼ é€’çš„ props ;</li><li>prevState ç»„ä»¶åœ¨æ­¤æ¬¡æ¸²æŸ“å‰å¾…æ›´æ–°çš„ state ã€‚</li></ul><p>getDerivedStateFromProps æ–¹æ³•ä½œä¸ºç±»çš„é™æ€å±æ€§æ–¹æ³•æ‰§è¡Œï¼Œå†…éƒ¨æ˜¯<strong>è®¿é—®ä¸åˆ° this çš„</strong>ï¼Œå®ƒæ›´è¶‹å‘äºçº¯å‡½æ•°</p><p>è¿™ä¸ªç”Ÿå‘½å‘¨æœŸç”¨äºï¼Œåœ¨åˆå§‹åŒ–å’Œæ›´æ–°é˜¶æ®µï¼Œæ¥å—çˆ¶ç»„ä»¶çš„ props æ•°æ®ï¼Œ å¯ä»¥å¯¹ props è¿›è¡Œæ ¼å¼åŒ–ï¼Œè¿‡æ»¤ç­‰æ“ä½œï¼Œè¿”å›å€¼å°†ä½œä¸ºæ–°çš„ state åˆå¹¶åˆ° state ä¸­ï¼Œä¾›ç»™è§†å›¾æ¸²æŸ“å±‚æ¶ˆè´¹ã€‚</p><p>æ¥å— props å˜åŒ– ï¼Œ è¿”å›å€¼å°†ä½œä¸ºæ–°çš„ state ï¼Œç”¨äº æ¸²æŸ“ æˆ– ä¼ é€’ç»™ s houldComponentUpdate</p><p>ä½œç”¨ï¼š</p><ul><li>ä»£æ›¿ componentWillMount å’Œ componentWillReceiveProps</li><li>ç»„ä»¶åˆå§‹åŒ–æˆ–è€…æ›´æ–°æ—¶ï¼Œå°† props æ˜ å°„åˆ° stateã€‚</li><li>è¿”å›å€¼ä¸ state åˆå¹¶å®Œï¼Œå¯ä»¥ä½œä¸º shouldComponentUpdate ç¬¬äºŒä¸ªå‚æ•° newState ï¼Œå¯ä»¥åˆ¤æ–­æ˜¯å¦æ¸²æŸ“ç»„ä»¶ã€‚(è¯·ä¸è¦æŠŠ getDerivedStateFromProps å’Œ shouldComponentUpdate å¼ºè¡Œå…³è”åˆ°ä¸€èµ·ï¼Œä¸¤è€…æ²¡æœ‰å¿…ç„¶è”ç³»)</li></ul><h4 class="anchor anchorWithStickyNavbar_y2LR" id="componentwillmount-å’Œ-unsafe_componentwillmount">componentWillMount å’Œ UNSAFE_componentWillMount<a aria-hidden="true" class="hash-link" href="#componentwillmount-å’Œ-unsafe_componentwillmount" title="Direct link to heading">â€‹</a></h4><p>componentWillMount ï¼ŒcomponentWillReceiveProps ï¼Œ componentWillUpdate è¿™ä¸‰ä¸ªç”Ÿå‘½å‘¨æœŸï¼Œéƒ½æ˜¯åœ¨ render ä¹‹å‰æ‰§è¡Œçš„ï¼ŒReact å¯¹äºæ‰§è¡Œ render å‡½æ•°æœ‰ç€åƒ shouldUpdate ç­‰æ¡ä»¶åˆ¶çº¦ï¼Œä½†æ˜¯å¯¹äºæ‰§è¡Œåœ¨ render ä¹‹å‰ç”Ÿå‘½å‘¨æœŸæ²¡æœ‰é™åˆ¶ï¼Œå­˜åœ¨ä¸€å®šéšåŒ¿é£é™©ï¼Œå¦‚æœ updateClassInstance æ‰§è¡Œå¤šæ¬¡ï¼ŒReact å¼€å‘è€…æ»¥ç”¨è¿™å‡ ä¸ªç”Ÿå‘½å‘¨æœŸï¼Œå¯èƒ½å¯¼è‡´ç”Ÿå‘½å‘¨æœŸå†…çš„ä¸Šä¸‹æ–‡å¤šæ¬¡è¢«æ‰§è¡Œã€‚</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="componentwillreceiveprops-å’Œ-unsafe_componentwillreceiveprops">componentWillReceiveProps å’Œ UNSAFE_componentWillReceiveProps<a aria-hidden="true" class="hash-link" href="#componentwillreceiveprops-å’Œ-unsafe_componentwillreceiveprops" title="Direct link to heading">â€‹</a></h4><p>UNSAFE_componentWillReceiveProps å‡½æ•°çš„æ‰§è¡Œæ˜¯åœ¨æ›´æ–°ç»„ä»¶é˜¶æ®µï¼Œè¯¥ç”Ÿå‘½å‘¨æœŸæ‰§è¡Œé©±åŠ¨æ˜¯å› ä¸ºçˆ¶ç»„ä»¶æ›´æ–°å¸¦æ¥çš„ props ä¿®æ”¹ï¼Œä½†æ˜¯åªè¦çˆ¶ç»„ä»¶è§¦å‘ render å‡½æ•°ï¼Œè°ƒç”¨ React.createElement æ–¹æ³•ï¼Œé‚£ä¹ˆ props å°±ä¼šè¢«é‡æ–°åˆ›å»ºï¼Œç”Ÿå‘½å‘¨æœŸ componentWillReceiveProps å°±ä¼šæ‰§è¡Œäº†ã€‚è¿™å°±è§£é‡Šäº†å³ä½¿ props æ²¡å˜ï¼Œè¯¥ç”Ÿå‘½å‘¨æœŸä¹Ÿä¼šæ‰§è¡Œã€‚</p><ul><li>componentWillReceiveProps å¯ä»¥ç”¨æ¥ç›‘å¬çˆ¶ç»„ä»¶æ˜¯å¦æ‰§è¡Œ render ã€‚</li><li>componentWillReceiveProps å¯ä»¥ç”¨æ¥æ¥å— props æ”¹å˜ï¼Œç»„ä»¶å¯ä»¥æ ¹æ® props æ”¹å˜ï¼Œæ¥å†³å®šæ˜¯å¦æ›´æ–° state ï¼Œå› ä¸ºå¯ä»¥è®¿é—®åˆ° this ï¼Œ æ‰€ä»¥å¯ä»¥åœ¨å¼‚æ­¥æˆåŠŸå›è°ƒ(æ¥å£è¯·æ±‚æ•°æ®)æ”¹å˜ state ã€‚è¿™ä¸ªæ˜¯ getDerivedStateFromProps ä¸èƒ½å®ç°çš„ã€‚</li></ul><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>warning</h5></div><div class="admonition-content"><p>å½“ props ä¸å˜çš„å‰æä¸‹ï¼Œ PureComponent ç»„ä»¶èƒ½å¦é˜»æ­¢ componentWillReceiveProps æ‰§è¡Œ?</p><p>ç­”æ¡ˆæ˜¯å¦å®šçš„ï¼ŒcomponentWillReceiveProps ç”Ÿå‘½å‘¨æœŸçš„æ‰§è¡Œï¼Œå’Œçº¯ç»„ä»¶æ²¡æœ‰å…³ç³»ï¼Œçº¯ç»„ä»¶æ˜¯åœ¨ componentWillReceiveProps æ‰§è¡Œä¹‹å(shouldComponentUpdate ç”Ÿå‘½å‘¨æœŸä¸­)æµ…æ¯”è¾ƒ props æ˜¯å¦å‘ç”Ÿå˜åŒ–ã€‚æ‰€ä»¥ PureComponent ä¸‹ä¸ä¼šé˜»æ­¢è¯¥ç”Ÿå‘½å‘¨æœŸçš„æ‰§è¡Œã€‚</p></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="componentwillupdate-å’Œ-unsafe_componentwillupdate">componentWillUpdate å’Œ UNSAFE_componentWillUpdate<a aria-hidden="true" class="hash-link" href="#componentwillupdate-å’Œ-unsafe_componentwillupdate" title="Direct link to heading">â€‹</a></h4><p>æ­¤æ—¶çš„ DOM è¿˜æ²¡æœ‰æ›´æ–°ã€‚åœ¨è¿™é‡Œå¯ä»¥åšä¸€äº›è·å– DOM çš„æ“ä½œã€‚å°±æ¯”å¦‚è¯´åœ¨ä¸€æ¬¡æ›´æ–°ä¸­ï¼Œä¿å­˜ DOM ä¹‹å‰çš„ä¿¡æ¯(è®°å½•ä¸Šä¸€æ¬¡ä½ç½®)ã€‚ä½†æ˜¯ React å·²ç»å‡ºäº†æ–°çš„ç”Ÿå‘½å‘¨æœŸ getSnapshotBeforeUpdate æ¥ä»£æ›¿ UNSAFE_componentWillUpdateã€‚</p><p>ä½œç”¨ï¼š</p><p>è·å–ç»„ä»¶æ›´æ–°ä¹‹å‰çš„çŠ¶æ€ã€‚æ¯”å¦‚ DOM å…ƒç´ ä½ç½®ç­‰ã€‚</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="render">render<a aria-hidden="true" class="hash-link" href="#render" title="Direct link to heading">â€‹</a></h4><p>render å‡½æ•°ï¼Œå°±æ˜¯ jsx çš„å„ä¸ªå…ƒç´ è¢« React.createElement åˆ›å»ºæˆ React element å¯¹è±¡çš„å½¢å¼ã€‚ä¸€æ¬¡ render çš„è¿‡ç¨‹ï¼Œå°±æ˜¯åˆ›å»º React.element å…ƒç´ çš„è¿‡ç¨‹ã€‚</p><ul><li>é‚£ä¹ˆå¯ä»¥åœ¨ render é‡Œé¢åšä¸€äº›,createElement åˆ›å»ºå…ƒç´  , cloneElement å…‹éš†å…ƒç´  ï¼ŒReact.children éå† children çš„æ“ä½œã€‚</li></ul><h4 class="anchor anchorWithStickyNavbar_y2LR" id="getsnapshotbeforeupdate">getSnapshotBeforeUpdate<a aria-hidden="true" class="hash-link" href="#getsnapshotbeforeupdate" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">getSnapshotBeforeUpdate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">prevProps</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">preState</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>è¯¥ç”Ÿå‘½å‘¨æœŸæ˜¯åœ¨ commit é˜¶æ®µçš„ before Mutation ( DOM ä¿®æ”¹å‰)ï¼Œæ­¤æ—¶ DOM è¿˜æ²¡æœ‰æ›´æ–°ï¼Œä½†æ˜¯åœ¨æ¥ä¸‹æ¥çš„ Mutation é˜¶æ®µä¼šè¢«æ›¿æ¢æˆçœŸå® DOM ã€‚æ­¤æ—¶æ˜¯è·å– DOM ä¿¡æ¯çš„æœ€ä½³æ—¶æœŸï¼ŒgetSnapshotBeforeUpdate å°†è¿”å›ä¸€ä¸ªå€¼ä½œä¸ºä¸€ä¸ª snapShot(å¿«ç…§)ï¼Œä¼ é€’ç»™ componentDidUpdate ä½œä¸ºç¬¬ä¸‰ä¸ªå‚æ•°ã€‚</p><p>æ³¨æ„ï¼šå¦‚æœæ²¡æœ‰è¿”å›å€¼ä¼šç»™äºˆè­¦å‘Š âš ï¸ï¼Œå¦‚æœæ²¡æœ‰ componentDidUpdate ä¹Ÿä¼šç»™äºˆè­¦å‘Šã€‚(ä¹Ÿå°±æ˜¯è¯´éœ€è¦æ­é… componentDidUpdate ä¸€èµ·ä½¿ç”¨)</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">getSnapshotBeforeUpdate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">prevProps</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">preState</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> style </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getComputedStyle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">node</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* ä¼ é€’æ›´æ–°å‰çš„å…ƒç´ ä½ç½® */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        cx</span><span class="token operator" style="color:#393A34">:</span><span class="token plain">style</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">cx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        cy</span><span class="token operator" style="color:#393A34">:</span><span class="token plain">style</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">cy</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">componentDidUpdate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">prevProps</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> prevState</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> snapshot</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">/* è·å–å…ƒç´ ç»˜åˆ¶ä¹‹å‰çš„ä½ç½® */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">snapshot</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>ä½œç”¨ï¼šgetSnapshotBeforeUpdate è¿™ä¸ªç”Ÿå‘½å‘¨æœŸæ„ä¹‰å°±æ˜¯é…åˆ componentDidUpdate ä¸€èµ·ä½¿ç”¨ï¼Œè®¡ç®—å½¢æˆä¸€ä¸ª snapShot ä¼ é€’ç»™ componentDidUpdate ã€‚ä¿å­˜ä¸€æ¬¡æ›´æ–°å‰çš„ä¿¡æ¯ã€‚</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="componentdidupdate">componentDidUpdate<a aria-hidden="true" class="hash-link" href="#componentdidupdate" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">componentDidUpdate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">prevProps</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> prevState</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> snapshot</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> style </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getComputedStyle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">node</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> newPosition </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* è·å–å…ƒç´ æœ€æ–°ä½ç½®ä¿¡æ¯ */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        cx</span><span class="token operator" style="color:#393A34">:</span><span class="token plain">style</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">cx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        cy</span><span class="token operator" style="color:#393A34">:</span><span class="token plain">style</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">cy</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>ä½œç”¨ï¼š</p><ul><li>componentDidUpdate ç”Ÿå‘½å‘¨æœŸæ‰§è¡Œï¼Œæ­¤æ—¶ DOM å·²ç»æ›´æ–°ï¼Œå¯ä»¥ç›´æ¥è·å– DOM æœ€æ–°çŠ¶æ€ã€‚è¿™ä¸ªå‡½æ•°é‡Œé¢å¦‚æœæƒ³è¦ä½¿ç”¨ setState ï¼Œä¸€å®šè¦åŠ ä»¥é™åˆ¶ï¼Œå¦åˆ™ä¼šå¼•èµ·æ— é™å¾ªç¯ã€‚</li><li>æ¥å— getSnapshotBeforeUpdate ä¿å­˜çš„å¿«ç…§ä¿¡æ¯ã€‚</li></ul><h4 class="anchor anchorWithStickyNavbar_y2LR" id="componentdidmount">componentDidMount<a aria-hidden="true" class="hash-link" href="#componentdidmount" title="Direct link to heading">â€‹</a></h4><p>componentDidMount ç”Ÿå‘½å‘¨æœŸæ‰§è¡Œæ—¶æœºå’Œ componentDidUpdate ä¸€æ ·ï¼Œä¸€ä¸ªæ˜¯åœ¨åˆå§‹åŒ–ï¼Œä¸€ä¸ªæ˜¯ç»„ä»¶æ›´æ–°ã€‚æ­¤æ—¶ DOM å·²ç»åˆ›å»ºå®Œï¼Œæ—¢ç„¶ DOM å·²ç»åˆ›å»ºæŒ‚è½½ï¼Œå°±å¯ä»¥åšä¸€äº›åŸºäº DOM æ“ä½œï¼ŒDOM äº‹ä»¶ç›‘å¬å™¨ã€‚</p><p>ä½œç”¨ï¼š</p><ul><li>å¯ä»¥åšä¸€äº›å…³äº DOM æ“ä½œï¼Œæ¯”å¦‚åŸºäº DOM çš„äº‹ä»¶ç›‘å¬å™¨ã€‚</li><li>å¯¹äºåˆå§‹åŒ–å‘æœåŠ¡å™¨è¯·æ±‚æ•°æ®ï¼Œæ¸²æŸ“è§†å›¾ï¼Œè¿™ä¸ªç”Ÿå‘½å‘¨æœŸä¹Ÿæ˜¯è›®åˆé€‚çš„ã€‚</li></ul><h4 class="anchor anchorWithStickyNavbar_y2LR" id="shouldcomponentupdate">shouldComponentUpdate<a aria-hidden="true" class="hash-link" href="#shouldcomponentupdate" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">shouldComponentUpdate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">newProps</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">newState</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">nextContext</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>ä¸€èˆ¬ç”¨äºæ€§èƒ½ä¼˜åŒ–ï¼ŒshouldComponentUpdate è¿”å›å€¼å†³å®šæ˜¯å¦é‡æ–°æ¸²æŸ“çš„ç±»ç»„ä»¶ã€‚éœ€è¦é‡ç‚¹å…³æ³¨çš„æ˜¯ç¬¬äºŒä¸ªå‚æ•° newState ï¼Œå¦‚æœæœ‰ getDerivedStateFromProps ç”Ÿå‘½å‘¨æœŸ ï¼Œå®ƒçš„è¿”å›å€¼å°†åˆå¹¶åˆ° newState ï¼Œä¾› shouldComponentUpdate ä½¿ç”¨ã€‚</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="componentwillunmount">componentWillUnmount<a aria-hidden="true" class="hash-link" href="#componentwillunmount" title="Direct link to heading">â€‹</a></h4><p>componentWillUnmount æ˜¯ç»„ä»¶é”€æ¯é˜¶æ®µå”¯ä¸€æ‰§è¡Œçš„ç”Ÿå‘½å‘¨æœŸï¼Œä¸»è¦åšä¸€äº›æ”¶å°¾å·¥ä½œï¼Œæ¯”å¦‚æ¸…é™¤ä¸€äº›å¯èƒ½é€ æˆå†…å­˜æ³„æ¼çš„å®šæ—¶å™¨ï¼Œå»¶æ—¶å™¨ï¼Œæˆ–è€…æ˜¯ä¸€äº›äº‹ä»¶ç›‘å¬å™¨ã€‚</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="å‡½æ•°ç»„ä»¶ç”Ÿå‘½å‘¨æœŸæ›¿ä»£æ–¹æ¡ˆ">å‡½æ•°ç»„ä»¶ç”Ÿå‘½å‘¨æœŸæ›¿ä»£æ–¹æ¡ˆ<a aria-hidden="true" class="hash-link" href="#å‡½æ•°ç»„ä»¶ç”Ÿå‘½å‘¨æœŸæ›¿ä»£æ–¹æ¡ˆ" title="Direct link to heading">â€‹</a></h2><p>React hooks ä¹Ÿæä¾›äº† api ï¼Œç”¨äºå¼¥è¡¥å‡½æ•°ç»„ä»¶æ²¡æœ‰ç”Ÿå‘½å‘¨æœŸçš„ç¼ºé™·ã€‚å…¶åŸç†ä¸»è¦æ˜¯è¿ç”¨äº† hooks é‡Œé¢çš„ <code>useEffect</code> å’Œ <code>useLayoutEffect</code>ã€‚</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="useeffect">useEffect<a aria-hidden="true" class="hash-link" href="#useeffect" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">useEffect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> destory</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> dep</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>useEffect ç¬¬ä¸€ä¸ªå‚æ•° callback, è¿”å›çš„ destory ï¼Œ destory ä½œä¸ºä¸‹ä¸€æ¬¡callbackæ‰§è¡Œä¹‹å‰è°ƒç”¨ï¼Œç”¨äºæ¸…é™¤ä¸Šä¸€æ¬¡ callback äº§ç”Ÿçš„å‰¯ä½œç”¨ã€‚</p><p>ç¬¬äºŒä¸ªå‚æ•°ä½œä¸ºä¾èµ–é¡¹ï¼Œæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå¯ä»¥æœ‰å¤šä¸ªä¾èµ–é¡¹ï¼Œä¾èµ–é¡¹æ”¹å˜ï¼Œæ‰§è¡Œä¸Šä¸€æ¬¡callback è¿”å›çš„ destory ï¼Œå’Œæ‰§è¡Œæ–°çš„ effect ç¬¬ä¸€ä¸ªå‚æ•° callback ã€‚</p><p>å¯¹äº useEffect æ‰§è¡Œï¼Œ React å¤„ç†é€»è¾‘æ˜¯é‡‡ç”¨<strong>å¼‚æ­¥è°ƒç”¨</strong> ï¼Œå¯¹äºæ¯ä¸€ä¸ª effect çš„ callbackï¼Œ React ä¼šå‘ setTimeoutå›è°ƒå‡½æ•°ä¸€æ ·ï¼Œæ”¾å…¥ä»»åŠ¡é˜Ÿåˆ—ï¼Œç­‰åˆ°ä¸»çº¿ç¨‹ä»»åŠ¡å®Œæˆï¼ŒDOM æ›´æ–°ï¼Œjs æ‰§è¡Œå®Œæˆï¼Œè§†å›¾ç»˜åˆ¶å®Œæ¯•ï¼Œæ‰æ‰§è¡Œã€‚æ‰€ä»¥ effect å›è°ƒå‡½æ•°ä¸ä¼šé˜»å¡æµè§ˆå™¨ç»˜åˆ¶è§†å›¾ã€‚</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="uselayouteffect">useLayoutEffect<a aria-hidden="true" class="hash-link" href="#uselayouteffect" title="Direct link to heading">â€‹</a></h3><p>useLayoutEffect å’Œ useEffect ä¸åŒçš„åœ°æ–¹æ˜¯é‡‡ç”¨äº†åŒæ­¥æ‰§è¡Œï¼Œé‚£ä¹ˆå’ŒuseEffectæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ</p><ul><li><p>é¦–å…ˆ useLayoutEffect æ˜¯åœ¨ DOM æ›´æ–°ä¹‹åï¼Œæµè§ˆå™¨ç»˜åˆ¶ä¹‹å‰ï¼Œè¿™æ ·å¯ä»¥æ–¹ä¾¿ä¿®æ”¹ DOMï¼Œè·å– DOM ä¿¡æ¯ï¼Œè¿™æ ·æµè§ˆå™¨åªä¼šç»˜åˆ¶ä¸€æ¬¡ï¼Œå¦‚æœä¿®æ”¹ DOM å¸ƒå±€æ”¾åœ¨ useEffect ï¼Œé‚£ useEffect æ‰§è¡Œæ˜¯åœ¨æµè§ˆå™¨ç»˜åˆ¶è§†å›¾ä¹‹åï¼Œæ¥ä¸‹æ¥åˆæ”¹ DOM ï¼Œå°±å¯èƒ½ä¼šå¯¼è‡´æµè§ˆå™¨å†æ¬¡å›æµå’Œé‡ç»˜ã€‚è€Œä¸”ç”±äºä¸¤æ¬¡ç»˜åˆ¶ï¼Œè§†å›¾ä¸Šå¯èƒ½ä¼šé€ æˆé—ªç°çªå…€çš„æ•ˆæœã€‚</p></li><li><p>useLayoutEffect callback ä¸­ä»£ç æ‰§è¡Œä¼šé˜»å¡æµè§ˆå™¨ç»˜åˆ¶ã€‚</p></li></ul><p><strong>ä¸€å¥è¯æ¦‚æ‹¬å¦‚ä½•é€‰æ‹© useEffect å’Œ useLayoutEffect ï¼šä¿®æ”¹ DOM ï¼Œæ”¹å˜å¸ƒå±€å°±ç”¨ useLayoutEffect ï¼Œå…¶ä»–æƒ…å†µå°±ç”¨ useEffect.</strong></p><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>warning</h5></div><div class="admonition-content"><p>React.useEffect å›è°ƒå‡½æ•° å’Œ componentDidMount / componentDidUpdate æ‰§è¡Œæ—¶æœºæœ‰ä»€ä¹ˆåŒºåˆ« ï¼Ÿ</p><p>useEffect å¯¹ React æ‰§è¡Œæ ˆæ¥çœ‹æ˜¯å¼‚æ­¥æ‰§è¡Œçš„ï¼Œè€Œ componentDidMount / componentDidUpdate æ˜¯åŒæ­¥æ‰§è¡Œçš„ï¼ŒuseEffectä»£ç ä¸ä¼šé˜»å¡æµè§ˆå™¨ç»˜åˆ¶ã€‚åœ¨æ—¶æœºä¸Š ï¼ŒcomponentDidMount / componentDidUpdate å’Œ useLayoutEffect æ›´ç±»ä¼¼ã€‚</p></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="useinsertioneffect">useInsertionEffect<a aria-hidden="true" class="hash-link" href="#useinsertioneffect" title="Direct link to heading">â€‹</a></h3><p>useInsertionEffect æ˜¯åœ¨ React v18 æ–°æ·»åŠ çš„ hooks ï¼Œå®ƒçš„ç”¨æ³•å’Œ useEffect å’Œ useLayoutEffect ä¸€æ ·ã€‚é‚£ä¹ˆè¿™ä¸ª hooks ç”¨äºä»€ä¹ˆå‘¢?</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">useEffect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;useEffect æ‰§è¡Œ&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">useLayoutEffect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;useLayoutEffect æ‰§è¡Œ&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">useInsertionEffect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;useInsertionEffect æ‰§è¡Œ&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>æ‰“å°ï¼š useInsertionEffect æ‰§è¡Œ useLayoutEffect æ‰§è¡Œ useEffect æ‰§è¡Œ</p><p>å¯ä»¥çœ‹åˆ° useInsertionEffect çš„æ‰§è¡Œæ—¶æœºè¦æ¯” useLayoutEffect æå‰ï¼ŒuseLayoutEffect æ‰§è¡Œçš„æ—¶å€™ DOM å·²ç»æ›´æ–°äº†ï¼Œä½†æ˜¯<strong>åœ¨ useInsertionEffect çš„æ‰§è¡Œçš„æ—¶å€™ï¼ŒDOM è¿˜æ²¡æœ‰æ›´æ–°ã€‚</strong></p><p>useInsertionEffect ä¸»è¦æ˜¯è§£å†³ CSS-in-JS åœ¨æ¸²æŸ“ä¸­æ³¨å…¥æ ·å¼çš„æ€§èƒ½é—®é¢˜ã€‚è¿™ä¸ª hooks ä¸»è¦æ˜¯åº”ç”¨äºè¿™ä¸ªåœºæ™¯ï¼Œåœ¨å…¶ä»–åœºæ™¯ä¸‹ React ä¸æœŸæœ›ç”¨è¿™ä¸ª hooks ã€‚</p><p> CSS-in-JS çš„å®ç°åŸç†ï¼Œæ˜¯åŠ¨æ€ç”Ÿæˆ style æ ‡ç­¾ã€‚</p><p> æ˜ç™½äº† Styled-components åŸç†ä¹‹åï¼Œå†æ¥çœ‹ä¸€ä¸‹ï¼Œå¦‚æœåœ¨ useLayoutEffect ä½¿ç”¨ CSS-in-JS ä¼šé€ æˆå“ªé‡Œé—®é¢˜å‘¢ï¼Ÿ</p><ul><li>é¦–å…ˆ useLayoutEffect æ‰§è¡Œçš„æ—¶æœº DOM å·²ç»æ›´æ–°å®Œæˆï¼Œå¸ƒå±€ä¹Ÿå·²ç»ç¡®å®šäº†ï¼Œå‰©ä¸‹çš„å°±æ˜¯äº¤ç»™æµè§ˆå™¨ç»˜åˆ¶å°±è¡Œäº†ã€‚</li><li>å¦‚æœåœ¨ useLayoutEffect åŠ¨æ€ç”Ÿæˆ style æ ‡ç­¾ï¼Œé‚£ä¹ˆä¼šå†æ¬¡å½±å“å¸ƒå±€ï¼Œå¯¼è‡´æµè§ˆå™¨å†æ¬¡é‡å›å’Œé‡æ’ã€‚</li></ul><p>è¿™ä¸ªæ˜¯æ—¶å€™ useInsertionEffect çš„ä½œç”¨å°±å‡ºç°äº†ï¼ŒuseInsertionEffect çš„æ‰§è¡Œåœ¨ DOM æ›´æ–°å‰ï¼Œæ‰€ä»¥æ­¤æ—¶ä½¿ç”¨ CSS-in-JS é¿å…äº†æµè§ˆå™¨å‡ºç°å†æ¬¡é‡å›å’Œé‡æ’çš„å¯èƒ½ï¼Œè§£å†³äº†æ€§èƒ½ä¸Šçš„é—®é¢˜ã€‚</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_NBRY padding--none margin-left--sm"><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/Blog/docs/tags/æ˜é‡‘å°å†Œ">æ˜é‡‘å°å†Œ</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/Blog/docs/tags/reactè¿›é˜¶å®è·µæŒ‡å—">Reactè¿›é˜¶å®è·µæŒ‡å—</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/Blog/docs/tags/ç†è§£ç”Ÿå‘½å‘¨æœŸ">ç†è§£ç”Ÿå‘½å‘¨æœŸ</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/Blog/docs/è¯»ä¹¦ç¬”è®°/æ˜é‡‘å°å†Œ/Reactè¿›é˜¶å®è·µæŒ‡å—/ç„å­¦state"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« <!-- -->ç„å­¦state</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/Blog/docs/è¯»ä¹¦ç¬”è®°/æ˜é‡‘å°å†Œ/Reactè¿›é˜¶å®è·µæŒ‡å—/è‡ªå®šä¹‰Hook"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">ä¼˜åŒ–-ç»†èŠ‚<!-- --> Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#ç±»ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ" class="table-of-contents__link toc-highlight">ç±»ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ</a><ul><li><a href="#react-ç±»ç»„ä»¶ç”Ÿå‘½å‘¨æœŸæ‰§è¡Œè¿‡ç¨‹æ¢ç§˜" class="table-of-contents__link toc-highlight">React ç±»ç»„ä»¶ç”Ÿå‘½å‘¨æœŸæ‰§è¡Œè¿‡ç¨‹æ¢ç§˜</a></li><li><a href="#react-å„é˜¶æ®µç”Ÿå‘½å‘¨æœŸèƒ½åšäº›ä»€ä¹ˆ" class="table-of-contents__link toc-highlight">React å„é˜¶æ®µç”Ÿå‘½å‘¨æœŸèƒ½åšäº›ä»€ä¹ˆ</a></li></ul></li><li><a href="#å‡½æ•°ç»„ä»¶ç”Ÿå‘½å‘¨æœŸæ›¿ä»£æ–¹æ¡ˆ" class="table-of-contents__link toc-highlight">å‡½æ•°ç»„ä»¶ç”Ÿå‘½å‘¨æœŸæ›¿ä»£æ–¹æ¡ˆ</a><ul><li><a href="#useeffect" class="table-of-contents__link toc-highlight">useEffect</a></li><li><a href="#uselayouteffect" class="table-of-contents__link toc-highlight">useLayoutEffect</a></li><li><a href="#useinsertioneffect" class="table-of-contents__link toc-highlight">useInsertionEffect</a></li></ul></li></ul></div></div></div></div></main></div></div></div>
<script src="/Blog/assets/js/runtime~main.fe0f6a69.js"></script>
<script src="/Blog/assets/js/main.b749fead.js"></script>
</body>
</html>