<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://guoxiaxing.github.io/Blog/blog</id>
    <title>Try's Blog Blog</title>
    <updated>2021-12-16T00:00:00.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://guoxiaxing.github.io/Blog/blog"/>
    <subtitle>Try's Blog Blog</subtitle>
    <icon>https://guoxiaxing.github.io/Blog/img/logo.jpeg</icon>
    <entry>
        <title type="html"><![CDATA[ã€Doingã€‘rxjs åŸºç¡€æ¦‚å¿µ]]></title>
        <id>rxjs</id>
        <link href="https://guoxiaxing.github.io/Blog/blog/rxjs"/>
        <updated>2021-12-16T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Rxjs æ˜¯ä»€ä¹ˆï¼Ÿ]]></summary>
        <content type="html"><![CDATA[<h2>Rxjs æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>RxJS æ˜¯ä¸€ä¸ªåº“ï¼Œå®ƒé€šè¿‡ä½¿ç”¨ observable åºåˆ—æ¥ç¼–å†™å¼‚æ­¥å’ŒåŸºäºäº‹ä»¶çš„ç¨‹åºã€‚å®ƒæä¾›äº†ä¸€ä¸ªæ ¸å¿ƒç±»å‹ Observableï¼Œé™„å±ç±»å‹ (Observerã€ Schedulersã€ Subjects) å’Œæ“ä½œç¬¦ (mapã€filterã€reduceã€every, ç­‰ç­‰)ï¼Œè¿™äº›æ•°ç»„æ“ä½œç¬¦å¯ä»¥æŠŠå¼‚æ­¥äº‹ä»¶ä½œä¸ºé›†åˆæ¥å¤„ç†ã€‚</p><blockquote><p>å¯ä»¥æŠŠ RxJS å½“åšæ˜¯ç”¨æ¥å¤„ç†äº‹ä»¶çš„ Lodashã€‚</p></blockquote><h2>ç‰¹ç‚¹</h2><ul><li>çº¯å‡€æ€§ï¼šä½¿ç”¨çº¯å‡½æ•°æ¥äº§ç”Ÿå€¼ï¼Œä¸éœ€è¦å€ŸåŠ©å¤–éƒ¨å˜é‡</li><li>æµåŠ¨æ€§ï¼šRxJS æä¾›äº†ä¸€æ•´å¥—æ“ä½œç¬¦æ¥å¸®åŠ©ä½ æ§åˆ¶äº‹ä»¶å¦‚ä½•æµç» observables ã€‚</li><li>å€¼ï¼šå¯ä»¥å¯¹æµç» observable çš„å€¼è¿›è¡Œè½¬æ¢</li></ul><h2>Rxjs Observables vs Promise</h2><h3>å¤šå€¼ vs å•å€¼</h3><p>ä¸€ä¸ª Promise åªèƒ½äº§ç”Ÿä¸€ä¸ªå€¼/é”™è¯¯ï¼Œä¹‹åçš„å€¼æˆ–è€…é”™è¯¯éƒ½ä¼šè¢«å¿½ç•¥ã€‚è¿™ä¹Ÿå°±æ˜¯ Promise çš„çŠ¶æ€åªèƒ½æ”¹å˜ä¸€æ¬¡ï¼Œä¸€æ—¦æ”¹å˜å°±ä¸ä¼šå†å˜ã€‚</p><pre><code class="language-javascript">const numberPromise = new Promise(resolve =&gt; {
  resolve(5);
  resolve(10); // ä¸ç”Ÿæ•ˆ
});

numberPromise.then(value =&gt; console.log(value));

// è¾“å‡º åªä¼šæœ‰ 5
</code></pre><p>å†çœ‹çœ‹ Observable</p><pre><code class="language-javascript">const Observable = require(&quot;rxjs/Observable&quot;).Observable;

const numberObservable = new Observable(observer =&gt; {
  observer.next(5);
  observer.next(10);
});

numberObservable.subscribe(value =&gt; console.log(value));

// è¾“å‡º 5 10
</code></pre><p>Observable æ˜¯å¯ä»¥äº§ç”Ÿå¤šä¸ªå€¼çš„ï¼Œè¿™ä¸€ç‚¹å’Œ promise çš„å·®åˆ«å¾ˆå¤§ã€‚å¹³å¸¸æˆ‘ä»¬å¯èƒ½é‡åˆ°çš„å¤§å¤šæ•°æƒ…å†µéƒ½æ˜¯ä¸€ä¸ªè¯·æ±‚å¯¹åº”ä¸€ä¸ªå“åº”ï¼Œä½†æ˜¯æˆ‘ä»¬ä¹Ÿä¼šæœ‰äº§ç”Ÿå¤šä¸ªå€¼çš„æƒ…å†µï¼š</p><ul><li>å®šæ—¶å™¨</li><li>DOM äº‹ä»¶</li></ul><h3>ä»£ç æ‰§è¡Œ</h3><pre><code class="language-javascript">// Promiseæ„é€ å‡½æ•°å†…éƒ¨çš„é€»è¾‘æ˜¯åŒæ­¥æ‰§è¡Œçš„
const promise = new Promise(resolve =&gt; {
  console.log(&quot;promise call&quot;);
  resolve(1);
  console.log(&quot;promise end&quot;);
});

// æ‰§è¡Œè¿™æ®µä»£ç  promise call å’Œ promise end ä¼šç«‹å³æ‰§è¡Œ
const observable = new Observable(() =&gt; {
  console.log(&quot;I was called!&quot;);
});

// æ­¤æ—¶å¹¶æ²¡æœ‰console

// åªæœ‰ observable.subscribe(); è¿™ä¸ªæ—¶å€™ I was calledï¼æ‰ä¼šè¢«æ‰“å°å‡ºæ¥ã€‚
</code></pre><p>ä¸Šé¢çš„ä»£ç æˆ‘ä»¬å¯ä»¥å‘ç° observable æ˜¯ lazy çš„ï¼Œåªæœ‰åœ¨è®¢é˜…çš„æ—¶å€™ä»£ç æ‰ä¼šè¢«æ‰§è¡Œ</p><h3> èƒ½å–æ¶ˆ vs ä¸èƒ½å–æ¶ˆ</h3><p>promise é»˜è®¤æ˜¯ä¸èƒ½å–æ¶ˆçš„ï¼Œä¸€æ—¦åˆ›å»ºå°±ä¼šè¢«æ‰§è¡Œã€‚</p><pre><code class="language-javascript">const Observable = require(&quot;rxjs/Observable&quot;).Observable;

const observable = new Observable(observer =&gt; {
  let i = 0;
  const token = setInterval(() =&gt; {
    observer.next(i++);
  }, 1000);

  return () =&gt; clearInterval(token);
});

const subscription = observable.subscribe(value =&gt; console.log(value + &quot;!&quot;));

setTimeout(() =&gt; {
  subscription.unsubscribe();
}, 5000);

// ç»“æœ

// 0!
// 1!
// 2!
// 3!
</code></pre><p>observable æ˜¯å¯ä»¥è¢«å–æ¶ˆçš„ï¼Œå¯ä»¥ä½¿ç”¨ subscribe è¿”å›çš„å€¼ï¼Œä¸€ä¸ª Subscription å¯¹è±¡çš„ unsubscribe æ–¹æ³•æ¥å–æ¶ˆè®¢é˜…ã€‚</p><p><strong>new Observable ä¼ å…¥çš„å‡½æ•°çš„è¿”å›å€¼ä¼šåœ¨ unsubscribe è°ƒç”¨çš„æ—¶å€™è¢«æ‰§è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿›è¡Œä¸€äº›æ¸…ç†æ“ä½œã€‚éœ€è¦æ³¨æ„çš„æ˜¯æˆ‘ä»¬å–æ¶ˆçš„æ˜¯å¯¹è¿™ä¸ª observable çš„è®¢é˜…ï¼Œä½†æ˜¯åŸæ¥çš„ new Observable ä¸­çš„å®šæ—¶å™¨ä¾æ—§åœ¨æ‰§è¡Œï¼Œåªæ˜¯è¯¥å®šæ—¶å™¨å‘çš„å€¼ï¼Œæ²¡æœ‰è¢«è®¢é˜…è€Œå·²ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦æ‰§è¡Œ<code>() =&gt; clearInterval(token)</code>æ¸…é™¤è¯¥å®šæ—¶å™¨</strong></p><h3>å¤šä¸ªè®¢é˜… vs å•ä¸ªè®¢é˜…</h3><p>ä¸€ä¸ª promise è¢«åˆ›å»ºçš„æ—¶å€™ï¼Œä»–å°±å·²ç»æ‰§è¡Œäº†ï¼Œå¹¶ä¸”ä¸èƒ½é‡å¤çš„è¢«æ‰§è¡Œäº†ã€‚</p><pre><code class="language-javascript">let time;
const waitOneSecondPromise = new Promise(resolve =&gt; {
  console.log(&quot;promise call&quot;);
  time = new Date().getTime();
  setTimeout(() =&gt; resolve(&quot;hello world&quot;), 1000);
});

waitOneSecondPromise.then(value =&gt; {
  console.log(&quot;ç¬¬ä¸€æ¬¡&quot;, value, new Date().getTime() - time);
});

setTimeout(() =&gt; {
  waitOneSecondPromise.then(value =&gt; {
    console.log(&quot;ç¬¬äºŒæ¬¡&quot;, value, new Date().getTime() - time);
  });
}, 5000);

// è¾“å‡ºç»“æœæ˜¯ promise call
// ç¬¬ä¸€æ¬¡ hello world 1007
// ç¬¬äºŒæ¬¡ hello world 5006
</code></pre><p>ç¬¬ä¸€ä¸ª then ä¼šåœ¨ 1s åè¾“å‡ºå€¼ï¼Œç¬¬äºŒä¸ª then ä¼šåœ¨ 5s åç«‹å³è¾“å‡ºå€¼ï¼Œå› ä¸ºç¬¬äºŒä¸ª then æ–¹æ³•æ‰§è¡Œçš„æ—¶å€™ promise çš„çŠ¶æ€å·²ç»æ”¹å˜ï¼Œæ‰€ä»¥å®ƒå¯ä»¥ç›´æ¥æ‹¿åˆ° promise resolve çš„å€¼ï¼Œä¸éœ€è¦å†ç­‰å¾… 1s äº†</p><p>observableï¼š</p><pre><code class="language-javascript">const Observable = require(&quot;rxjs/Observable&quot;).Observable;

let time;
const waitOneSecondObservable = new Observable(observer =&gt; {
  console.log(&quot;I was called&quot;);
  time = new Date().getTime();
  setTimeout(() =&gt; observer.next(&quot;hey girl&quot;), 1000);
});

waitOneSecondObservable.subscribe(value =&gt; {
  console.log(&quot;ç¬¬ä¸€æ¬¡&quot;, value, new Date().getTime() - time);
});

setTimeout(() =&gt; {
  waitOneSecondObservable.subscribe(value =&gt; {
    console.log(&quot;ç¬¬äºŒæ¬¡&quot;, value, new Date().getTime() - time);
  });
}, 5000);

// è¾“å‡º
// I was called
// ç¬¬ä¸€æ¬¡ hey girl 1003
// I was called
// ç¬¬äºŒæ¬¡ hey girl 1003
</code></pre><p>å¯¹äº observableï¼Œè¿™é‡Œå…¶å®æ˜¯(Cold Observable)ä»–ä»¬æ¯æ¬¡è¢« subscribe éƒ½æ˜¯ä¸€æ¬¡æ–°çš„è®¢é˜…ï¼Œobservable ä¼šè¢«é‡æ–°æ‰§è¡Œã€‚æ‰€ä»¥æ— è®º observable ä½•æ—¶è¢« subscribe äº§ç”Ÿçš„å€¼éƒ½æ˜¯ä¸€æ ·çš„</p><p>ä½†æ˜¯æœ‰æ—¶å€™æˆ‘ä»¬ä¸å¸Œæœ›æ¯æ¬¡ subscribe éƒ½é‡æ–°è®¢é˜…ï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒå¯ä»¥å…±äº«å‰é¢çš„è®¢é˜…ï¼Œä¹Ÿå°±æ˜¯ä¸å¸Œæœ›è¿™ä¸ª observable è¢«é‡æ–°åœ¨æ‰§è¡Œä¸€éï¼Œå¤šç”¨äº http è¯·æ±‚çš„åœºæ™¯ã€‚åœ¨ http è¯·æ±‚ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½å¸Œæœ›åªå‘ä¸€æ¬¡è¯·æ±‚ï¼Œä½†æ˜¯ç»“æœè¢«å¤šä¸ªè®¢é˜…è€…å…±ç”¨ã€‚ Observable æœ¬èº«æ²¡æœ‰æä¾›è¿™ä¸ªåŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ RxJS è¿™ä¸ªåº“æ¥å®ç°ï¼Œå®ƒæœ‰ä¸€ä¸ª share çš„ operatorã€‚å…¶å®è¿™å°±æ˜¯å°†ä¸€ä¸ª Cold Observable å˜ä¸ºäº† Hot Observableã€‚</p><pre><code class="language-javascript">const waitOneSecondObservable = new Observable(observer =&gt; {
  // å‘é€httpè¯·æ±‚
});

const sharedWaitOneSecondObservable = waitOneSecondObservable.share();

sharedWaitOneSecondObservable.subscribe(doSomething);

sharedWaitOneSecondObservable.subscribe(doSomethingElse);

// ä½¿ç”¨äº†shareï¼Œè™½ç„¶subscribeäº†å¤šæ¬¡ï¼Œä½†æ˜¯ä»…å‘é€ä¸€æ¬¡è¯·æ±‚ï¼Œshareäº†ç»“æœã€‚
</code></pre><h3>å¯èƒ½æ˜¯å¼‚æ­¥ vs ä¸€ç›´æ˜¯å¼‚æ­¥</h3><p>promise ä¸­åŒæ­¥çš„ resolve äº†ä¸€ä¸ªå€¼ï¼Œä½†æ˜¯å®ƒè¿˜æ˜¯ä¼šå¼‚æ­¥æ‰§è¡Œã€‚</p><pre><code class="language-javascript">const promise = new Promise(resolve =&gt; {
  resolve(5);
});

promise.then(value =&gt; console.log(value + &quot;!&quot;));

console.log(&quot;And now we are here.&quot;);

// And now we are here.
// 5!
</code></pre><p>promise ä¸€ç›´æ˜¯å¼‚æ­¥ï¼Œ Observables åˆ™æ¯”è¾ƒçµæ´»ï¼Œæ˜¯å¦ä¸ºå¼‚æ­¥å¾—æ ¹æ®è‡ªå·±çš„å‡½æ•°æ¥å®šï¼Œè¿™ç‚¹ä¹Ÿæ¯”è¾ƒå±é™©ã€‚rxjs ä¸­æœ‰ä¸€äº›æ“ä½œç¬¦å¯ä»¥è®©ç›‘å¬å¼ºåˆ¶ä¸ºå¼‚æ­¥çš„æ–¹å¼ï¼Œä¾‹å¦‚ observeOnã€‚</p><pre><code class="language-javascript">const Observable = require(&quot;rxjs/Observable&quot;).Observable;

const observable = new Observable(observer =&gt; {
  observer.next(5);
  setTimeout(() =&gt; {
    observer.next(6);
  });
});

observable.subscribe(value =&gt; console.log(value + &quot;!&quot;));
console.log(&quot;And now we are here.&quot;);

// 5!
// And now we are here.
// 6!
</code></pre><h2>Observable</h2><p>å¯è§‚å¯Ÿå¯¹è±¡</p><ul><li><strong>å¯ä»¥æ˜¯å¼‚æ­¥çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯åŒæ­¥çš„</strong></li><li>æ˜¯ä¸€ä¸ªæ˜¯å¤šä¸ªå€¼çš„æƒ°æ€§æ¨é€é›†åˆã€‚å¯ä»¥äº§ç”Ÿå€¼ã€‚</li><li>Observable å¯ä»¥éšç€æ—¶é—´çš„æ¨ç§» â€œè¿”å›â€ å¤šä¸ªå€¼</li><li>åœ¨ Observable æ‰§è¡Œä¸­, å¯èƒ½ä¼šå‘é€é›¶ä¸ªåˆ°æ— ç©·å¤šä¸ª &quot;Next&quot; é€šçŸ¥ã€‚å¦‚æœå‘é€çš„æ˜¯ &quot;Error&quot; æˆ– &quot;Complete&quot; é€šçŸ¥çš„è¯ï¼Œé‚£ä¹ˆä¹‹åä¸ä¼šå†å‘é€ä»»ä½•é€šçŸ¥äº†ã€‚</li></ul><h3>Cold Observable</h3><p>å•æ’­çš„ observable
<strong>åªæœ‰è¢« Observer è®¢é˜…äº†æ‰ä¼šå¼€å§‹äº§ç”Ÿå€¼ã€‚</strong>æœ‰å¤šå°‘ä¸ªè®¢é˜…å°±ä¼šç”Ÿæˆå¤šå°‘ä¸ªè®¢é˜…çš„å®ä¾‹ï¼Œæ¯ä¸ªè®¢é˜…éƒ½æ˜¯ä»ç¬¬ä¸€ä¸ªäº§ç”Ÿçš„å€¼å¼€å§‹æ¥æ”¶å€¼ï¼Œæ‰€ä»¥æ¯ä¸ªè®¢é˜…æ¥æ”¶åˆ°çš„å€¼éƒ½æ˜¯ä¸€æ ·çš„ã€‚</p><h3>Hot Observable</h3><p>ä¸ç®¡æœ‰æ²¡æœ‰è®¢é˜…éƒ½ä¼šäº§ç”Ÿå€¼ã€‚æ˜¯å¤šæ’­çš„ï¼Œå¤šä¸ªè®¢é˜…ä¼šå…±äº«åŒä¸€ä¸ªå®ä¾‹ã€‚æ˜¯ä»è®¢é˜…å¼€å§‹æ¥æ”¶å€¼ï¼Œæ¯ä¸ªè®¢é˜…æ¥æ”¶åˆ°çš„å€¼éƒ½æ˜¯ä¸åŒçš„ï¼Œå–å†³äºä»–ä»¬ä»€ä¹ˆæ—¶å€™è®¢é˜…ã€‚</p><h4>æ€ä¹ˆåˆ›å»º Hot Observable</h4><h5>multicast + Subject</h5><p>multicast æ“ä½œç¬¦çš„å·¥ä½œåŸç†ï¼šè§‚å¯Ÿè€…è®¢é˜…ä¸€ä¸ªåŸºç¡€çš„ Subjectï¼Œç„¶å Subject è®¢é˜…æº Observable ã€‚</p><pre><code class="language-javascript">var source = Rx.Observable.from([1, 2, 3]);
var subject = new Rx.Subject();
var multicasted = source.multicast(subject);

// åœ¨åº•å±‚ä½¿ç”¨äº† `subject.subscribe({...})`:
multicasted.subscribe({
  next: v =&gt; console.log(&quot;observerA: &quot; + v)
});
multicasted.subscribe({
  next: v =&gt; console.log(&quot;observerB: &quot; + v)
});

// åœ¨åº•å±‚ä½¿ç”¨äº† `source.subscribe(subject)`:
multicasted.connect();
</code></pre><p>multicast è¿”å›çš„æ˜¯ ConnectableObservableï¼Œå®ƒåªæ˜¯ä¸€ä¸ªæœ‰ connect() æ–¹æ³•çš„ Observable ã€‚</p><p>connect() æ–¹æ³•ååˆ†é‡è¦ï¼Œå®ƒå†³å®šäº†ä½•æ—¶å¯åŠ¨å…±äº«çš„ Observable æ‰§è¡Œã€‚å› ä¸º connect() æ–¹æ³•åœ¨åº•å±‚æ‰§è¡Œäº† source.subscribe(subject)ï¼Œæ‰€ä»¥å®ƒè¿”å›çš„æ˜¯ Subscriptionï¼Œä½ å¯ä»¥å–æ¶ˆè®¢é˜…ä»¥å–æ¶ˆå…±äº«çš„ Observable æ‰§è¡Œã€‚</p><blockquote><p>ConnectableObservable: ConnectableObservable æ˜¯å¤šæ’­çš„å…±äº« Observableï¼Œå¯ä»¥åŒæ—¶è¢«å¤šä¸ª observers å…±äº«è®¢é˜…ï¼Œå®ƒæ˜¯ Hot Observablesã€‚ConnectableObservable æ˜¯è®¢é˜…è€…å’ŒçœŸæ­£çš„æºå¤´ Observables çš„ä¸­é—´äººï¼ŒConnectableObservable ä»æºå¤´ Observables æ¥æ”¶åˆ°å€¼ç„¶åå†æŠŠå€¼è½¬å‘ç»™è®¢é˜…è€…ã€‚</p></blockquote><h5>refCount()</h5><p>ConnectableObservable çš„ refCount() æ–¹æ³•(å¼•ç”¨è®¡æ•°)ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å› Observableï¼Œè¿™ä¸ª Observable ä¼šè¿½è¸ªæœ‰å¤šå°‘ä¸ªè®¢é˜…è€…ã€‚å½“è®¢é˜…è€…çš„æ•°é‡ä» 0 å˜æˆ 1ï¼Œå®ƒä¼šè°ƒç”¨ connect() ä»¥å¼€å¯å…±äº«çš„æ‰§è¡Œã€‚å½“è®¢é˜…è€…æ•°é‡ä» 1 å˜æˆ 0 æ—¶ï¼Œå®ƒä¼šå®Œå…¨å–æ¶ˆè®¢é˜…ï¼Œåœæ­¢è¿›ä¸€æ­¥çš„æ‰§è¡Œã€‚</p><p><strong>refCount çš„ä½œç”¨æ˜¯ï¼Œå½“æœ‰ç¬¬ä¸€ä¸ªè®¢é˜…è€…æ—¶ï¼Œå¤šæ’­ Observable ä¼šè‡ªåŠ¨åœ°å¯åŠ¨æ‰§è¡Œï¼Œè€Œå½“æœ€åä¸€ä¸ªè®¢é˜…è€…ç¦»å¼€æ—¶ï¼Œå¤šæ’­ Observable ä¼šè‡ªåŠ¨åœ°åœæ­¢æ‰§è¡Œã€‚</strong></p><h5>publish()</h5><p>ç­‰ä»·äº multicast(new Subject())</p><p>è¿™ä¸ªæ“ä½œç¬¦å¯ä»¥å°† cold observable è½¬æ¢ä¸º ConnectableObservableï¼Œè€Œä¸éœ€è¦æˆ‘ä»¬ä½¿ç”¨çš„åˆ›å»º Subject å®ä¾‹</p><pre><code class="language-javascript">let obs$ = interval(1000).pipe(publish(), refCount());
</code></pre><h5>share()</h5><p>ç­‰ä»·äº publish() + refCount()</p><pre><code class="language-javascript">let obs$ = interval(1000).pipe(share());
</code></pre><blockquote><p>publishReplayã€shareReplayã€publishBehaviorã€shareBehaviorã€publishAsyncã€shareAsync éƒ½å¯ä»¥å°†å•æ’­çš„ Observable è½¬æ¢ä¸ºå¤šæ’­çš„ Observableï¼Œåªä¸è¿‡åº•å±‚ä½¿ç”¨äº†ä¸åŒç±»å‹çš„ Subject</p></blockquote><h2>Observer</h2><p>è§‚å¯Ÿè€…</p><h3>ä»€ä¹ˆæ˜¯è§‚å¯Ÿè€…ï¼Ÿ</h3><p>å®šä¹‰å¯¹äº observable è¯¥å¦‚ä½•å¤„ç†</p><p>è§‚å¯Ÿè€…æ˜¯ Observable å‘é€çš„å€¼çš„æ¶ˆè´¹è€…ã€‚è§‚å¯Ÿè€…åªæ˜¯ä¸€ç»„å›è°ƒå‡½æ•°çš„é›†åˆï¼Œæ¯ä¸ªå›è°ƒå‡½æ•°å¯¹åº”ä¸€ç§ Observable å‘é€çš„é€šçŸ¥ç±»å‹ï¼šnextã€error å’Œ complete ã€‚</p><pre><code class="language-javascript">var observer = {
  next: x =&gt; console.log(&quot;Observer got a next value: &quot; + x),
  error: err =&gt; console.error(&quot;Observer got an error: &quot; + err),
  complete: () =&gt; console.log(&quot;Observer got a complete notification&quot;)
};
</code></pre><p>è¦ä½¿ç”¨è§‚å¯Ÿè€…ï¼Œéœ€è¦æŠŠå®ƒæä¾›ç»™ Observable çš„ subscribe æ–¹æ³•ï¼š</p><pre><code class="language-javascript">observable.subscribe(observer);
</code></pre><p><strong>è§‚å¯Ÿè€…åªæ˜¯æœ‰ä¸‰ä¸ªå›è°ƒå‡½æ•°çš„å¯¹è±¡ï¼Œæ¯ä¸ªå›è°ƒå‡½æ•°å¯¹åº”ä¸€ç§ Observable å‘é€çš„é€šçŸ¥ç±»å‹ã€‚</strong>
è§‚å¯Ÿè€…ä¹Ÿå¯ä»¥æ˜¯éƒ¨åˆ†çš„</p><h2>Subscription</h2><p>è®¢é˜…</p><p>å½“ä½ è®¢é˜…äº† Observableï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ª Subscription ï¼Œ<strong>å®ƒè¡¨ç¤ºè¿›è¡Œä¸­çš„æ‰§è¡Œ</strong>ã€‚åªè¦è°ƒç”¨ unsubscribe() æ–¹æ³•å°±å¯ä»¥å–æ¶ˆæ‰§è¡Œã€‚</p><h2>Subject</h2><p>ä¸»ä½“ã€‚æ˜¯ä¸€ç§ç‰¹æ®Šçš„ observableï¼ˆHot Observableï¼‰ï¼Œå®ƒå…è®¸å°†å€¼å¤šæ’­ç»™å¤šä¸ªè§‚å¯Ÿè€…ï¼Œæ‰€ä»¥ Subject æ˜¯å¤šæ’­çš„ï¼Œè€Œæ™®é€šçš„ Observables æ˜¯å•æ’­çš„(æ¯ä¸ªå·²è®¢é˜…çš„è§‚å¯Ÿè€…éƒ½æ‹¥æœ‰ Observable çš„ç‹¬ç«‹æ‰§è¡Œ)ã€‚</p><ul><li><strong>æ¯ä¸ª Subject éƒ½æ˜¯ Observableã€‚</strong> -å¯¹äº Subjectï¼Œä½ å¯ä»¥æä¾›ä¸€ä¸ªè§‚å¯Ÿè€…å¹¶ä½¿ç”¨ subscribe æ–¹æ³•ï¼Œå°±å¯ä»¥å¼€å§‹æ­£å¸¸æ¥æ”¶å€¼ã€‚ä»è§‚å¯Ÿè€…çš„è§’åº¦è€Œè¨€ï¼Œå®ƒæ— æ³•åˆ¤æ–­ Observable æ‰§è¡Œæ˜¯æ¥è‡ªæ™®é€šçš„ Observable è¿˜æ˜¯ Subject ã€‚</li></ul><p>åœ¨ Subject çš„å†…éƒ¨ï¼Œsubscribe ä¸ä¼šè°ƒç”¨å‘é€å€¼çš„æ–°æ‰§è¡Œã€‚å®ƒåªæ˜¯å°†ç»™å®šçš„è§‚å¯Ÿè€…æ³¨å†Œåˆ°è§‚å¯Ÿè€…åˆ—è¡¨ä¸­ã€‚ä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªæ–°çš„è§‚å¯Ÿè€…å¹¶ä¸ä¸€å®šèƒ½æ”¶åˆ° Subject å‘å‡ºçš„æ‰€æœ‰å€¼ï¼Œå®ƒå¯ä»¥æ”¶åˆ°çš„å€¼å–å†³äºå®ƒä½•æ—¶è®¢é˜…ã€‚</p><ul><li><strong>æ¯ä¸ª Subject éƒ½æ˜¯è§‚å¯Ÿè€…ã€‚</strong> Subject æ˜¯ä¸€ä¸ªæœ‰å¦‚ä¸‹æ–¹æ³•çš„å¯¹è±¡ï¼š next(v)ã€error(e) å’Œ complete() ã€‚è¦ç»™ Subject æä¾›æ–°å€¼ï¼Œåªè¦è°ƒç”¨ next(theValue)ï¼Œå®ƒä¼šå°†å€¼å¤šæ’­ç»™å·²æ³¨å†Œç›‘å¬è¯¥ Subject çš„è§‚å¯Ÿè€…ä»¬ã€‚</li></ul><h3>BehaviorSubject</h3><p>å®ƒæœ‰ä¸€ä¸ªâ€œå½“å‰å€¼â€çš„æ¦‚å¿µã€‚å®ƒä¿å­˜äº†å‘é€ç»™æ¶ˆè´¹è€…çš„æœ€æ–°å€¼ã€‚å¹¶ä¸”å½“æœ‰æ–°çš„è§‚å¯Ÿè€…è®¢é˜…æ—¶ï¼Œä¼šç«‹å³ä» BehaviorSubject é‚£æ¥æ”¶åˆ°â€œå½“å‰å€¼â€ã€‚
BehaviorSubject å¿…é¡»ä¼ å…¥ä¸€ä¸ªåˆå§‹åŒ–çš„å€¼</p><h3>ReplaySubject</h3><p>ReplaySubject ç±»ä¼¼äº BehaviorSubjectï¼Œå®ƒå¯ä»¥å‘é€æ—§å€¼ç»™æ–°çš„è®¢é˜…è€…ï¼Œä½†å®ƒè¿˜å¯ä»¥è®°å½• Observable æ‰§è¡Œçš„ä¸€éƒ¨åˆ†ã€‚</p><p><strong>ReplaySubject è®°å½• Observable æ‰§è¡Œä¸­çš„å¤šä¸ªå€¼å¹¶å°†å…¶å›æ”¾ç»™æ–°çš„è®¢é˜…è€…ã€‚</strong></p><p>ReplaySubject åœ¨å®ä¾‹åŒ–çš„æ—¶å€™æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªè¡¨ç¤ºç¼“å†²æ•°é‡ï¼Œç¬¬äºŒä¸ªè¡¨ç¤º window time (ä»¥æ¯«ç§’ä¸ºå•ä½)æ¥ç¡®å®šå¤šä¹…ä¹‹å‰çš„å€¼å¯ä»¥è®°å½•.</p><h3>AsyncSubject</h3><p>åªæœ‰å½“ Observable æ‰§è¡Œå®Œæˆæ—¶(æ‰§è¡Œ complete())ï¼Œå®ƒæ‰ä¼šå°†æ‰§è¡Œçš„æœ€åä¸€ä¸ªå€¼å‘é€ç»™è§‚å¯Ÿè€…ã€‚</p><h2>Scheduler (è°ƒåº¦å™¨)</h2><p>è°ƒåº¦å™¨æ§åˆ¶ç€ä½•æ—¶å¯åŠ¨ subscription å’Œä½•æ—¶å‘é€é€šçŸ¥
ç›®å‰è¿˜æ²¡æœ‰ä½¿ç”¨åˆ°è¿‡</p><blockquote><p>è°ƒåº¦å™¨å¯ä»¥è®©ä½ è§„å®š Observable åœ¨ä»€ä¹ˆæ ·çš„æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­å‘é€é€šçŸ¥ç»™å®ƒçš„è§‚å¯Ÿè€…ã€‚</p></blockquote><p><a href="https://cn.rx.js.org/manual/overview.html#h17">è°ƒåº¦å™¨ç›¸å…³</a></p><h2>Q&amp;A</h2><ol><li>multicast(new Subject()) å’Œ multicast(()=&gt;new Subject())çš„åŒºåˆ«</li></ol><p>å‰è€…å°†ä¸€ä¸ªå†·çš„ observable è½¬åŒ–ä¸ºä¸€ä¸ªçƒ­çš„ observableï¼›åè€…å®é™…ä¸Šæ¯æ¬¡éƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„ Subjectï¼Œåœ¨æœ‰æ–°çš„è®¢é˜…è€…æ¥ä¸´æ—¶ï¼ˆåœ¨å’Œ refCount é…åˆä½¿ç”¨æ—¶ï¼Œå› ä¸º refCount ä¼šåœ¨æœ‰æ–°çš„è®¢é˜…è€…å‡ºç°æ—¶ä½¿ç”¨ connect å¼€å§‹å…±äº«çš„æ‰§è¡Œï¼‰ï¼Œå¦‚æœå‰ä¸€ä¸ª subject å·²ç» complete çš„è¯ï¼Œé‚£ä¹ˆå°±ä¼šé‡æ–°ç”Ÿæˆä¸€ä¸ª Subjectï¼Œæ‰€ä»¥åè€…è¿˜æ˜¯ä¼šæ¥æ”¶åˆ°å€¼ã€‚å› æ­¤åè€…è¿˜æ˜¯ä¸€ä¸ªå†·çš„ observableï¼Œå¤šæ’­ä¸€èˆ¬ä½¿ç”¨å‰è€…ã€‚</p><p>å£è¯´æ— å‡­ï¼Œçœ‹ä¾‹å­</p><ul><li>multicast(new Subject())</li></ul><pre><code class="language-javascript">var source = from([1, 2, 3]);
var multicasted = source.pipe(multicast(new Subject()), refCount());

// åœ¨åº•å±‚ä½¿ç”¨äº† `subject.subscribe({...})`:
multicasted.subscribe({
  next: v =&gt; console.log(&quot;observerA: &quot; + v)
});
setTimeout(() =&gt; {
  multicasted.subscribe({
    next: v =&gt; console.log(&quot;observerB: &quot; + v)
  });
}, 200);

// multicasted.connect()
</code></pre><p>ä¸Šé¢è¿™ç§å†™æ³•ï¼Œæ— è®ºæ˜¯ä½¿ç”¨ refCount è¿˜æ˜¯æ‰‹åŠ¨ connect ç»“æœéƒ½ä¸€æ ·</p><pre><code class="language-text">observerA: 1
observerA: 2
observerA: 3
</code></pre><ul><li>multicast(()=&gt;new Subject()) + refCount()</li></ul><pre><code class="language-javascript">var source = from([1, 2, 3]);
var multicasted = source.pipe(
  multicast(() =&gt; new Subject()),
  refCount()
);

// åœ¨åº•å±‚ä½¿ç”¨äº† `subject.subscribe({...})`:
multicasted.subscribe({
  next: v =&gt; console.log(&quot;observerA: &quot; + v)
});
setTimeout(() =&gt; {
  multicasted.subscribe({
    next: v =&gt; console.log(&quot;observerB: &quot; + v)
  });
}, 200);
</code></pre><p>ç»“æœ</p><pre><code class="language-text">
observerA: 1
observerA: 2
observerA: 3
observerB: 1
observerB: 2
observerB: 3
</code></pre><ul><li>multicast(()=&gt;new Subject()) + æ‰‹åŠ¨ connect</li></ul><pre><code class="language-javascript">var source = from([1, 2, 3]);
var multicasted = source.pipe(multicast(() =&gt; new Subject()));

// åœ¨åº•å±‚ä½¿ç”¨äº† `subject.subscribe({...})`:
multicasted.subscribe({
  next: v =&gt; console.log(&quot;observerA: &quot; + v)
});
setTimeout(() =&gt; {
  multicasted.subscribe({
    next: v =&gt; console.log(&quot;observerB: &quot; + v)
  });
}, 200);
multicasted.connect();
</code></pre><p>ç»“æœ</p><pre><code class="language-text">observerA: 1
observerA: 2
observerA: 3
</code></pre><ol start="2"><li>publish().refCount() æˆ– share()çš„æ•ˆæœ</li></ol><p>åŒæ—¶æ¥é€šçš„å¤šä¸ªè®¢é˜…è€…ä¸ä¼šé‡å¤è§¦å‘ä¸Šæ¸¸çš„é€»è¾‘ï¼›ä½†å…¨éƒ¨å–æ¶ˆè®¢é˜…ä¹‹åå†æ¥é€šï¼Œå°±ä¼šå†èµ°ä¸€éä¸Šæ¸¸ (é‡è®¢é˜…)ï¼› å› æ­¤å¹¶ä¸æ˜¯ä¸¥æ ¼æ„ä¹‰ä¸Šçš„â€œç¼“å­˜â€</p>]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[å¦‚ä½•ä¼˜é›…çš„ä¿®æ”¹ç¬¬ä¸‰æ–¹åŒ…]]></title>
        <id>patch-package</id>
        <link href="https://guoxiaxing.github.io/Blog/blog/patch-package"/>
        <updated>2021-12-14T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[å®˜æ–¹ä»‹ç»]]></summary>
        <content type="html"><![CDATA[<h2>å®˜æ–¹ä»‹ç»</h2><p>patch-package ç»™å¼€å‘è€…æä¾›äº†é€šè¿‡æ‰“â€œè¡¥ä¸â€çš„æ–¹å¼ï¼Œä½¿å¾—é‡æ–°å®‰è£…ä¾èµ–åŒ…æ—¶èƒ½å¤Ÿä¿ç•™ä¹‹å‰å¯¹ç¬¬ä¸‰æ–¹ä¾èµ–åŒ…çš„ä¿®æ”¹çš„ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚</p><h2>åº”ç”¨åœºæ™¯</h2><p>æˆ‘ä»¬åœ¨ä½¿ç”¨ç¬¬ä¸‰æ–¹ä¾èµ–åŒ…æ—¶å¦‚æœé‡åˆ°äº† bugï¼Œé€šå¸¸è§£å†³çš„æ–¹å¼éƒ½æ˜¯ç»•è¿‡è¿™ä¸ªé—®é¢˜ï¼Œä½¿ç”¨å…¶ä»–æ–¹å¼è§£å†³ï¼Œè¾ƒä¸ºéº»çƒ¦ã€‚æˆ–è€…ç»™ä½œè€…æä¸ª issue æˆ–è€… PRï¼Œç„¶åç­‰å¾…ä½œè€…çš„ä¿®å¤ã€‚ç­‰å¾…çš„æ—¶é—´ä¸å¯æ§ï¼Œæ­¤æ—¶å°±å¯ä»¥å€ŸåŠ© patch-package è‡ªå·±åŠ¨æ‰‹å»ä¿®å¤è¯¥ bugï¼Œæ„Ÿè§‰æ˜¯ä¸æ˜¯å¾ˆæ£’ã€‚å¹¶ä¸”è¿˜å¯ä»¥åœ¨ç¬¬ä¸‰æ–¹ä¾èµ–åŒ…ä¸Šï¼Œæ ¹æ®ä¸šåŠ¡éœ€æ±‚æ‰©å±•èƒ½åŠ›ã€‚</p><blockquote><p>æœ€å¥½è¿˜æ˜¯æ‰©å±•ä¸€äº›é€šç”¨æ€§æ¯”è¾ƒé«˜çš„èƒ½åŠ›ï¼Œå¦‚æœæ˜¯æ¯”è¾ƒé€šç”¨ä¸”è¯¥èƒ½åŠ›å¤§å¤šæ•°å¼€å‘è€…éƒ½æœ‰è¿™ç§è¯‰æ±‚çš„è¯å¯ä»¥ç»™ç¬¬ä¸‰æ–¹ä¾èµ–åŒ…æä¸ª PRã€‚</p></blockquote><h2>ä½¿ç”¨æ–¹æ³•</h2><h3>å®‰è£…</h3><p>éƒ½æ˜¯åœ¨é¡¹ç›®é‡Œè‡ªè¡Œå®‰è£…</p><h4>npm</h4><pre><code class="language-bash">npm i patch-package
</code></pre><h4>yarn</h4><pre><code class="language-bash">yarn add patch-package postinstall-postinstall
</code></pre><h4>ä¸ºä»€ä¹ˆ yarn è¦æ·»åŠ  postinstall-postinstall åŒ…</h4><p>yarn åœ¨ yarnã€yarn install å’Œ yarn add <code>&lt;package&gt;</code> ä¹‹åè¿è¡Œ postinstall è„šæœ¬ï¼Œä½†åœ¨ yarn remove <code>&lt;package&gt;</code> ä¹‹åä¸è¿è¡Œã€‚å¦‚æœæ‚¨å°†æ­¤åŒ…æ·»åŠ åˆ°æ‚¨çš„é¡¹ç›®ä¸­ï¼Œå³ä½¿åœ¨ yarn remove <code>&lt;package&gt;</code> ä¹‹åï¼Œå®ƒä¹Ÿä¼šæ‰§è¡Œæ‚¨é¡¹ç›®çš„ postinstall é’©å­ã€‚è¿™éœ€è¦ä½ çš„ postinstall è„šæœ¬æ˜¯å¹‚ç­‰çš„ï¼Œå› ä¸ºå®ƒä¼šä¸º yarnã€yarn install å’Œ yarn add <code>&lt;package&gt;</code> è¿è¡Œä¸¤æ¬¡</p><h3>ä¿®æ”¹ package.json</h3><p>ä¾èµ–åŒ…åœ¨å®‰è£…å®Œä¹‹åä¼šæ‰§è¡Œ postinstall å‘½ä»¤</p><pre><code class="language-json">&quot;scripts&quot;: {
    ***,
+   &quot;postinstall&quot;: &quot;patch-package&quot;
}
</code></pre><h3>ä¿®æ”¹ä¾èµ–åŒ…æºç </h3><h3>ç”Ÿæˆè¡¥ä¸</h3><pre><code class="language-bash">yarn patch-package package-name(ä¿®æ”¹çš„åŒ…å)
# æˆ–è€…
npx patch-package package-nameï¼ˆnpmç‰ˆæœ¬ &gt; 5.2ï¼‰
</code></pre><p>æ‰§è¡Œ<code>npx patch-package antd</code>ç»“æœ</p><pre><code class="language-bash">npx patch-package antd
Need to install the following packages:
  patch-package
Ok to proceed? (y) y
patch-package 6.4.7
â€¢ Creating temporary folder
â€¢ Installing antd@4.17.3 with yarn
â€¢ Diffing your files with clean files
âœ” Created file patches/antd+4.17.3.patch

ğŸ’¡ antd is on GitHub! To draft an issue based on your patch run

    yarn patch-package antd --create-issue

</code></pre><p>å¯ä»¥çœ‹åˆ°patch-packageå·²ç»ä¸ºæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªè¡¥ä¸ã€‚</p><p>é»˜è®¤ä¼šåœ¨æˆ‘ä»¬çš„æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªpatchesæ–‡ä»¶å¤¹ã€‚åœ¨patchesæ–‡ä»¶å¤¹ä¸‹ä¼šåˆ›å»ºä¾èµ–åŒ…å+ç‰ˆæœ¬å·.patchçš„æ–‡ä»¶ï¼Œæ–‡ä»¶æè¿°äº†æˆ‘ä»¬ä¿®æ”¹äº†ä»€ä¹ˆï¼Œç¬¬å‡ è¡Œï¼Œæœ‰ç‚¹åƒgitçš„æäº¤è®°å½•ã€‚</p><pre><code class="language-text">diff --git a/node_modules/antd/lib/button/button.js b/node_modules/antd/lib/button/button.js
index da5fc9a..7eec125 100644
--- a/node_modules/antd/lib/button/button.js
+++ b/node_modules/antd/lib/button/button.js
@@ -143,40 +143,40 @@ var InternalButton = function InternalButton(props, ref) {
   var _classNames;
 
   var _props$loading = props.loading,
-      loading = _props$loading === void 0 ? false : _props$loading,
-      customizePrefixCls = props.prefixCls,
-      type = props.type,
-      danger = props.danger,
-      _props$shape = props.shape,
-      shape = _props$shape === void 0 ? &#x27;default&#x27; : _props$shape,
-      customizeSize = props.size,
-      className = props.className,
-      children = props.children,
-      icon = props.icon,
-      _props$ghost = props.ghost,
-      ghost = _props$ghost === void 0 ? false : _props$ghost,
-      _props$block = props.block,
-      block = _props$block === void 0 ? false : _props$block,
-      _props$htmlType = props.htmlType,
-      htmlType = _props$htmlType === void 0 ? &#x27;button&#x27; : _props$htmlType,
-      rest = __rest(props, [&quot;loading&quot;, &quot;prefixCls&quot;, &quot;type&quot;, &quot;danger&quot;, &quot;shape&quot;, &quot;size&quot;, &quot;className&quot;, &quot;children&quot;, &quot;icon&quot;, &quot;ghost&quot;, &quot;block&quot;, &quot;htmlType&quot;]);
+    loading = _props$loading === void 0 ? false : _props$loading,
+    customizePrefixCls = props.prefixCls,
+    type = props.type,
+    danger = props.danger,
+    _props$shape = props.shape,
+    shape = _props$shape === void 0 ? &#x27;default&#x27; : _props$shape,
+    customizeSize = props.size,
+    className = props.className,
+    children = props.children,
+    icon = props.icon,
+    _props$ghost = props.ghost,
+    ghost = _props$ghost === void 0 ? false : _props$ghost,
+    _props$block = props.block,
+    block = _props$block === void 0 ? false : _props$block,
+    _props$htmlType = props.htmlType,
+    htmlType = _props$htmlType === void 0 ? &#x27;button&#x27; : _props$htmlType,
+    rest = __rest(props, [&quot;loading&quot;, &quot;prefixCls&quot;, &quot;type&quot;, &quot;danger&quot;, &quot;shape&quot;, &quot;size&quot;, &quot;className&quot;, &quot;children&quot;, &quot;icon&quot;, &quot;ghost&quot;, &quot;block&quot;, &quot;htmlType&quot;]);
 
   var size = React.useContext(_SizeContext[&quot;default&quot;]);
 
   var _React$useState = React.useState(!!loading),
-      _React$useState2 = (0, _slicedToArray2[&quot;default&quot;])(_React$useState, 2),
-      innerLoading = _React$useState2[0],
-      setLoading = _React$useState2[1];
+    _React$useState2 = (0, _slicedToArray2[&quot;default&quot;])(_React$useState, 2),
+    innerLoading = _React$useState2[0],
+    setLoading = _React$useState2[1];
 
   var _React$useState3 = React.useState(false),
-      _React$useState4 = (0, _slicedToArray2[&quot;default&quot;])(_React$useState3, 2),
-      hasTwoCNChar = _React$useState4[0],
-      setHasTwoCNChar = _React$useState4[1];
+    _React$useState4 = (0, _slicedToArray2[&quot;default&quot;])(_React$useState3, 2),
+    hasTwoCNChar = _React$useState4[0],
+    setHasTwoCNChar = _React$useState4[1];
 
   var _React$useContext = React.useContext(_configProvider.ConfigContext),
-      getPrefixCls = _React$useContext.getPrefixCls,
-      autoInsertSpaceInButton = _React$useContext.autoInsertSpaceInButton,
-      direction = _React$useContext.direction;
+    getPrefixCls = _React$useContext.getPrefixCls,
+    autoInsertSpaceInButton = _React$useContext.autoInsertSpaceInButton,
+    direction = _React$useContext.direction;
 
   var buttonRef = ref || /*#__PURE__*/React.createRef();
   var delayTimeoutRef = React.useRef();
@@ -218,10 +218,11 @@ var InternalButton = function InternalButton(props, ref) {
   React.useEffect(fixTwoCNChar, [buttonRef]);
 
   var handleClick = function handleClick(e) {
+    console.log(234567) // æˆ‘çš„ä¿®æ”¹
     var _a;
 
     var onClick = props.onClick,
-        disabled = props.disabled; // https://github.com/ant-design/ant-design/issues/30207
+      disabled = props.disabled; // https://github.com/ant-design/ant-design/issues/30207
 
     if (innerLoading || disabled) {
       e.preventDefault();
</code></pre><h3>æµ‹è¯•è¡¥ä¸æ˜¯å¦æœ‰æ•ˆ</h3><ul><li>æ‰‹åŠ¨åˆ é™¤node_modulesæ–‡ä»¶å¤¹ï¼Œé‡æ–°æ‰§è¡Œyarnå®‰è£…ä¾èµ–åŒ…ã€‚å¯ä»¥çœ‹åˆ°åœ¨ä¾èµ–åŒ…å®‰è£…ç»“æŸåæ‰§è¡Œäº†patch-packageå‘½ä»¤ï¼Œä¹‹å‰ç”Ÿæˆçš„è¡¥ä¸è¢«åº”ç”¨äº†ã€‚å› ä¸ºæˆ‘ä»¬é…ç½®äº†postinstallè„šæœ¬ï¼Œæ‰€ä»¥ä¼šè‡ªåŠ¨æ‰§è¡Œpatch-packageå‘½ä»¤</li></ul><pre><code class="language-bash">$ patch-package
patch-package 6.4.7
Applying patches...
antd@4.17.3 âœ”
âœ¨  Done in 3.32s.
</code></pre><ul><li>æŸ¥çœ‹node-modulesä¸­ä¹‹å‰ä¿®æ”¹çš„antdä¿®æ”¹çš„åœ°æ–¹ï¼ŒæŸ¥çœ‹ä¹‹å‰ä¿®æ”¹çš„ä»£ç æ˜¯å¦è¿˜å­˜åœ¨ã€‚å¦‚æœä¹‹å‰ä¿®æ”¹çš„ä»£ç è¿˜å­˜åœ¨ï¼Œè¯´æ˜è¡¥ä¸æ–‡ä»¶å·²ç»ç”Ÿæ•ˆäº†ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œæ’æŸ¥ä¸‹æ˜¯å¦å“ªä¸ªæ­¥éª¤å‡ºç°äº†é—®é¢˜ã€‚</li></ul><p>antd/lib/button/button.js</p><pre><code class="language-javascript">  var handleClick = function handleClick(e) {
    console.log(234567) // Ops! å­˜åœ¨
    var _a;

    var onClick = props.onClick,
      disabled = props.disabled; // https://github.com/ant-design/ant-design/issues/30207

    if (innerLoading || disabled) {
      e.preventDefault();
      return;
    }

    (_a = onClick) === null || _a === void 0 ? void 0 : _a(e);
  };
</code></pre><p><strong>æœ€åå°†patchesæ–‡ä»¶å¤¹æ¨é€åˆ°è¿œç«¯ä»“åº“ï¼Œæ—¥åæ— è®ºæ˜¯è°æ‹‰å–ä»£ç ï¼Œå®‰è£…ä¾èµ–ï¼Œæˆ‘ä»¬ä¹‹å‰ä¿®æ”¹çš„éƒ¨åˆ†éƒ½ä¼šç”Ÿæ•ˆçš„</strong></p><h2>æ³¨æ„äº‹é¡¹</h2><ol><li><p>patchæ˜¯é”å®šç‰ˆæœ¬å·çš„ï¼Œå¦‚æœå‡çº§äº†ç‰ˆæœ¬ï¼Œpatchå†…å®¹å°†ä¼šå¤±æ•ˆï¼Œæœ€å¥½åœ¨package.jsonèƒ½å¤Ÿé”å®šç‰ˆæœ¬å·ã€‚</p></li><li><p>é­”æ”¹çš„åŒæ—¶ï¼Œä¹Ÿå±€é™äº†å‡çº§çš„èƒ½åŠ›ï¼Œå°½é‡è¿˜æ˜¯å»æissueå’ŒPRã€‚</p></li></ol>]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[å…³äº yarn ä½ éœ€è¦çŸ¥é“çš„]]></title>
        <id>about-yarn</id>
        <link href="https://guoxiaxing.github.io/Blog/blog/about-yarn"/>
        <updated>2021-12-12T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[é‡è¦ï¼šæ°¸è¿œä¸è¦æ‰‹åŠ¨å»ä¿®æ”¹ yarn.lock æ–‡ä»¶]]></summary>
        <content type="html"><![CDATA[<p><strong>é‡è¦ï¼šæ°¸è¿œä¸è¦æ‰‹åŠ¨å»ä¿®æ”¹ yarn.lock æ–‡ä»¶</strong></p><p><strong>é‡è¦ï¼šæ°¸è¿œä¸è¦æ‰‹åŠ¨å»ä¿®æ”¹ package.json æ–‡ä»¶ï¼Œå¦‚æœä½ éœ€è¦ä½¿ç”¨ä¸€ä¸ªåŒ…çš„æœ€æ–°ç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨ <code>yarn upgrade</code> å‘½ä»¤æ¥å»å‡çº§è¯¥ packageï¼Œå®ƒä¼šè‡ªåŠ¨å®‰è£…æœ€æ–°ç‰ˆæœ¬å¹¶ä¸”æ›´æ–° yarn.lock æ–‡ä»¶</strong></p><p><strong>é‡è¦ï¼šæ°¸è¿œä¸è¦éšä¾¿çš„å°±å»åˆ é™¤ node_modules æ–‡ä»¶å’Œ yarn.lock æ–‡ä»¶å»é‡æ–° installï¼Œå› ä¸ºå®ƒå¯èƒ½ä¼šæ›´æ–°ä¸€äº›ä½ å¹¶ä¸æƒ³æ›´æ–°çš„åŒ…ï¼Œè€Œå¸¦æ¥ä¸€äº›éš¾ä»¥é¢„æ–™çš„é—®é¢˜</strong></p><h2>registry</h2><p>å…¶å®å°±æ˜¯æŸ¥è¯¢ä¸‹è½½æ¯ä¸ªæ¨¡å—çš„æºã€‚</p><p>å½“æˆ‘ä»¬æ‰§è¡Œ <code>yarn install</code> æ—¶å€™ï¼Œå°±æ˜¯å» <code>registry</code> æŸ¥è¯¢å¾—åˆ° package å‹ç¼©åŒ…åœ°å€è¿›è¡Œä¸‹è½½çš„ã€‚</p><pre><code class="language-bash">yarn config get registry # æŸ¥çœ‹å½“å‰ä½¿ç”¨çš„æº
</code></pre><pre><code class="language-bash">yarn config set registry url # è®¾ç½®æº
</code></pre><h2>ä¾èµ–ç‰ˆæœ¬</h2><p>yarn çš„åŒ…éµå®ˆè¯­ä¹‰åŒ–ç‰ˆæœ¬ï¼Œæ ¼å¼ä¸º</p><pre><code class="language-text">X.Y.Zï¼ˆä¸»ç‰ˆæœ¬å·.æ¬¡ç‰ˆæœ¬å·.ä¿®è®¢å·ï¼‰ï¼š
X.ä¸»ç‰ˆæœ¬å·ï¼šè¿›è¡Œä¸å‘ä¸‹å…¼å®¹çš„ä¿®æ”¹æ—¶ï¼Œé€’å¢ä¸»ç‰ˆæœ¬å·
Y.æ¬¡ç‰ˆæœ¬å·: åšäº†å‘ä¸‹å…¼å®¹çš„æ–°å¢åŠŸèƒ½æˆ–ä¿®æ”¹
Z.ä¿®è®¢å·ï¼šåšäº†å‘ä¸‹å…¼å®¹çš„é—®é¢˜ä¿®å¤
</code></pre><h3>ç‰ˆæœ¬å·ï¼š~version</h3><p>è¡¨ç¤ºä¸»ç‰ˆæœ¬å·å’Œæ¬¡ç‰ˆæœ¬å·ç›¸åŒï¼Œä¿®è®¢å·å–æœ€æ–°</p><table><thead><tr><th>è¡¨ç¤º</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>~3.1.4</td><td>&gt;=3.1.4 &lt;3.2.0</td></tr><tr><td>~3.1</td><td>3.1.x æˆ– &gt; = 3.1.0 &lt; 3.2.0</td></tr><tr><td>~3</td><td>3.x æˆ– &gt; = 3.0.0 &lt; 4.0.0</td></tr></tbody></table><h3>ç‰ˆæœ¬å·ï¼š^version</h3><p>è¡¨ç¤ºä¸»ç‰ˆæœ¬å·ç›¸åŒï¼Œå–æœ€æ–°ç‰ˆæœ¬</p><p>ä½¿ç”¨ <code>yarn add package</code>æ—¶ï¼Œé»˜è®¤ä½¿ç”¨çš„æ˜¯ ^ èŒƒå›´ã€‚</p><h2>ä¾èµ–ç±»å‹</h2><h3>dependencies</h3><p>ä»£ç è¿è¡Œæ—¶æ‰€éœ€è¦çš„ä¾èµ–ï¼Œæ¯”å¦‚ vueï¼Œvue-routerã€‚</p><h3>devDependencies</h3><p>å¼€å‘ä¾èµ–ï¼Œå°±æ˜¯é‚£äº›åªåœ¨å¼€å‘è¿‡ç¨‹ä¸­éœ€è¦ï¼Œè€Œè¿è¡Œæ—¶ä¸éœ€è¦çš„ä¾èµ–ï¼Œæ¯”å¦‚ babelï¼Œwebpackã€‚</p><h3>peerDependencies</h3><p>åŒä¼´ä¾èµ–ï¼Œå®ƒç”¨æ¥å‘ŠçŸ¥å®¿ä¸»ç¯å¢ƒéœ€è¦ä»€ä¹ˆä¾èµ–ä»¥åŠä¾èµ–çš„ç‰ˆæœ¬èŒƒå›´ã€‚å¦‚æœå®¿ä¸»ç¯å¢ƒæ²¡æœ‰å¯¹åº”ç‰ˆæœ¬çš„ä¾èµ–ï¼Œåœ¨å®‰è£…ä¾èµ–æ—¶ä¼šæŠ¥å‡ºè­¦å‘Šã€‚</p><h3>optionalDependencies</h3><p>å¯é€‰ä¾èµ–ï¼Œè¿™ç§ä¾èµ–å³ä¾¿å®‰è£…å¤±è´¥ï¼ŒYarn ä¹Ÿä¼šè®¤ä¸ºæ•´ä¸ªä¾èµ–å®‰è£…è¿‡ç¨‹æ˜¯æˆåŠŸçš„ã€‚å¯é€‰ä¾èµ–é€‚ç”¨äºé‚£äº›å³ä¾¿æ²¡æœ‰æˆåŠŸå®‰è£…å¯é€‰ä¾èµ–ï¼Œä¹Ÿæœ‰åå¤‡æ–¹æ¡ˆçš„æƒ…å†µã€‚</p><h3>bundledDependencies</h3><p>æ‰“åŒ…ä¾èµ–ï¼Œåœ¨å‘å¸ƒåŒ…æ—¶ï¼Œè¿™ä¸ªæ•°ç»„é‡Œçš„åŒ…éƒ½ä¼šè¢«æ‰“åŒ…æ‰“åŒ…åˆ°æœ€ç»ˆçš„å‘å¸ƒåŒ…é‡Œï¼Œéœ€è¦æ³¨æ„ <code>bundledDependencies</code> ä¸­çš„åŒ…å¿…é¡»æ˜¯åœ¨ <code>devDependencies</code> æˆ– <code>dependencies</code> å£°æ˜è¿‡çš„ã€‚</p><h2>ç¼“å­˜</h2><p><code>yarn</code> ä¼šå°†å®‰è£…è¿‡çš„åŒ…ç¼“å­˜ä¸‹æ¥ï¼Œ<strong>è¿™æ ·å†æ¬¡å®‰è£…ç›¸åŒåŒ…çš„æ—¶å€™ï¼Œå°±ä¸éœ€è¦å†å»ä¸‹è½½ï¼Œè€Œæ˜¯ç›´æ¥ä»ç¼“å­˜æ–‡ä»¶ä¸­ç›´æ¥ copy è¿›æ¥</strong>ã€‚</p><p>å¯ä»¥é€šè¿‡å‘½ä»¤ <code>yarn cache dir</code> æŸ¥çœ‹ yarn çš„å…¨å±€ç¼“å­˜ç›®å½•ã€‚</p><p>yarn ä¼šå°†ä¸é€šç‰ˆæœ¬è§£å‹åçš„åŒ…å­˜æ”¾åœ¨ä¸åŒç›®å½•ä¸‹ï¼Œç›®å½•ä»¥</p><pre><code class="language-text">npm-[package name]-[version]-[shasum]`
</code></pre><p><code>shasum</code>æ˜¯ä¸€ä¸ª hash å€¼ï¼Œåœ¨ lock å’Œç¼“å­˜æ—¶ä¼šä½¿ç”¨åˆ°ã€‚</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡å‘½ä»¤æŸ¥çœ‹å·²ç»ç¼“å­˜è¿‡çš„åŒ…ã€‚</p><pre><code class="language-bash">yarn cache list    åˆ—å‡ºå·²ç¼“å­˜çš„æ¯ä¸ªåŒ…

yarn cache list --pattern &lt;pattern&gt;  åˆ—å‡ºåŒ¹é…æŒ‡å®šæ¨¡å¼çš„å·²ç¼“å­˜çš„åŒ…
</code></pre><h2>yarn.lock</h2><p><code>yarn.lock</code> ä¸­ä¼šå‡†ç¡®çš„å­˜å‚¨æ¯ä¸ªä¾èµ–çš„å…·ä½“ç‰ˆæœ¬ä¿¡æ¯ï¼Œä»¥ä¿è¯åœ¨ä¸åŒæœºå™¨å®‰è£…å¯ä»¥å¾—åˆ°ç›¸åŒçš„ç»“æœã€‚</p><h3>yarn.lock çš„ä½œç”¨</h3><p>ä¸è¦è½»æ˜“çš„åˆ é™¤ yarn.lock æ–‡ä»¶ã€‚</p><p>æŠŠ yarn.lock åˆ æ‰åï¼ŒåŸæœ¬é”ä½çš„ç‰ˆæœ¬éƒ½æ”¾å¼€äº†ï¼Œæ‰§è¡Œ yarn install çš„æ—¶å€™ä¼šæ ¹æ® package.json é‡Œå®šä¹‰çš„ç‰ˆæœ¬åŒºé—´å»æ‰¾æœ€æ–°ç‰ˆã€‚æ‰€ä»¥ï¼Œå¯èƒ½ä¼šé€ æˆä½ é¢„æœŸå¤–çš„ä¾èµ–ä¹Ÿè¢«æ›´æ–°äº†ï¼Œä¸å¹¸çš„è¯å¯èƒ½ä¼šå¼•å…¥ bugã€‚</p><p><strong>é”å®šå”¯ä¸€ç‰ˆæœ¬</strong></p><ul><li>package.json é‡Œå®šä¹‰çš„æ˜¯ç‰ˆæœ¬åŒºé—´ï¼Œå¦‚^1.0.0</li><li>è€Œ yarn.lock é‡Œçš„ version å­—æ®µæ˜¯å”¯ä¸€çš„ç‰ˆæœ¬å·ï¼Œå¦‚ 1.0.0</li></ul><pre><code class="language-text">ajax-hook@^2.0.3:
  version &quot;2.0.3&quot;
  resolved &quot;http://npm.zhenguanyu.com/ajax-hook/download/ajax-hook-2.0.3.tgz#e9ceced02f940f6223123c7dc90fe2062d417c18&quot;
  integrity sha1-6c7O0C+UD2IjEjx9yQ/iBi1BfBg=

&quot;@utilts/z@^0.2.57&quot;, &quot;@utilts/z@^0.2.58&quot;:
  version &quot;0.2.58&quot;
  resolved &quot;http://npm.zhenguanyu.com/@utilts/z/download/@utilts/z-0.2.58.tgz#df1ad9c27734e4efd18095d49239dede266bea1f&quot;
  integrity sha1-3xrZwnc05O/RgJXUkjne3iZr6h8=
  dependencies:
    &quot;@utilts/zdata&quot; &quot;^0.2.58&quot;
    lodash-es &quot;^4.17.21&quot;
    query-string &quot;^6.11.1&quot;
    rxjs &quot;^6.6.7&quot;
</code></pre><ul><li><p>ç¬¬ä¸€è¡Œ <code>ajax-hook@^2.0.3</code> åŒ…çš„ name å’Œè¯­ä¹‰åŒ–ç‰ˆæœ¬å·ï¼Œè¿™äº›éƒ½æ¥è‡ª package.json ä¸­çš„å®šä¹‰ã€‚ä¹Ÿè¢«ç§°ä¸º <code>Identifier(s)</code>ï¼Œå¤šä¸ª Identifier æœ€ç»ˆå¯èƒ½éƒ½æŒ‡å‘åŒä¸€ä¸ªç‰ˆæœ¬</p></li><li><p>version è®°å½•çš„æ˜¯ä¸€ä¸ªç¡®å®šçš„ç‰ˆæœ¬ï¼Œä¹Ÿå°±æ˜¯å®é™…å®‰è£…çš„ç‰ˆæœ¬</p></li><li><p>resolved å­—æ®µè®°å½•çš„æ˜¯åŒ…çš„ URL åœ°å€ã€‚å…¶ä¸­ hash å€¼ï¼Œå³ä¸Šæ–‡çš„<code>shasum</code></p></li><li><p>integrity æ˜¯å¯¹ resolved ä¸‹è½½ä¸‹æ¥çš„æ–‡ä»¶è¿›è¡Œå®Œæ•´æ€§æ ¡éªŒã€‚å¦‚æœå‡ºç° diffï¼Œè¯´æ˜åŒä¸€ä¸ªä¸‹è½½é“¾æ¥å¯¹åº”çš„æ–‡ä»¶è¢«ä¿®æ”¹è¿‡ã€‚</p></li><li><p>dependencies å­—æ®µè®°å½•çš„æ˜¯å½“å‰åŒ…çš„ä¾èµ–ï¼Œå³å½“å‰åŒ…åœ¨è‡ªå·±çš„ package.json çš„ dependencies å­—æ®µä¸­çš„æ‰€æœ‰ä¾èµ–ã€‚</p></li></ul><p>Yarn åœ¨å®‰è£…æœŸé—´ï¼Œåªä¼šä½¿ç”¨å½“å‰é¡¹ç›®çš„ yarn.lock æ–‡ä»¶ï¼Œä¼šå¿½ç•¥ä»»ä½•ä¾èµ–é‡Œé¢çš„ yarn.lock æ–‡ä»¶ã€‚åœ¨é¡¶çº§ yarn.lock ä¸­åŒ…å«éœ€è¦é”å®šçš„æ•´ä¸ªä¾èµ–æ ‘é‡Œå…¨éƒ¨åŒ…ç‰ˆæœ¬çš„æ‰€æœ‰ä¿¡æ¯ã€‚</p><p><strong>yarn.lock æ–‡ä»¶æ˜¯åœ¨å®‰è£…æœŸé—´ï¼Œç”± Yarn è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œå¹¶ä¸”ç”± yarn æ¥ç®¡ç†ï¼Œä¸åº”è¯¥æ‰‹åŠ¨å»æ›´æ”¹ï¼Œæ›´ä¸åº”è¯¥åˆ é™¤ yarn.lock æ–‡ä»¶ï¼Œä¸”è¦æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿä¸­ï¼Œä»¥å…å› ä¸ºä¸åŒæœºå™¨å®‰è£…çš„åŒ…ç‰ˆæœ¬ä¸ä¸€è‡´å¼•å‘é—®é¢˜ã€‚</strong></p><p>æˆ‘ä»¬çš„å¸¸è§„æ“ä½œ(yarn add / yarn upgrade)éƒ½ä¼šè‡ªåŠ¨æ›´æ–° package.json å’Œ yarn.lock</p><h3>package.json ä¸­çš„ resolutions é€‰é¡¹</h3><p><strong>é€šè¿‡è¿™ä¸ªé€‰é¡¹å¯ä»¥ä¿®æ”¹ yarn.lock ä¸­æŸä¸ª package çš„ç‰ˆæœ¬</strong></p><p>å‡å¦‚ä½ çš„é¡¹ç›®ä¾èµ–äº† foo,foo ä¾èµ–äº† bar@^1.0.0ã€‚å‡è®¾ bar ç°åœ¨æœ‰ä¸¤ä¸ªç‰ˆæœ¬ 1.0.0 å’Œ 1.1.0ã€‚å¾ˆä¸å¹¸ï¼Œbar åœ¨å‘å¸ƒ 1.1.0 çš„æ—¶å€™æ²¡æœ‰åšå¥½å‘åå…¼å®¹ã€‚å¯¼è‡´ foo å’Œ <a href="mailto:bar@1.1.0">bar@1.1.0</a> ä¸èƒ½æ­é…ä½¿ç”¨ã€‚å¦‚æœä½ å¯ä»¥ç­‰ï¼š</p><ul><li>è¦ä¹ˆç­‰ foo æŠŠä¾èµ– bar é”æˆ 1.0.0 å¹¶é‡æ–°å‘ç‰ˆ</li><li>è¦ä¹ˆç­‰ bar ä¿®å¤å…¼å®¹é—®é¢˜åé‡æ–°å‘ç‰ˆ</li></ul><p>é‚£å¦‚æœä½ ç­‰ä¸äº†å‘¢ï¼Œä½ å·²çŸ¥ foo å’Œ <a href="mailto:bar@1.0.0">bar@1.0.0</a> å¯ä»¥æ­£å¸¸å·¥ä½œã€‚å¦‚æœä½ èƒ½é”ä½ foo å¯¹ bar çš„ä¾èµ–å°±å¥½äº†ï¼Œä½†æ˜¯è¿™å®šä¹‰åœ¨ foo çš„ packge.json é‡Œï¼Œä½ æ€»ä¸èƒ½å»æ”¹ node_modules/foo/package.json å§ï¼Ÿè¿™ä¸åˆé€‚ã€‚resolutions å¯ä»¥è§£å†³ä½ çš„é—®é¢˜ï¼Œåªè¦åœ¨ä½ è‡ªå·±é¡¹ç›®çš„ package.json é‡Œå®šä¹‰ï¼š</p><pre><code class="language-json">&quot;resolutions&quot;: {
  &quot;foo/bar&quot;: &quot;1.0.0&quot;
}
</code></pre><p>è¿™é‡Œçš„ key&quot;foo/bar&quot;è¡¨ç¤º foo çš„ç›´æ¥ä¾èµ– barï¼ŒæŠŠç‰ˆæœ¬åŒºé—´é‡å†™æˆ 1.0.0ã€‚å¦‚æœ foo ä¸æ˜¯ç›´æ¥ä¾èµ–çš„ barï¼ˆfoo -&gt; ... -&gt; barï¼‰ï¼Œæˆ‘è¿˜éœ€è¦æŠŠä¸­é—´çš„é“¾è·¯éƒ½æ‹æ¸…æ¥šå—ï¼Ÿä¸ç”¨é‚£ä¹ˆéº»çƒ¦ï¼</p><pre><code class="language-json">&quot;resolutions&quot;: {
  &quot;foo/**/bar&quot;: &quot;1.0.0&quot;
}
</code></pre><p>å¦‚æœä½ çš„é¡¹ç›®é‡Œæœ‰å¾ˆå¤šä¾èµ–ç›´æ¥/é—´æ¥çš„ä¾èµ–äº† barï¼Œæ¯ä¸ªå®šä¹‰çš„ç‰ˆæœ¬åŒºé—´å¯èƒ½æœ‰å·®åˆ«ï¼Œä½ çŸ¥é“æŸä¸ªç‰ˆæœ¬å¯ä»¥è®©ä»–ä»¬éƒ½èƒ½æ­£å¸¸å·¥ä½œï¼Œè€Œä¸ç”¨å®‰è£…å¤šä¸ªç‰ˆæœ¬ã€‚ä¹Ÿå¯ä»¥ä¸ç”¨å£°æ˜å‰ç¼€éƒ¨åˆ†ï¼Œåªå†™åŒ…å barã€‚è¿™æ ·ä¸ç®¡æ˜¯å“ªé‡Œä¾èµ–åˆ°äº† bar éƒ½ä¼šæŒ‡å‘ä½ å£°æ˜çš„å“ªä¸ªç‰ˆæœ¬ã€‚</p><pre><code class="language-json">&quot;resolutions&quot;: {
  &quot;bar&quot;: &quot;1.0.0&quot;
}
</code></pre><p>æ‰§è¡Œ yarn install åï¼Œåœ¨ yarn.lock é‡Œæœç´¢ bar@ï¼š</p><pre><code class="language-text">bar@^1.0.0 bar@1.1.0 bar@^2.0.0:
  version &quot;1.0.0&quot;
  ...
</code></pre><p><strong>å¯ä»¥çœ‹åˆ°ï¼Œresolutions å¯ä»¥è¿èƒŒç‰ˆæœ¬åŒºé—´çš„é™åˆ¶ï¼Œæ¯”å¦‚ä¸Šä¾‹ä¸­ Identifiers é‡Œçš„ <a href="mailto:bar@1.1.0">bar@1.1.0</a>``bar@^2.0.0ã€‚</strong></p><h3>yarn --frozen-lockfile / npm ci</h3><p>å³ä½¿æœ‰ lock file çš„å­˜åœ¨ï¼Œä¹Ÿæ— æ³•ä¿è¯åœ¨æŒç»­é›†æˆç¯å¢ƒä¸­æ¯æ¬¡å®‰è£…ä¾èµ–éƒ½å’Œå¼€å‘æ—¶ä¸€è‡´ï¼Œå› ä¸ºå¯èƒ½å­˜åœ¨ package.json å’Œ lockfile ç‰ˆæœ¬å·ä¸åŒ¹é…å¹¶éœ€è¦æ›´æ–°ä¾èµ–ç‰ˆæœ¬çš„æƒ…å†µã€‚å¯ä»¥ä½¿ç”¨--frozen-lockfile æ¥é¿å…ã€‚</p><p>è¿™ä¸¤ä¸ªå‘½ä»¤çš„ä½œç”¨ç±»ä¼¼ï¼Œå¿…é¡»å­˜åœ¨ lock file ä¸”ä¾èµ–ç‰ˆæœ¬å’Œ package.json åŒ¹é…æ—¶æ‰ä¼šå®‰è£…ä¾èµ–ï¼Œå¦åˆ™æŠ¥é”™ã€‚å¦‚æ­¤å¯å¼ºåˆ¶å¼€å‘è€…åœ¨æŒç»­é›†æˆå‰å…ˆåœ¨æœ¬åœ°è§£å†³ä¾èµ–ç‰ˆæœ¬çš„ä¸€è‡´æ€§é—®é¢˜ã€‚</p><h2>yarn install çš„è¿‡ç¨‹</h2><p>é¦–æ¬¡æ‰§è¡Œ yarn install å®‰è£…ï¼Œä¼šæŒ‰ç…§ package.json ä¸­çš„è¯­ä¹‰åŒ–ç‰ˆæœ¬ï¼Œå»å‘ registry è¿›è¡ŒæŸ¥è¯¢ï¼Œå¹¶è·å–åˆ°ç¬¦åˆç‰ˆæœ¬è§„åˆ™çš„æœ€æ–°çš„ä¾èµ–åŒ…è¿›è¡Œä¸‹è½½ï¼Œå¹¶æ„å»ºæ„å»ºä¾èµ–å…³ç³»æ ‘ã€‚ æ¯”å¦‚åœ¨ package.json ä¸­æŒ‡å®š react çš„ç‰ˆæœ¬ä¸º ^2.0.0ï¼Œå°±ä¼šè·å–ç¬¦åˆ 2.x.x
çš„æœ€é«˜ç‰ˆæœ¬çš„åŒ…ã€‚ç„¶åè‡ªåŠ¨ç”Ÿæˆ yarn.lock æ–‡ä»¶ï¼Œå¹¶ç”Ÿæˆç¼“å­˜ã€‚</p><p>ä¹‹åå†æ‰§è¡Œ yarn installï¼Œä¼šå¯¹æ¯” package.json ä¸­ä¾èµ–ç‰ˆæœ¬èŒƒå›´å’Œ yarn.lock ä¸­ç‰ˆæœ¬å·æ˜¯å¦åŒ¹é…ã€‚</p><ul><li><p>ç‰ˆæœ¬å·åŒ¹é…ï¼šä¼šæ ¹æ® yarn.lock ä¸­çš„ resolved å­—æ®µå»æŸ¥çœ‹ç¼“å­˜ï¼Œ å¦‚æœæœ‰ç¼“å­˜ï¼Œç›´æ¥ copyï¼Œæ²¡æœ‰ç¼“å­˜åˆ™æŒ‰ç…§ resolved å­—æ®µçš„ url å»ä¸‹è½½åŒ…ã€‚</p></li><li><p>ç‰ˆæœ¬å·ä¸åŒ¹é…ï¼šæ ¹æ® package.json ä¸­çš„ç‰ˆæœ¬èŒƒå›´å» registry æŸ¥è¯¢ï¼Œä¸‹è½½ç¬¦åˆç‰ˆæœ¬è§„åˆ™æœ€æ–°çš„åŒ…ï¼Œå¹¶æ›´æ–°è‡³ yarn.lock ä¸­ã€‚</p></li></ul><h2>æ¨¡å—æ‰å¹³åŒ–</h2><p>å‡è®¾æˆ‘é¡¹ç›®çš„é¦–å±‚ä¾èµ–(å³å½“å‰é¡¹ç›®çš„ dependence å’Œ devDependences ä¸­çš„ä¾èµ–ï¼Œä¸åŒ…æ‹¬ä¾èµ–çš„ä¾èµ–)ä¸­æœ‰ Aï¼ŒBï¼ŒC ä¸‰ä¸ªåŒ…ï¼ŒA å’Œ B åŒ…åŒæ—¶ä¾èµ–äº†ç›¸åŒç‰ˆæœ¬èŒƒå›´çš„ D åŒ…ã€‚é‚£ä¹ˆè¿™éƒ¨åˆ†çš„ä¾èµ–å…³ç³»æ ‘æ˜¯è¿™æ ·çš„ï¼š</p><pre><code class="language-text">â”œâ”€â”€ A
â”‚ â””â”€â”€ D
â”œâ”€â”€ B
â”‚ â””â”€â”€ D
â”œâ”€â”€ C
</code></pre><p>å¦‚æœæŒ‰ç…§è¿™æ ·çš„ä¾èµ–å…³ç³»æ ‘ç›´æ¥å®‰è£…çš„è¯ï¼ŒD æ¨¡å—ä¼šåœ¨ A åŒ…å’Œ B åŒ…çš„ node_modules ä¸­éƒ½å®‰è£…ï¼Œè¿™æ ·ä¼šå¯¼è‡´æ¨¡å—å†—ä½™ã€‚</p><p>ä¸ºäº†ä¿è¯ä¾èµ–å…³ç³»æ ‘ä¸­æ²¡æœ‰å¤§é‡é‡å¤æ¨¡å—ï¼Œyarn åœ¨å®‰è£…æ—¶ä¼šåš dedupeï¼ˆå»é‡ï¼‰æ“ä½œï¼Œå®ƒä¼šéå†æ‰€æœ‰èŠ‚ç‚¹ï¼Œé€ä¸ªå°†æ¨¡å—æ”¾åœ¨æ ¹èŠ‚ç‚¹ä¸‹é¢ï¼Œä¹Ÿå°±æ˜¯å½“å‰é¡¹ç›®çš„ node-modules ä¸­ã€‚å½“å‘ç°æœ‰ç›¸åŒçš„æ¨¡å—æ—¶ï¼Œä¼šåˆ¤æ–­å½“å‰æ¨¡å—æŒ‡å®šçš„ç‰ˆæœ¬èŒƒå›´æ˜¯å¦äº¤é›†ï¼Œå¦‚æœæœ‰ï¼Œåˆ™åªä¿ç•™å…¼å®¹ç‰ˆæœ¬ï¼Œå¦‚æœæ²¡æœ‰åˆ™åœ¨å½“å‰çš„åŒ…çš„ node-modules ä¸‹å®‰è£…ã€‚</p><p>æ‰€ä»¥ä¸Šé¢çš„è¯´çš„æƒ…å†µï¼Œæœ€ç»ˆå®‰è£…å®Œæˆæ˜¯ä¸‹é¢è¿™æ ·çš„ï¼ŒAï¼ŒBï¼ŒCï¼ŒD åŒ…éƒ½ä¼šå®‰è£…åœ¨ç¬¬ä¸€å±‚ node-modules ä¸‹ï¼ˆåœ¨ä¾èµ–çš„ D ç‰ˆæœ¬å…¼å®¹çš„æƒ…å†µä¸‹ï¼‰ã€‚</p><pre><code class="language-text">â”œâ”€â”€ A
â”œâ”€â”€ B
â”œâ”€â”€ C
â”œâ”€â”€ D
</code></pre><p>å¦‚æœ A åŒ…å’Œ B åŒ…ä¾èµ–çš„æ˜¯ä¸å…¼å®¹çš„ç‰ˆæœ¬ï¼Œå‡è®¾ A åŒ…ä¾èµ–çš„æ˜¯ D@1 ç‰ˆæœ¬çš„åŒ…ï¼ŒB åŒ…ä¾èµ–çš„æ˜¯ D@2 ç‰ˆæœ¬ã€‚åˆ™æœ€ç»ˆå®‰è£…çš„ç»“æœå¦‚ä¸‹ï¼š</p><pre><code class="language-text">â”œâ”€â”€ A
â”œâ”€â”€ B
â”‚ â””â”€â”€ D@2
â”œâ”€â”€ C
â”œâ”€â”€ D@1
</code></pre><p>è‡³äºæ˜¯ D çš„é‚£ä¸ªç‰ˆæœ¬è¢«å®‰è£…åœ¨æ ¹ç›®å½•çš„ node_modules ä¸‹ï¼Œå–å†³çš„æ˜¯æ¨¡å—è§£æçš„é¡ºåºï¼Œå…ˆè§£æåˆ°çš„ D çš„æŒ‡å®šç‰ˆæœ¬ä¼šè¢«å®‰è£…åˆ°æ ¹ node_modulesï¼Œåè§£æåˆ°çš„ D ä¸”ä¸å…¼å®¹å·²æœ‰ç‰ˆæœ¬æ—¶ï¼Œä¼šè¢«å®‰è£…åˆ°å¯¹åº”æ¨¡å—çš„ node_modules ä¸‹</p>]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ç¡¬é“¾æ¥å’Œç¬¦å·é“¾æ¥]]></title>
        <id>hard-link-and-symbolic-link</id>
        <link href="https://guoxiaxing.github.io/Blog/blog/hard-link-and-symbolic-link"/>
        <updated>2021-12-08T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Linux çš„é“¾æ¥æ¦‚å¿µ]]></summary>
        <content type="html"><![CDATA[<h2>Linux çš„é“¾æ¥æ¦‚å¿µ</h2><p>Linux é“¾æ¥åˆ†ä¸¤ç§ï¼Œä¸€ç§è¢«ç§°ä¸ºç¡¬é“¾æ¥ï¼ˆHard Linkï¼‰ï¼Œå¦ä¸€ç§è¢«ç§°ä¸ºç¬¦å·é“¾æ¥ï¼ˆSymbolic Linkï¼‰ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œln å‘½ä»¤äº§ç”Ÿç¡¬é“¾æ¥ã€‚</p><p>é€šä¿—ä¸€ç‚¹ç†è§£ï¼Œå¯ä»¥æŠŠç¡¬é“¾æ¥å½“æˆæºæ–‡ä»¶çš„å‰¯æœ¬ï¼Œä»–å’Œæºæ–‡ä»¶ä¸€æ ·çš„å¤§å°ä½†æ˜¯äº‹å®ä¸Šå´ä¸å ä»»ä½•ç©ºé—´ã€‚
ç¬¦å·é“¾æ¥å¯ä»¥ç†è§£ä¸ºç±»ä¼¼ windows ä¸€æ ·çš„å¿«æ·æ–¹å¼ã€‚</p><h2>ç¡¬é“¾æ¥</h2><p>ç¡¬è¿æ¥æŒ‡é€šè¿‡ç´¢å¼•èŠ‚ç‚¹æ¥è¿›è¡Œè¿æ¥ã€‚
åœ¨ Linux çš„æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œä¿å­˜åœ¨ç£ç›˜åˆ†åŒºä¸­çš„æ–‡ä»¶ä¸ç®¡æ˜¯ä»€ä¹ˆç±»å‹éƒ½ç»™å®ƒåˆ†é…ä¸€ä¸ªç¼–å·ï¼Œç§°ä¸ºç´¢å¼•èŠ‚ç‚¹å·(Inode Index)ã€‚
åœ¨ Linux ä¸­ï¼Œå¤šä¸ªæ–‡ä»¶åæŒ‡å‘åŒä¸€ç´¢å¼•èŠ‚ç‚¹æ˜¯å­˜åœ¨çš„ã€‚ä¸€èˆ¬è¿™ç§è¿æ¥å°±æ˜¯ç¡¬è¿æ¥ã€‚
ç¡¬è¿æ¥çš„ä½œç”¨æ˜¯å…è®¸ä¸€ä¸ªæ–‡ä»¶æ‹¥æœ‰å¤šä¸ªæœ‰æ•ˆè·¯å¾„åï¼Œè¿™æ ·ç”¨æˆ·å°±å¯ä»¥å»ºç«‹ç¡¬è¿æ¥åˆ°é‡è¦æ–‡ä»¶ï¼Œä»¥é˜²æ­¢â€œè¯¯åˆ â€çš„åŠŸèƒ½ã€‚å…¶åŸå› å¦‚ä¸Šæ‰€è¿°ï¼Œå› ä¸ºå¯¹åº”è¯¥ç›®å½•çš„ç´¢å¼•èŠ‚ç‚¹æœ‰ä¸€ä¸ªä»¥ä¸Šçš„è¿æ¥ã€‚åªåˆ é™¤ä¸€ä¸ªè¿æ¥å¹¶ä¸å½±å“ç´¢å¼•èŠ‚ç‚¹æœ¬èº«å’Œå…¶å®ƒçš„è¿æ¥ï¼Œåªæœ‰å½“æœ€åä¸€ä¸ªè¿æ¥è¢«åˆ é™¤åï¼Œæ–‡ä»¶çš„æ•°æ®å—åŠç›®å½•çš„è¿æ¥æ‰ä¼šè¢«é‡Šæ”¾ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ–‡ä»¶çœŸæ­£åˆ é™¤çš„æ¡ä»¶æ˜¯ä¸ä¹‹ç›¸å…³çš„æ‰€æœ‰ç¡¬è¿æ¥æ–‡ä»¶å‡è¢«åˆ é™¤ã€‚</p><pre><code class="language-bash">ln existfile  newfile # åˆ›å»ºç¡¬é“¾æ¥
</code></pre><p>ç¡¬é“¾æ¥æ–‡ä»¶æœ‰ä¸¤ä¸ªé™åˆ¶</p><ul><li>ä¸å…è®¸ç»™ç›®å½•åˆ›å»ºç¡¬é“¾æ¥</li><li>åªå…è®¸åœ¨åŒä¸€æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶ä¹‹é—´æ‰èƒ½åˆ›å»ºé“¾æ¥</li></ul><p>å¯¹äºç¡¬é“¾æ¥æ–‡ä»¶è¿›è¡Œè¯»å†™å’Œåˆ é™¤æ“ä½œçš„æ—¶å€™ï¼Œç»“æœå’Œç¬¦å·é“¾æ¥ç›¸åŒã€‚ä½†æ˜¯å¦‚æœæˆ‘ä»¬åˆ é™¤ç¡¬é“¾æ¥æ–‡ä»¶çš„æºæ–‡ä»¶ï¼Œç¡¬é“¾æ¥æ–‡ä»¶ä»å­˜åœ¨ï¼Œè€Œä¸”ä¿ç•™äº†åŸæœ‰çš„å†…å®¹ã€‚</p><h2>ç¬¦å·é“¾æ¥</h2><p>å¦å¤–ä¸€ç§è¿æ¥ç§°ä¹‹ä¸ºç¬¦å·è¿æ¥ï¼ˆSymbolic Linkï¼‰ï¼Œä¹Ÿå«è½¯è¿æ¥ã€‚è½¯é“¾æ¥æ–‡ä»¶æœ‰ç±»ä¼¼äº Windows çš„å¿«æ·æ–¹å¼ã€‚å®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ–‡ä»¶ã€‚åœ¨ç¬¦å·è¿æ¥ä¸­ï¼Œæ–‡ä»¶å®é™…ä¸Šæ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶åŒ…å«äº†å¦ä¸€ä¸ªæ–‡ä»¶çš„è·¯å¾„åã€‚
å¯ä»¥æ˜¯ä»»æ„æ–‡ä»¶æˆ–ç›®å½•ï¼Œä¹Ÿå¯ä»¥é“¾æ¥ä¸åŒæ–‡ä»¶ç³»ç»Ÿçš„æ–‡ä»¶ã€‚ç”šè‡³å¯ä»¥é“¾æ¥ä¸å­˜åœ¨çš„æ–‡ä»¶ï¼Œè¿™å°±äº§ç”Ÿä¸€èˆ¬ç§°ä¸ºâ€œæ–­è£‚â€çš„é—®é¢˜ï¼ˆç°è±¡ï¼‰ï¼Œè¿˜å¯ä»¥ä¸æ–­çš„å¾ªç¯é“¾æ¥è‡ªå·±ã€‚
åœ¨å¯¹ç¬¦å·é“¾æ¥è¿›è¡Œè¯»å†™æ“ä½œçš„æ—¶å€™ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æŠŠè¯¥æ“ä½œè½¬æ¢ä¸ºå¯¹æºæ–‡ä»¶çš„æ“ä½œã€‚ä½†æ˜¯åˆ é™¤é“¾æ¥æ–‡ä»¶æ—¶ï¼Œç³»ç»Ÿä»…ä»…åˆ é™¤ç¬¦å·é“¾æ¥æ–‡ä»¶ï¼Œè€Œä¸åˆ é™¤æºæ–‡ä»¶æœ¬èº«ã€‚</p><pre><code class="language-bash">ln -s source_file  softlink_file # åˆ›å»ºç¬¦å·é“¾æ¥
</code></pre><h2>å®éªŒä¸€ä¸‹</h2><pre><code class="language-bash">$ touch f1          #åˆ›å»ºä¸€ä¸ªæµ‹è¯•æ–‡ä»¶f1
$ ln f1 f2          #åˆ›å»ºf1çš„ä¸€ä¸ªç¡¬è¿æ¥æ–‡ä»¶f2
$ ln -s f1 f3       #åˆ›å»ºf1çš„ä¸€ä¸ªç¬¦å·è¿æ¥æ–‡ä»¶f3
$ ls -li            # -iå‚æ•°æ˜¾ç¤ºæ–‡ä»¶çš„inodeèŠ‚ç‚¹ä¿¡æ¯
total 0
7722708 -rw-r--r--  2 oracle oinstall 0 Apr 21 08:11 f1
7722708 -rw-r--r--  2 oracle oinstall 0 Apr 21 08:11 f2
7722757 lrwxrwxrwx  1 oracle oinstall 2 Apr 21 08:11 f3 -&gt; f1
</code></pre><p>ä»ä¸Šé¢çš„ç»“æœä¸­å¯ä»¥çœ‹å‡ºï¼Œç¡¬è¿æ¥æ–‡ä»¶ f2 ä¸åŸæ–‡ä»¶ f1 çš„ inode èŠ‚ç‚¹ç›¸åŒï¼Œå‡ä¸º 7722708ï¼Œç„¶è€Œç¬¦å·è¿æ¥æ–‡ä»¶çš„ inode èŠ‚ç‚¹ä¸åŒã€‚</p><pre><code class="language-text">$ echo &quot;I am f1 file&quot; &gt;&gt;f1
$ cat f1
I am f1 file
$ cat f2
I am f1 file
$ cat f3
I am f1 file
$ rm -f f1
$ cat f2
I am f1 file
cat f3
cat: f3: No such file or directory
</code></pre><p>é€šè¿‡ä¸Šé¢çš„æµ‹è¯•å¯ä»¥çœ‹å‡ºï¼šå½“åˆ é™¤åŸå§‹æ–‡ä»¶ f1 åï¼Œç¡¬è¿æ¥ f2 ä¸å—å½±å“ï¼Œä½†æ˜¯ç¬¦å·è¿æ¥ f1 æ–‡ä»¶æ— æ•ˆ</p><h2>ç¡¬é“¾æ¥å’Œç¬¦å·é“¾æ¥çš„åŒºåˆ«</h2><ul><li>ç¡¬é“¾æ¥ä»…èƒ½é“¾æ¥æ–‡ä»¶ï¼Œè€Œç¬¦å·é“¾æ¥å¯ä»¥é“¾æ¥ç›®å½•</li><li>ç¡¬é“¾æ¥åœ¨é“¾æ¥å®Œæˆåä»…å’Œæ–‡ä»¶å†…å®¹å…³è”ï¼Œå’Œä¹‹å‰é“¾æ¥çš„æ–‡ä»¶æ²¡æœ‰ä»»ä½•å…³ç³»ã€‚è€Œç¬¦å·é“¾æ¥å§‹ç»ˆå’Œä¹‹å‰é“¾æ¥çš„æ–‡ä»¶å…³è”ï¼Œå’Œæ–‡ä»¶å†…å®¹ä¸ç›´æ¥ç›¸å…³ã€‚</li></ul><h2>æ€»ç»“</h2><ul><li><p>åˆ é™¤ç¬¦å·è¿æ¥ f3,å¯¹ f1,f2 æ— å½±å“ï¼›</p></li><li><p>åˆ é™¤ç¡¬è¿æ¥ f2ï¼Œå¯¹ f1,f3 ä¹Ÿæ— å½±å“ï¼›</p></li><li><p>åˆ é™¤åŸæ–‡ä»¶ f1ï¼Œå¯¹ç¡¬è¿æ¥ f2 æ²¡æœ‰å½±å“ï¼Œå¯¼è‡´ç¬¦å·è¿æ¥ f3 å¤±æ•ˆï¼›</p></li><li><p>åŒæ—¶åˆ é™¤åŸæ–‡ä»¶ f1,ç¡¬è¿æ¥ f2ï¼Œæ•´ä¸ªæ–‡ä»¶ä¼šçœŸæ­£çš„è¢«åˆ é™¤ã€‚</p></li></ul><p>ç¬¦å·é“¾æ¥ï¼ˆsymbolic linkï¼‰åœ¨å»ºç«‹çš„æ—¶å€™å»ºç«‹äº†ä¸€ä¸ªæ–°çš„ inodeï¼Œå¹¶è®°å½•äº†æŒ‡å‘æºæ–‡ä»¶ inode çš„è·¯å¾„ã€‚æ‰€ä»¥ symbolic çš„ inode number è·ŸåŸå§‹æ¡£æ¡ˆçš„ inode number æ˜¯ä¸ä¸€æ ·çš„ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ symbolic link èƒ½å¤Ÿè·¨è¶Šä¸åŒæ–‡ä»¶ç³»ç»Ÿçš„åŸå› ã€‚
ç¬¦å·é“¾æ¥å»ºç«‹äº†æ–°çš„ inode numberï¼Œæ‰€ä»¥å®ƒæ˜¯ä¸€ä¸ªçœŸå®çš„æ–‡ä»¶å¹¶å æœ‰ä¸€å®šçš„ç£ç›˜ç©ºé—´ã€‚å¦å¤–å¯¹ symbolic link çš„æ“ä½œé™¤äº†åˆ é™¤éƒ½ä¼šç›´æ¥å¯¹æºæ–‡ä»¶è¿›è¡Œæ“ä½œã€‚</p><p>hard link çš„ inode number è·Ÿæºæ–‡ä»¶çš„ inode number æ˜¯ä¸€æ ·çš„ã€‚å› ä¸ºä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿæœ‰ç€ç›¸åŒçš„ inode numberï¼Œæ‰€ä»¥ hard link æ˜¯ä¸å¯ä»¥è·¨æ–‡ä»¶ç³»ç»Ÿåˆ›å»ºçš„ã€‚ä¹Ÿå¯ä»¥å°† hard link ç†è§£ä¸ºä¸æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼ŒæŠŠå®ƒçœ‹æˆæ˜¯åŒä¸€ä¸ª inode çš„åˆ«åï¼Œå»ºç«‹ hard link åä»–å’Œæºæ–‡ä»¶äº’ä¸ºåˆ«åï¼Œåˆ é™¤å…¶ä¸­ä»»ä½•ä¸€ä¸ªï¼Œinode éƒ½ä¸ä¼šé‡Šæ”¾ã€‚åªæœ‰æŒ‡å‘åŒä¸€ inode çš„æ–‡ä»¶åéƒ½åˆ é™¤åï¼Œinode æ‰é‡Šæ”¾ã€‚hard link å®é™…ä¸Šæ˜¯ä¸å ç©ºé—´çš„ã€‚</p>]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[å…³äº line-height å±æ€§]]></title>
        <id>line-height</id>
        <link href="https://guoxiaxing.github.io/Blog/blog/line-height"/>
        <updated>2021-12-07T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[- æ²¡ç»™å…ƒç´ è®¾ç½®é«˜åº¦æ—¶ï¼Œå…ƒç´ é«˜åº¦é‡‡ç”¨çš„æ˜¯ line-height çš„é«˜åº¦ï¼Œè¿™ä¸ªå±æ€§å…·æœ‰ç»§æ‰¿æ€§ã€‚ä¹Ÿè‡ªå¸¦é»˜è®¤å€¼ï¼Œæ‰€ä»¥å½“ä½ ç»™ä¸€ä¸ªæ²¡æœ‰è®¾ç½®é«˜åº¦çš„å…ƒç´ è®¾ç½® line-height:0;å³ä½¿é‡Œé¢æœ‰æ–‡æœ¬ï¼Œå®ƒä¹Ÿæ˜¯ä¼šå¡Œé™·çš„ã€‚]]></summary>
        <content type="html"><![CDATA[<ul><li><p>æ²¡ç»™å…ƒç´ è®¾ç½®é«˜åº¦æ—¶ï¼Œå…ƒç´ é«˜åº¦é‡‡ç”¨çš„æ˜¯ line-height çš„é«˜åº¦ï¼Œè¿™ä¸ªå±æ€§å…·æœ‰ç»§æ‰¿æ€§ã€‚ä¹Ÿè‡ªå¸¦é»˜è®¤å€¼ï¼Œæ‰€ä»¥å½“ä½ ç»™ä¸€ä¸ªæ²¡æœ‰è®¾ç½®é«˜åº¦çš„å…ƒç´ è®¾ç½® line-height:0;å³ä½¿é‡Œé¢æœ‰æ–‡æœ¬ï¼Œå®ƒä¹Ÿæ˜¯ä¼šå¡Œé™·çš„ã€‚</p></li><li><p>å¯ä»¥åˆ†ä¸ºå¥½å‡ ç§ç›’å­ï¼Œå½“ä½ è®¾ç½® line-height çš„æ—¶å€™ï¼Œè¡Œå†…æ¡†æ˜¯ä¸ä¼šå˜åŒ–çš„ï¼Œæ”¹å˜çš„æ˜¯è¡Œè·ï¼Œå®ƒåªç”± font-size çš„å†³å®šã€‚è¿™å…¶å®å°±æ˜¯ä¸Šè¾¹å…ƒç´  height ç­‰äº line-height çš„æ—¶å€™ï¼Œå…ƒç´ å†…æ–‡æœ¬ä¼šå‚ç›´å±…ä¸­çš„åŸå› ã€‚</p></li><li><p>å–å€¼ä¸º number æ—¶ï¼Œline-height ä¸º number ä¹˜ä»¥å½“å‰å…ƒç´ çš„ font-size,å– normal æ—¶ä¸€èˆ¬å°±æ˜¯ number ä¸º 1.2</p></li></ul>]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[peerDependencies]]></title>
        <id>peerDependencies</id>
        <link href="https://guoxiaxing.github.io/Blog/blog/peerDependencies"/>
        <updated>2021-12-07T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[ä¸ºä»€ä¹ˆä¼šç ”ç©¶è¿™ä¸ª peerDependenciesï¼Ÿ]]></summary>
        <content type="html"><![CDATA[<h2>ä¸ºä»€ä¹ˆä¼šç ”ç©¶è¿™ä¸ª peerDependenciesï¼Ÿ</h2><p>å› ä¸ºæˆ‘åœ¨æˆ‘ä»¬çš„ç»„çš„ç»„ä»¶åº“çš„<code>package.json</code>ä¸­çœ‹åˆ°äº†è¿™ä¸ªï¼Œç„¶åæˆ‘å°±å‘ç°è¿™é‡Œé¢çš„ä¾èµ–éƒ½æ˜¯åœ¨æˆ‘ä»¬é¡¹ç›®ä¸­ä¸­ä¹Ÿéœ€è¦ä½¿ç”¨çš„ã€‚
è€Œä¸”æˆ‘ä»¬çš„ç»„ä»¶åº“æ˜¯åŸºäº angular çš„ï¼Œä½†æ˜¯å®ƒå¹¶æ²¡æœ‰å°† angular ä½œä¸º dependenciesã€‚
ç„¶åæˆ‘åˆå»çœ‹äº†çœ‹ä¸€äº›ç¬¬ä¸‰æ–¹çš„ç»„ä»¶åº“æˆ–è€…æ˜¯æ’ä»¶ï¼Œæˆ‘å‘ç°ä»–ä»¬éƒ½æ²¡æœ‰å°†ä¸€äº›æ ¸å¿ƒåº“ï¼ˆreactã€vueã€angularã€jqueryï¼‰ä½œä¸ºç›´æ¥ä¾èµ–ï¼Œè€Œæ˜¯åªæ˜¯å°†ä»–ä»¬æ·»åŠ åˆ°äº† peerDependencies ä¸­ï¼Œè¿™è®©æˆ‘æƒ³çŸ¥é“ï¼ŒpeerDependencies åˆ°åº•æ˜¯å¹²ä»€ä¹ˆçš„ï¼Ÿ</p><h2>æˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬ä½¿ç”¨çš„æ’ä»¶æˆ–è€…æ˜¯ç¬¬ä¸‰æ–¹åº“å¯¹äºå’Œé¡¹ç›®ä¸­å…±åŒçš„ä¾èµ–æœ‰ä»€ä¹ˆè¡¨ç°å‘¢ï¼Ÿ</h2><p>åœ¨æˆ‘å¼€å‘çš„ packageA é‡Œé¢ä¾èµ–çš„ react å’Œ react-dom çš„ç‰ˆæœ¬å·åº”è¯¥å’Œä¸»ç³»ç»Ÿä¸­å®‰è£…çš„ react å’Œ react-dom çš„ç‰ˆæœ¬å·ä¿æŒä¸€è‡´ï¼Œå¹¶ä¸” packageA è¢«å®‰è£…åˆ°ä¸»ç³»ç»Ÿä¸­ä¹‹åï¼Œå°±åº”è¯¥ä¾èµ–äºä¸»ç³»ç»Ÿä¸­çš„ react å’Œ react-domã€‚</p><h2>è¯´è¯´ peerDependencies</h2><p>åŒç­‰ä¾èµ–ï¼Œæˆ–è€…å«åŒä¼´ä¾èµ–ï¼Œç”¨äºæŒ‡å®šå½“å‰åŒ…ï¼ˆä¹Ÿå°±æ˜¯ä½ å†™çš„åŒ…ï¼‰å…¼å®¹çš„å®¿ä¸»ç‰ˆæœ¬ã€‚ç”¨äºè§£å†³æ’ä»¶ä¸æ‰€ä¾èµ–åŒ…ä¸ä¸€è‡´çš„é—®é¢˜ã€‚</p><p><code>peerDependencies</code> åœ¨æˆ‘ä»¬è¿›è¡Œä¸€äº›æ’ä»¶å¼€å‘çš„æ—¶å€™ä¼šç»å¸¸ç”¨åˆ°ï¼Œæ¯”å¦‚ antd çš„å¼€å‘ä¾èµ–äº React</p><p>æ€»ç»“ä¸€ä¸‹ç‰¹ç‚¹ï¼š</p><ul><li><p>æ’ä»¶æ­£ç¡®è¿è¡Œçš„å‰ææ˜¯ï¼Œæ ¸å¿ƒä¾èµ–åº“å¿…é¡»å…ˆä¸‹è½½å®‰è£…ï¼Œä¸èƒ½è„±ç¦»æ ¸å¿ƒä¾èµ–åº“è€Œè¢«å•ç‹¬ä¾èµ–å¹¶å¼•ç”¨ï¼›</p></li><li><p>æ’ä»¶å…¥å£ api çš„è®¾è®¡å¿…é¡»è¦ç¬¦åˆæ ¸å¿ƒä¾èµ–åº“çš„è§„èŒƒï¼›</p></li><li><p>æ’ä»¶çš„æ ¸å¿ƒé€»è¾‘è¿è¡Œåœ¨ä¾èµ–åº“çš„è°ƒç”¨ä¸­ï¼›</p></li><li><p>åœ¨é¡¹ç›®å®è·µä¸­ï¼ŒåŒä¸€æ’ä»¶ä½“ç³»ä¸‹ï¼Œæ ¸å¿ƒä¾èµ–åº“ç‰ˆæœ¬æœ€å¥½æ˜¯ç›¸åŒçš„ï¼›</p></li></ul><p>å¬èµ·æ¥å¯èƒ½æ²¡æœ‰é‚£ä¹ˆå¥½ç†è§£ï¼Œä¸¾ä¸ªä¾‹å­æ¥è¯´æ˜ä¸‹ã€‚antd åªæ˜¯æä¾›äº†ä¸€å¥—åŸºäº react çš„ ui ç»„ä»¶åº“ï¼Œä½†å®ƒè¦æ±‚å®¿ä¸»ç¯å¢ƒéœ€è¦å®‰è£…æŒ‡å®šçš„ react ç‰ˆæœ¬ï¼Œæ‰€ä»¥ä½ å¯ä»¥çœ‹åˆ° node_modules ä¸­ antd çš„ package.json ä¸­æœ‰è¿™ä¹ˆä¸€é¡¹é…ç½®:</p><pre><code class="language-json">&quot;peerDependencies&quot;: {
    &quot;react&quot;: &quot;&gt;=16.0.0&quot;,
    &quot;react-dom&quot;: &quot;&gt;=16.0.0&quot;
},
</code></pre><p>å®ƒè¦æ±‚å®¿ä¸»ç¯å¢ƒå®‰è£…å¤§äºç­‰äº 16.0.0 ç‰ˆæœ¬çš„ reactï¼Œä¹Ÿå°±æ˜¯ antd çš„è¿è¡Œä¾èµ–å®¿ä¸»ç¯å¢ƒæä¾›çš„è¯¥èŒƒå›´çš„ react å®‰è£…åŒ…ã€‚</p><blockquote><p>åœ¨å®‰è£…æ’ä»¶çš„æ—¶å€™ï¼ŒpeerDependencies åœ¨ npm 2.x å’Œ npm 3.x ä¸­è¡¨ç°ä¸ä¸€æ ·ã€‚npm2.x ä¼šè‡ªåŠ¨å®‰è£…åŒç­‰ä¾èµ–ï¼Œnpm3.x ä¸å†è‡ªåŠ¨å®‰è£…ï¼Œä¼šäº§ç”Ÿè­¦å‘Šï¼æ‰‹åŠ¨åœ¨ package.json æ–‡ä»¶ä¸­æ·»åŠ ä¾èµ–é¡¹å¯ä»¥è§£å†³ã€‚</p></blockquote><p>å½“åˆ«äººä½¿ç”¨æˆ‘ä»¬çš„æ’ä»¶æ—¶ï¼Œ<code>peerDependencies</code>å°±ä¼šå‘Šè¯‰æ˜ç¡®å‘Šè¯‰ä½¿ç”¨æ–¹ï¼Œä½ éœ€è¦å®‰è£…è¯¥æ’ä»¶å“ªä¸ªå®¿ä¸»ç‰ˆæœ¬ã€‚
é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šåœ¨ä¸€ä¸ªé¡¹ç›®é‡Œä½¿ç”¨ä¸€ä¸ªå®¿ä¸»ï¼ˆæ¯”å¦‚ gulpï¼‰çš„å¾ˆå¤šæ’ä»¶ï¼Œå¦‚æœç›¸äº’ä¹‹é—´å­˜åœ¨å®¿ä¸»ä¸å…¼å®¹ï¼Œåœ¨æ‰§è¡Œ<code>npm install</code>æ—¶ï¼Œcli ä¼šæŠ›å‡ºé”™è¯¯ä¿¡æ¯æ¥å‘Šè¯‰æˆ‘ä»¬ï¼Œæ¯”å¦‚ï¼š</p><pre><code class="language-text">npm ERR! peerinvalid The package gulp does not satisfy its siblings&#x27; peerDependencies requirements!
npm ERR! peerinvalid Peer gulp-cli-config@0.1.3 wants gulp@~3.1.9
npm ERR! peerinvalid Peer gulp-cli-users@0.1.4 wants gulp@~2.3.0
</code></pre><p>å½“ä½ å®‰è£…ä¸€ä¸ªåŒ…æ—¶ï¼Œå…¶ dependencies å’Œ devDependencies ä¼šè¢« npm è‡ªåŠ¨å®‰è£…ã€‚</p><p>peerDependencies åˆ™æœ‰æ‰€ä¸åŒï¼Œå®ƒä»¬ä¸ä¼šè¢«è‡ªåŠ¨å®‰è£…ã€‚</p><p>å½“ä¸€ä¸ªä¾èµ–é¡¹ c è¢«åˆ—åœ¨æŸä¸ªåŒ… b çš„ peerDependency ä¸­æ—¶ï¼Œå®ƒå°±ä¸ä¼šè¢«è‡ªåŠ¨å®‰è£…ã€‚å–è€Œä»£ä¹‹çš„æ˜¯ï¼ŒåŒ…å«äº† b åŒ…çš„ä»£ç åº“ a åˆ™å¿…é¡»å°†å¯¹åº”çš„ä¾èµ–é¡¹ c åŒ…å«ä¸ºå…¶ä¾èµ–ã€‚</p><h3>ä¸¾ä¾‹è¯´è¯´</h3><p>å‡è®¾ç°åœ¨æœ‰ä¸€ä¸ª <code>helloWorld</code> å·¥ç¨‹,å·²ç»åœ¨å…¶ <code>package.json</code> çš„ <code>dependencies</code> ä¸­å£°æ˜äº† <code>packageA</code>ï¼Œæœ‰ä¸¤ä¸ªæ’ä»¶ <code>plugin1</code> å’Œ <code>plugin2</code> ä»–ä»¬ä¹Ÿä¾èµ– <code>packageA</code>ï¼Œå¦‚æœåœ¨æ’ä»¶ä¸­ä½¿ç”¨ <code>dependencies</code> è€Œä¸æ˜¯ <code>peerDependencies</code> æ¥å£°æ˜ <code>packageA</code>ï¼Œé‚£ä¹ˆ <code>$ npm install</code> å®‰è£…å®Œ <code>plugin1</code> å’Œ <code>plugin2</code> ä¹‹åçš„ä¾èµ–å›¾æ˜¯è¿™æ ·çš„ï¼š(å‰ææ˜¯ä¾èµ–çš„ packageA çš„ç‰ˆæœ¬éƒ½ä¸åŒ)</p><pre><code class="language-text">.
â”œâ”€â”€ helloWorld
â”‚   â””â”€â”€ node_modules
â”‚       â”œâ”€â”€ packageA
â”‚       â”œâ”€â”€ plugin1
â”‚       â”‚   â””â”€â”€ nodule_modules
â”‚       â”‚       â””â”€â”€ packageA
â”‚       â””â”€â”€ plugin2
â”‚       â”‚   â””â”€â”€ nodule_modules
â”‚       â”‚       â””â”€â”€ packageA
</code></pre><p>ä»ä¸Šé¢çš„ä¾èµ–å›¾å¯ä»¥çœ‹å‡ºï¼Œ<code>helloWorld</code> æœ¬èº«å·²ç»å®‰è£…äº†ä¸€æ¬¡<code>packageA</code>ï¼Œä½†æ˜¯å› ä¸ºå› ä¸ºåœ¨
<code>plugin1</code> å’Œ <code>plugin2</code> ä¸­çš„ <code>dependencies</code> ä¹Ÿå£°æ˜äº† <code>packageA</code>ï¼Œæ‰€ä»¥æœ€å <code>packageA</code> ä¼šè¢«å®‰è£…ä¸‰æ¬¡ï¼Œæœ‰ä¸¤æ¬¡å®‰è£…æ˜¯å†—ä½™çš„ã€‚</p><p><strong>éœ€è¦æ³¨æ„çš„æ˜¯ npm ç°åœ¨å¯¹äºä¾èµ–ç‰ˆæœ¬ç›¸åŒçš„åŒ…ä¼šåœ¨ install çš„æ—¶å€™è‡ªåŠ¨æ‰å¹³åŒ–ï¼ˆnpm v3 ä¹‹åæ˜¯è¿™ä¹ˆåšçš„ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“å¤šä¸ª package ä¾èµ–äº†ç›¸åŒçš„åŒ…ä¸”ä»–ä»¬çš„ç‰ˆæœ¬ä¹Ÿç›¸åŒçš„æ—¶å€™ï¼Œä»…ä»…ä¼šåœ¨é¡¹ç›®çš„æ ¹ node_modules ä¸‹å®‰è£…ä¸€ä»½</strong></p><p>è€Œ <code>peerDependency</code> å°±å¯ä»¥é¿å…ç±»ä¼¼çš„<strong>æ ¸å¿ƒä¾èµ–åº“</strong>è¢«é‡å¤ä¸‹è½½çš„é—®é¢˜ã€‚</p><p>å¦‚æœåœ¨ <code>plugin1</code> å’Œ <code>plugin2</code> çš„ <code>package.json</code> ä¸­ä½¿ç”¨ <code>peerDependency</code> æ¥å£°æ˜æ ¸å¿ƒä¾èµ–åº“ï¼Œä¾‹å¦‚ï¼š</p><p>plugin1/package.json</p><pre><code class="language-json">{
  &quot;peerDependencies&quot;: {
    &quot;packageA&quot;: &quot;1.0.1&quot;
  }
}
</code></pre><p>plugin2/package.json</p><pre><code class="language-json">{
  &quot;peerDependencies&quot;: {
    &quot;packageA&quot;: &quot;1.0.1&quot;
  }
}
</code></pre><p>åœ¨ä¸»ç³»ç»Ÿä¸­å£°æ˜ä¸€ä¸‹ packageA:</p><p>helloWord/package.json</p><pre><code class="language-json">{
  &quot;dependencies&quot;: {
    &quot;packageA&quot;: &quot;1.0.1&quot;
  }
}
</code></pre><p>æ­¤æ—¶åœ¨ä¸»ç³»ç»Ÿä¸­æ‰§è¡Œ <code>$ npm install</code> ç”Ÿæˆçš„ä¾èµ–å›¾å°±æ˜¯è¿™æ ·çš„ï¼š</p><pre><code class="language-text">.
â”œâ”€â”€ helloWorld
â”‚   â””â”€â”€ node_modules
â”‚       â”œâ”€â”€ packageA
â”‚       â”œâ”€â”€ plugin1
â”‚       â””â”€â”€ plugin2
</code></pre><p>å¯ä»¥çœ‹åˆ°è¿™æ—¶å€™ç”Ÿæˆçš„ä¾èµ–å›¾æ˜¯æ‰å¹³çš„ï¼ŒpackageA ä¹Ÿåªä¼šè¢«å®‰è£…ä¸€æ¬¡ã€‚</p><p>æ€»ç»“ä¸‹åœ¨æ’ä»¶ä½¿ç”¨ <code>peerDependency</code> å£°æ˜ä¾èµ–åº“çš„ç‰¹ç‚¹ï¼š</p><ul><li>å¦‚æœç”¨æˆ·æ˜¾å¼ä¾èµ–äº†æ ¸å¿ƒåº“ï¼Œåˆ™å¯ä»¥å¿½ç•¥å„æ’ä»¶çš„ <code>peerDependency</code> å£°æ˜ï¼›</li><li>å¦‚æœç”¨æˆ·æ²¡æœ‰æ˜¾å¼ä¾èµ–æ ¸å¿ƒåº“ï¼Œåˆ™æŒ‰ç…§æ’ä»¶ <code>peerDependencies</code> ä¸­å£°æ˜çš„ç‰ˆæœ¬å°†åº“å®‰è£…åˆ°é¡¹ç›®æ ¹ç›®å½•ä¸­ï¼›</li><li>å½“ç”¨æˆ·ä¾èµ–çš„ç‰ˆæœ¬ã€å„æ’ä»¶ä¾èµ–çš„ç‰ˆæœ¬ä¹‹é—´ä¸ç›¸äº’å…¼å®¹ï¼Œä¼šæŠ¥é”™è®©ç”¨æˆ·è‡ªè¡Œä¿®å¤ï¼›</li></ul>]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[pnpmåˆæ˜¯ä»€ä¹ˆï¼Ÿ]]></title>
        <id>pnpm</id>
        <link href="https://guoxiaxing.github.io/Blog/blog/pnpm"/>
        <updated>2021-12-07T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[ä¸ºä»€ä¹ˆæœ‰ pnpmï¼Ÿ]]></summary>
        <content type="html"><![CDATA[<h2>ä¸ºä»€ä¹ˆæœ‰ pnpmï¼Ÿ</h2><h3>èŠ‚çº¦ç£ç›˜ç©ºé—´å¹¶æå‡å®‰è£…é€Ÿåº¦ â€‹</h3><p>å½“ä½¿ç”¨ npm æˆ– Yarn æ—¶ï¼Œå¦‚æœä½ æœ‰ 100 ä¸ªé¡¹ç›®ä½¿ç”¨äº†æŸä¸ªä¾èµ–ï¼Œå°±ä¼šæœ‰ 100 ä»½è¯¥ä¾èµ–çš„å‰¯æœ¬ä¿å­˜åœ¨ç¡¬ç›˜ä¸Šã€‚ å¯¹äº pnpm ï¼Œä¾èµ–é¡¹å°†å­˜å‚¨åœ¨ä¸€ä¸ªå†…å®¹å¯å¯»å€çš„ä»“åº“ä¸­ï¼Œå› æ­¤ï¼š</p><ul><li><p>å¦‚æœä½ ç”¨åˆ°äº†æŸä¾èµ–é¡¹çš„ä¸åŒç‰ˆæœ¬ï¼Œé‚£ä¹ˆåªä¼šå°†æœ‰å·®å¼‚çš„æ–‡ä»¶æ·»åŠ åˆ°ä»“åº“ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœæŸä¸ªåŒ…æœ‰ 100 ä¸ªæ–‡ä»¶ï¼Œè€Œå®ƒçš„æ–°ç‰ˆæœ¬åªæ”¹å˜äº†å…¶ä¸­ 1 ä¸ªæ–‡ä»¶ã€‚é‚£ä¹ˆ pnpm update æ—¶åªä¼šå‘å­˜å‚¨ä¸­å¿ƒé¢å¤–æ·»åŠ  1 ä¸ªæ–°æ–‡ä»¶ï¼Œè€Œä¸ä¼šå› ä¸ºä»…ä»…ä¸€ä¸ªæ–‡ä»¶çš„æ”¹å˜å¤åˆ¶æ•´æ–°ç‰ˆæœ¬åŒ…çš„å†…å®¹ã€‚</p></li><li><p>æ‰€æœ‰æ–‡ä»¶éƒ½ä¼šå­˜å‚¨åœ¨ç¡¬ç›˜ä¸Šçš„æŸä¸€ä½ç½®ã€‚ å½“è½¯ä»¶åŒ…è¢«è¢«å®‰è£…æ—¶ï¼ŒåŒ…é‡Œçš„æ–‡ä»¶ä¼šç¡¬é“¾æ¥åˆ°è¿™ä¸€ä½ç½®ï¼Œè€Œä¸ä¼šå ç”¨é¢å¤–çš„ç£ç›˜ç©ºé—´ã€‚ è¿™å…è®¸ä½ è·¨é¡¹ç›®åœ°å…±äº«åŒä¸€ç‰ˆæœ¬çš„ä¾èµ–ã€‚</p></li></ul><h3>åˆ›å»ºéæ‰å¹³åŒ–çš„ node_modules æ–‡ä»¶å¤¹ â€‹</h3><p>å½“ä½¿ç”¨ npm å®‰è£…ä¾èµ–æ—¶ï¼Œæ‰€æœ‰çš„ä¾èµ–éƒ½ä¼šè¢«æå‡åˆ°æ¨¡å—çš„æ ¹ç›®å½•ã€‚ å› æ­¤ï¼Œé¡¹ç›®å¯ä»¥è®¿é—®åˆ°æœªè¢«æ·»åŠ è¿›å½“å‰é¡¹ç›®çš„ä¾èµ–ã€‚</p><p>pnpm ä½¿ç”¨è½¯é“¾çš„æ–¹å¼å°†é¡¹ç›®çš„ç›´æ¥ä¾èµ–æ·»åŠ è¿›æ¨¡å—æ–‡ä»¶å¤¹çš„æ ¹ç›®å½•ã€‚</p><h2>ä¾èµ–ç®¡ç†</h2><h3>hard link æœºåˆ¶</h3><p>hard link ä½¿å¾—ç”¨æˆ·å¯ä»¥é€šè¿‡ä¸åŒçš„è·¯å¾„å¼•ç”¨æ–¹å¼å»æ‰¾åˆ°æŸä¸ªæ–‡ä»¶ã€‚pnpm ä¼šåœ¨<strong>å…¨å±€çš„ store ç›®å½•é‡Œå­˜å‚¨é¡¹ç›® node_modules æ–‡ä»¶çš„ hard links</strong> ã€‚</p><p>æ‰€ä»¥å…¨å±€çš„ store ä¸­å­˜æ”¾çš„æ˜¯æˆ‘ä»¬æ‰€æœ‰é¡¹ç›®ä¾èµ–çš„åŒ…çš„ä¿¡æ¯çš„ hard linksï¼Œç”¨äºåœ¨äºŒæ¬¡ä¸‹è½½çš„æ—¶å€™è¿›è¡Œç‰ˆæœ¬çš„æ£€æµ‹</p><p>å…³äºä»€ä¹ˆæ˜¯ç¡¬è¿æ¥å’Œè½¯é“¾æ¥ï¼Œå¯ä»¥çœ‹çœ‹æˆ‘çš„å¦ä¸€ç¯‡æ–‡ç« ï¼š<a href="https://guoxiaxing.github.io/Blog/blog/hard-link-and-symbolic-link">ç¡¬é“¾æ¥å’Œç¬¦å·é“¾æ¥</a></p><h3>Store ç›®å½•</h3><p>ä¸€èˆ¬ store ç›®å½•é»˜è®¤æ˜¯è®¾ç½®åœ¨ \${os.homedir}/.pnpm-store è¿™ä¸ªç›®å½•ä¸‹
å½“ç„¶ç”¨æˆ·ä¹Ÿå¯ä»¥åœ¨ .npmrc è®¾ç½®è¿™ä¸ª store ç›®å½•ä½ç½®ï¼Œä¸è¿‡ä¸€èˆ¬è€Œè¨€ store ç›®å½•å¯¹äºç”¨æˆ·æ¥è¯´æ„ŸçŸ¥ç¨‹åº¦æ˜¯æ¯”è¾ƒå°çš„ã€‚
å› ä¸ºè¿™æ ·ä¸€ä¸ªæœºåˆ¶ï¼Œå¯¼è‡´æ¯æ¬¡å®‰è£…ä¾èµ–çš„æ—¶å€™ï¼Œå¦‚æœæ˜¯ä¸ªç›¸åŒçš„ä¾èµ–ï¼Œæœ‰å¥½å¤šé¡¹ç›®éƒ½ç”¨åˆ°è¿™ä¸ªä¾èµ–ï¼Œé‚£ä¹ˆè¿™ä¸ªä¾èµ–å®é™…ä¸Šæœ€ä¼˜æƒ…å†µ(å³ç‰ˆæœ¬ç›¸åŒ)åªç”¨å®‰è£…ä¸€æ¬¡ã€‚
å¦‚æœæ˜¯ npm æˆ– yarnï¼Œé‚£ä¹ˆè¿™ä¸ªä¾èµ–åœ¨å¤šä¸ªé¡¹ç›®ä¸­ä½¿ç”¨ï¼Œåœ¨æ¯æ¬¡å®‰è£…çš„æ—¶å€™éƒ½ä¼šè¢«é‡æ–°ä¸‹è½½ä¸€æ¬¡ã€‚
pnpm å¯¹é¡¹ç›®å®‰è£…ä¾èµ–çš„æ—¶å€™ï¼Œå¦‚æœæŸä¸ªä¾èµ–åœ¨ sotre ç›®å½•ä¸­å­˜åœ¨äº†è¯ï¼Œé‚£ä¹ˆå°±ä¼šç›´æ¥ä» store ç›®å½•é‡Œé¢å» hard-linkï¼Œé¿å…äº†äºŒæ¬¡å®‰è£…å¸¦æ¥çš„æ—¶é—´æ¶ˆè€—ï¼Œå¦‚æœä¾èµ–åœ¨ store ç›®å½•é‡Œé¢ä¸å­˜åœ¨çš„è¯ï¼Œå°±ä¼šå»ä¸‹è½½ä¸€æ¬¡ã€‚</p><h3>node_modules ç»“æ„</h3><p>pnpm ç›®å‰çš„ node_modules çš„ä¸€äº›æ–‡ä»¶ç»“æ„ï¼Œä¾‹å¦‚åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ pnpm å®‰è£…äº†ä¸€ä¸ªå«åš express çš„ä¾èµ–ï¼Œé‚£ä¹ˆæœ€åä¼šåœ¨ node_modules ä¸­å½¢æˆè¿™æ ·ä¸¤ä¸ªç›®å½•ç»“æ„:</p><pre><code class="language-text">node_modules/express/...
node_modules/.pnpm/express@4.17.1/node_modules/xxx
</code></pre><p>å…¶ä¸­ç¬¬ä¸€ä¸ªè·¯å¾„æ˜¯ nodejs æ­£å¸¸å¯»æ‰¾è·¯å¾„ä¼šå»æ‰¾çš„ä¸€ä¸ªç›®å½•ï¼Œå¦‚æœå»æŸ¥çœ‹è¿™ä¸ªç›®å½•ä¸‹çš„å†…å®¹ï¼Œä¼šå‘ç°é‡Œé¢è¿ä¸ª node_modules æ–‡ä»¶éƒ½æ²¡æœ‰ï¼š</p><pre><code class="language-text">â–¾ express
    â–¸ lib
      History.md
      index.js
      LICENSE
      package.json
      Readme.md
</code></pre><p>å®é™…ä¸Šè¿™ä¸ªæ–‡ä»¶åªæ˜¯ä¸ªè½¯è¿æ¥ï¼Œå®ƒä¼šå½¢æˆä¸€ä¸ªåˆ°ç¬¬äºŒä¸ªç›®å½•çš„ä¸€ä¸ªè½¯è¿æ¥(ç±»ä¼¼äºè½¯ä»¶çš„å¿«æ·æ–¹å¼)ï¼Œè¿™æ · node åœ¨æ‰¾è·¯å¾„çš„æ—¶å€™ï¼Œæœ€ç»ˆä¼šæ‰¾åˆ° .pnpm è¿™ä¸ªç›®å½•ä¸‹çš„å†…å®¹ã€‚
å…¶ä¸­è¿™ä¸ª .pnpm æ˜¯ä¸ªè™šæ‹Ÿç£ç›˜ç›®å½•ï¼Œç„¶å <strong>express è¿™ä¸ªä¾èµ–çš„ä¸€äº›ä¾èµ–</strong>ä¼šè¢«å¹³é“ºåˆ° .pnpm/<a href="mailto:express@4.17.1">express@4.17.1</a>/node_modules/ è¿™ä¸ªç›®å½•ä¸‹é¢ï¼ˆåŒ…æ‹¬ express æœ¬èº«ï¼‰ï¼Œè¿™æ ·ä¿è¯äº†ä¾èµ–èƒ½å¤Ÿ require åˆ°ï¼ŒåŒæ—¶ä¹Ÿä¸ä¼šå½¢æˆå¾ˆæ·±çš„ä¾èµ–å±‚çº§ã€‚åœ¨ä¿è¯äº† nodejs èƒ½æ‰¾åˆ°ä¾èµ–è·¯å¾„çš„åŸºç¡€ä¸Šï¼ŒåŒæ—¶ä¹Ÿå¾ˆå¤§ç¨‹åº¦ä¸Šä¿è¯äº†ä¾èµ–èƒ½å¾ˆå¥½çš„è¢«æ”¾åœ¨ä¸€èµ·ã€‚
<strong>ä¹Ÿå°±æ˜¯è¯´é¡¹ç›®ä¾èµ–çš„åŒ…çš„ä¾èµ–åŒ…åªä¼šåœ¨.pnpm/åŒ…å/node_modules/ä¸‹ï¼ˆä½†æ˜¯è¿˜æ˜¯åªä¼šå®‰è£…ä¸€ä»½ï¼Œåªè¦æ˜¯å¤šä¸ªä¾èµ–åŒ…çš„ä¾èµ–æ˜¯ç‰ˆæœ¬ç›¸åŒçš„ï¼Œåªä¼šå®‰è£…ä¸€ä¸ªåŒ…ï¼Œæ¯ä¸ª.pnpm/åŒ…å/node_modules/å­˜æ”¾çš„å…¶å®æ˜¯ä¸€ä¸ªå…¨å±€ store ä¸­å¯¹åº”åŒ…æºä»£ç çš„ hard linkï¼‰ï¼Œä¸ä¼šå†è¢«æ‰å¹³åŒ–åˆ°æ ¹ node_modules ä¸‹ï¼Œé¿å…äº†ä¸€ä¸ªä¸æ˜¯é¡¹ç›®æ˜¾ç¤ºä¾èµ–çš„åŒ…ä½†æ˜¯æˆ‘ä»¬å´å¯ä»¥ä½¿ç”¨çš„é—®é¢˜ï¼ˆå³å¹½çµä¾èµ–ï¼‰</strong></p><p><strong>æ€»ç»“ä¸€ä¸‹ï¼šâœï¸ å¯¹äº pnpm çš„ node_modules ä¸‹çš„åŒ…åä¸‹å­˜æ”¾çš„å…¶å®æ˜¯ä¸€ä¸ªè½¯é“¾æ¥ï¼Œè¿æ¥åˆ° node_modules ä¸‹çš„.pnpm/åŒ…å/node_modules/xxx è¯¥ç›®å½•ä¸‹å­˜æ”¾çš„æ˜¯è¯¥ä¾èµ–åŒ…çš„ä¾èµ–ä»¥åŠè¯¥ä¾èµ–åŒ…æœ¬èº«ï¼Œæ¯ä¸ªåŒ…é‡Œé¢éƒ½å­˜æ”¾äº†ä¸€ä¸ªå…¨å±€ store ä¸­å¯¹åº”åŒ…æºä»£ç çš„ hard linkã€‚æ¯ä¸ªé¡¹ç›®çš„ node_modules ä¸‹éƒ½å­˜æ”¾çš„æ˜¯ä¸€äº› link</strong></p><h3>symlink å’Œ hard link æœºåˆ¶</h3><p>åœ¨å‰é¢çŸ¥é“äº† pnpm æ˜¯é€šè¿‡ hardlink åœ¨å…¨å±€é‡Œé¢æä¸ª store ç›®å½•æ¥å­˜å‚¨ node_modules ä¾èµ–é‡Œé¢çš„ hard link åœ°å€ï¼Œç„¶ååœ¨å¼•ç”¨ä¾èµ–çš„æ—¶å€™åˆ™æ˜¯é€šè¿‡ symlink å»æ‰¾åˆ°å¯¹åº”è™šæ‹Ÿç£ç›˜ç›®å½•ä¸‹(.pnpm ç›®å½•)çš„ä¾èµ–åœ°å€ã€‚
pnpm çš„ node_modules å¸ƒå±€ä½¿ç”¨ç¬¦å·é“¾æ¥æ¥åˆ›å»ºä¾èµ–é¡¹çš„åµŒå¥—ç»“æ„ã€‚
node_modules ä¸­æ¯ä¸ªåŒ…çš„æ¯ä¸ªæ–‡ä»¶éƒ½æ˜¯æ¥è‡ªå†…å®¹å¯å¯»å€å­˜å‚¨çš„ç¡¬é“¾æ¥ã€‚
å‡è®¾æ‚¨å®‰è£…äº†ä¾èµ–äº <a href="mailto:bar@1.0.0">bar@1.0.0</a> çš„ <a href="mailto:foo@1.0.0">foo@1.0.0</a>ã€‚ pnpm ä¼šå°†ä¸¤ä¸ªåŒ…ç¡¬é“¾æ¥åˆ° node_modules å¦‚ä¸‹æ‰€ç¤ºï¼š
foo å°†è¢«ç¬¦å·é“¾æ¥è‡³æ ¹ç›®å½•çš„ node_modules æ–‡ä»¶å¤¹ï¼Œå› ä¸º foo æ˜¯é¡¹ç›®çš„ä¾èµ–é¡¹</p><p><a href="https://pnpm.io/zh/symlinked-node-modules-structure">é“¾æ¥è¿‡ç¨‹</a></p><pre><code class="language-text">node_modules
â”œâ”€â”€ foo -&gt; ./.pnpm/foo@1.0.0/node_modules/foo
â””â”€â”€ .pnpm
    â”œâ”€â”€ bar@1.0.0
    â”‚   â””â”€â”€ node_modules
    â”‚       â””â”€â”€ bar -&gt; &lt;store&gt;/bar
    â””â”€â”€ foo@1.0.0
        â””â”€â”€ node_modules
            â”œâ”€â”€ foo -&gt; &lt;store&gt;/foo
            â””â”€â”€ bar -&gt; ../../bar@1.0.0/node_modules/bar
</code></pre><p>è®©æˆ‘ä»¬æ·»åŠ  <a href="mailto:qar@2.0.0">qar@2.0.0</a> ä½œä¸º bar å’Œ foo çš„ä¾èµ–é¡¹ã€‚ è¿™æ˜¯æ–°çš„ç»“æ„çš„æ ·å­ï¼š</p><pre><code class="language-text">node_modules
â”œâ”€â”€ foo -&gt; ./.pnpm/foo@1.0.0/node_modules/foo
â””â”€â”€ .pnpm
    â”œâ”€â”€ bar@1.0.0
    â”‚   â””â”€â”€ node_modules
    â”‚       â”œâ”€â”€ bar -&gt; &lt;store&gt;/bar
    â”‚       â””â”€â”€ qar -&gt; ../../qar@2.0.0/node_modules/qar
    â”œâ”€â”€ foo@1.0.0
    â”‚   â””â”€â”€ node_modules
    â”‚       â”œâ”€â”€ foo -&gt; &lt;store&gt;/foo
    â”‚       â”œâ”€â”€ bar -&gt; ../../bar@1.0.0/node_modules/bar
    â”‚       â””â”€â”€ qar -&gt; ../../qar@2.0.0/node_modules/qar
    â””â”€â”€ qar@2.0.0
        â””â”€â”€ node_modules
            â””â”€â”€ qar -&gt; &lt;store&gt;/qar
</code></pre><p>è€Œè¿™äº›çœŸå®ä¾èµ–åˆ™æ˜¯é€šè¿‡ hard link å­˜å‚¨åˆ°å…¨å±€çš„ store ç›®å½•ä¸­ã€‚</p><h2>å…¼å®¹é—®é¢˜</h2><p>åƒ hard link å’Œ symlink è¿™ç§æ–¹å¼åœ¨æ‰€æœ‰çš„ç³»ç»Ÿä¸Šéƒ½æ˜¯å…¼å®¹çš„å—ï¼Ÿ</p><p>å®é™…ä¸Š hard link åœ¨ä¸»æµç³»ç»Ÿä¸Š(Unix/Win)ä½¿ç”¨éƒ½æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œä½†æ˜¯ symlink å³è½¯è¿æ¥çš„æ–¹å¼å¯èƒ½ä¼šåœ¨ windows å­˜åœ¨ä¸€äº›å…¼å®¹çš„é—®é¢˜ï¼Œä½†æ˜¯é’ˆå¯¹è¿™ä¸ªé—®é¢˜ï¼Œpnpm ä¹Ÿæä¾›äº†å¯¹åº”çš„è§£å†³æ–¹æ¡ˆï¼Œè¿™é‡Œä¸åšå™è¿°ã€‚</p><h2>Monorepo æ”¯æŒ</h2><h3>ç—›ç‚¹è§£å†³</h3><h4>å¹½çµä¾èµ–</h4><p>è§£é‡Šèµ·æ¥å¾ˆç®€å•ï¼Œå³æŸä¸ªåŒ…æ²¡æœ‰è¢«å®‰è£…(package.json ä¸­å¹¶æ²¡æœ‰ï¼Œä½†æ˜¯ç”¨æˆ·å´èƒ½å¤Ÿå¼•ç”¨åˆ°è¿™ä¸ªåŒ…)ã€‚</p><p>å¼•å‘è¿™ä¸ªç°è±¡çš„åŸå› ä¸€èˆ¬æ˜¯å› ä¸º node_modules ç»“æ„æ‰€å¯¼è‡´çš„ï¼Œä¾‹å¦‚ä½¿ç”¨ yarn å¯¹é¡¹ç›®å®‰è£…ä¾èµ–ï¼Œä¾èµ–é‡Œé¢æœ‰ä¸ªä¾èµ–å«åš fooï¼Œfoo è¿™ä¸ªä¾èµ–åŒæ—¶ä¾èµ–äº† barï¼Œyarn ä¼šå¯¹å®‰è£…çš„ node_modules åšä¸€ä¸ªæ‰å¹³åŒ–ç»“æ„çš„å¤„ç†(npm v3 ä¹‹åä¹Ÿæ˜¯è¿™ä¹ˆåšçš„)ï¼Œä¼šæŠŠä¾èµ–åœ¨ node_modules ä¸‹æ‰“å¹³ï¼Œè¿™æ ·ç›¸å½“äº foo å’Œ bar å‡ºç°åœ¨åŒä¸€å±‚çº§ä¸‹é¢ã€‚é‚£ä¹ˆæ ¹æ® nodejs çš„å¯»å¾„åŸç†ï¼Œç”¨æˆ·èƒ½ require åˆ° fooï¼ŒåŒæ ·ä¹Ÿèƒ½ require åˆ° barã€‚</p><pre><code class="language-text">package.json -&gt; foo(bar ä¸º foo ä¾èµ–)
node_modules
  /foo
  /bar -&gt; å¹½çµä¾èµ–
</code></pre><p>é‚£ä¹ˆè¿™é‡Œè¿™ä¸ª bar å°±æˆäº†ä¸€ä¸ªå¹½çµä¾èµ–ï¼Œå¦‚æœæŸå¤©æŸä¸ªç‰ˆæœ¬çš„ foo ä¾èµ–ä¸å†ä¾èµ– bar æˆ–è€… foo çš„ç‰ˆæœ¬å‘ç”Ÿäº†å˜åŒ–ï¼Œé‚£ä¹ˆ require bar çš„æ¨¡å—éƒ¨åˆ†å°±ä¼šæŠ›é”™ã€‚</p><p>è¿˜æœ‰ä¸€ç§åœºæ™¯å°±æ˜¯åœ¨ lerna + yarn workspace çš„é¡¹ç›®é‡Œé¢ï¼Œå› ä¸º yarn ä¸­æä¾›äº† hoist æœºåˆ¶(å³ä¸€äº›åº•å±‚å­é¡¹ç›®çš„ä¾èµ–ä¼šè¢«æå‡åˆ°é¡¶å±‚çš„ node_modules ä¸­)ï¼Œè¿™ç§ å¹½çµä¾èµ– ä¼šæ›´å¤šï¼Œä¸€äº›åº•å±‚çš„å­é¡¹ç›®ç»å¸¸ä¼šå» require ä¸€äº›åœ¨è‡ªå·±é‡Œé¢æ²¡æœ‰å¼•å…¥çš„ä¾èµ–ï¼Œè€Œç›´æ¥å»æ‰¾é¡¶å±‚ node_modules çš„ä¾èµ–(nodejs è¿™é‡Œçš„å¯»å¾„æ˜¯ä¸ªé€’å½’ä¸Šä¸‹çš„è¿‡ç¨‹)å¹¶ä½¿ç”¨ã€‚</p><p>è€Œæ ¹æ®å‰é¢æåˆ°çš„ pnpm çš„ node_modules ä¾èµ–ç»“æ„ï¼Œè¿™ç§ç°è±¡æ˜¯æ˜¾ç„¶ä¸ä¼šå‘ç”Ÿçš„ï¼Œå› ä¸ºè¢«æ‰“å¹³çš„ä¾èµ–ä¼šè¢«æ”¾åˆ° .pnpm è¿™ä¸ªè™šæ‹Ÿç£ç›˜ç›®å½•ä¸‹é¢å»ï¼Œç”¨æˆ·é€šè¿‡ require æ˜¯æ ¹æœ¬æ‰¾ä¸åˆ°çš„ã€‚</p><blockquote><p>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œpnpm æœ¬èº«å…¶å®ä¹Ÿæä¾›äº†å°†ä¾èµ–æå‡å¹¶ä¸”æŒ‰ç…§ yarn é‚£ç§å½¢å¼ç»„ç»‡çš„ node_modules ç»“æ„çš„ Optionï¼Œä½œè€…å°†å…¶å‘½åä¸º --shamefully-hoist ï¼Œå³ &quot;ç¾è€»çš„ hoist&quot;.....</p></blockquote><h4>NPM doppelgangersï¼ˆåˆ†èº«ï¼‰</h4><p>è¿™ä¸ªé—®é¢˜å…¶å®ä¹Ÿå¯ä»¥è¯´æ˜¯ hoist å¯¼è‡´çš„ï¼Œè¿™ä¸ªé—®é¢˜å¯èƒ½ä¼šå¯¼è‡´æœ‰å¤§é‡çš„ä¾èµ–çš„è¢«é‡å¤å®‰è£…ï¼Œä¸¾ä¸ªä¾‹å­:</p><p>ä¾‹å¦‚æœ‰ä¸ª packageï¼Œä¸‹é¢ä¾èµ–æœ‰ lib_aã€lib_bã€lib_cã€lib_dï¼Œå…¶ä¸­ a å’Œ b ä¾èµ– <a href="mailto:util_e@1.0.0">util_e@1.0.0</a>ï¼Œè€Œ c å’Œ d ä¾èµ– <a href="mailto:util_e@2.0.0">util_e@2.0.0</a>ã€‚</p><pre><code class="language-text">- package
- package.json
- node_modules
- lib_a
  - node_modules &lt;- util_e@1.0.0
- lib_b
  - node_modules &lt;- util_e@1.0.0
_ lib_c
  - node_modules &lt;- util_e@2.0.0
- lib_d
  - node_modules &lt;- util_e@2.0.0
</code></pre><p>è¿™æ ·å¿…ç„¶ä¼šå¯¼è‡´å¾ˆå¤šä¾èµ–è¢«é‡å¤å®‰è£…ï¼Œäºæ˜¯å°±æœ‰äº† hoist å’Œæ‰“å¹³ä¾èµ–çš„æ“ä½œ:</p><pre><code class="language-text">- package
- package.json
- node_modules
- util_e@1.0.0
- lib_a
- lib_b
_ lib_c
  - node_modules &lt;- util_e@2.0.0
- lib_d
  - node_modules &lt;- util_e@2.0.0
</code></pre><p>ä½†æ˜¯è¿™æ ·ä¹Ÿåªèƒ½æå‡ä¸€ä¸ªä¾èµ–ï¼Œå¦‚æœä¸¤ä¸ªä¾èµ–éƒ½æå‡äº†ä¼šå¯¼è‡´å†²çªï¼Œè¿™æ ·åŒæ ·ä¼šå¯¼è‡´ä¸€äº›ä¸åŒç‰ˆæœ¬çš„ä¾èµ–è¢«é‡å¤å®‰è£…å¤šæ¬¡ï¼Œè¿™é‡Œå°±ä¼šå¯¼è‡´ä½¿ç”¨ npm å’Œ yarn çš„æ€§èƒ½æŸå¤±ã€‚</p><p>å¦‚æœæ˜¯ pnpm çš„è¯ï¼Œè¿™é‡Œå› ä¸ºä¾èµ–å§‹ç»ˆéƒ½æ˜¯å­˜åœ¨ store ç›®å½•ä¸‹çš„ hard links ï¼Œä¸€ä»½ä¸åŒçš„ä¾èµ–å§‹ç»ˆéƒ½åªä¼šè¢«å®‰è£…ä¸€æ¬¡ï¼Œå› æ­¤è¿™ä¸ªæ˜¯èƒ½å¤Ÿè¢«å½»å½»åº•åº•çš„æ¶ˆé™¤çš„ã€‚</p>]]></content>
    </entry>
</feed>